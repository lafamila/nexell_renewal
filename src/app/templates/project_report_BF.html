{% extends 'common/report_base.html' %}
{% block content %}
<link rel="stylesheet" type="text/css" href="/static/nexell/css/smartadmin-nexell-report.css">

<!--########################################################################-->
<!--# page layer start                                                     #-->
<!--########################################################################-->
<!-- 레포트1 레이어 팝업 시작 -->
<div id="popReportBF">
    <div>
        <div class="modal-content">
			<div class="modal-header">
				<div class="pull-right" style="margin-right:10px;">
					<button type="button" class="btn" id="renewal"><i class="fa fa-frown-o" aria-hidden="true"></i></button>
					<button class="btn btn-primary" id="btnPrint3"><i class="fa fa-print">&nbsp;출력</i></button>
					<button class="btn btn-default" id="btnClose" aria-hidden="true" data-dismiss="modal"><i class="fa fa-times">&nbsp;취소</i></button>
				</div>
			</div>
			<div class="modal-body report" id="exportExcelBF">

<style>

div.report .sub-title {
    padding-top: 4px!important;
}
div.report table {
	border-bottom: 0px solid #000!important;
}
div.report table:last-child {
	border-bottom: 3px solid #000!important;
}
div.report table thead,
div.report table tbody,
div.report table tbody[role=header],
div.report table tbody[role=body],
div.report table tbody[role=footer],
div.report table tfoot {
	border: 2px solid #000!important;
	border-left: 1px solid #000!important;
	border-right: 1px solid #000!important;
	border-bottom: 0px solid #000!important;
	border-top: 0px solid #000!important;
}
div.report table tbody tr:first-child th, div.report table tbody tr:first-child td, div.report table thead tr:first-child th, div.report table thead tr:first-child td{
	border-top:0px solid #555!important;
}
div.report table:not(:last-child){
	border-bottom: 0px solid #000!important;
}
div.report table:not(:first-child){
	/* BETWEEN TABLE, 2px */
	border-top: 0px solid #000!important;
}
div.report table tbody:first-child{
	border-top:0px solid #000!important;
}
div.report table th, div.report table td {
    padding: 5px!important;
}
div.report table table tr td:last-child, div.report table table tr th:last-child{
	border-right:0px solid #555!important;
}
div.report table table tr td:first-child, div.report table table tr th:first-child{
	border-left:0px solid #555!important;
}
div.report table table thead, div.report table table tbody, div.report table table tbody[role=body], div.report table table tfoot{
	border-right:0px solid #000!important;
	border-left:0px solid #000!important;
}
</style>
<style>
#popReportBF{
    font-size: 12px !important;
    line-height: 1.0 !important;
}
</style>
<style>
    span[name=alte]{
        font-size:15px!important;
        font-weight:bold!important;
    }
    span[name=blank]{
        display:inline;
    }
@media (min-width: 100px) and (max-width: 1024px) {

    span[name=alte]{
        font-size:9px!important;
        font-weight:bold!important;
    }
    span[name=blank]{
        display:none;
    }
}
</style>

                <div class="title"><span name="alte" style="vertical-align:bottom;">※사전입찰 확정 후 7일이내 프로젝트 작성<span name="blank" style="font-size:15px!important;font-weight:bold!important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span>&nbsp;<h2 class="colorLS">프로젝트 보고서 (빌트인 수수료)</h2>&nbsp;<span name="alte" style="vertical-align:bottom;"><span name="blank" style="font-size:15px!important;font-weight:bold!important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>※공사완료 후 7일이내 마감/유보 결재</span></div>



<table id="report_contract">
	<colgroup>
        <col width="175">
        <col width="150">
        <col width="175">
        <col width="150">
        <col width="175">
        <col width="150">
        <col width="175">
        <col width="150">
	</colgroup>
	<thead style="border-top:3px solid #000!important;">
		<tr>
			<th class="sub-title colorN text-center" colspan="8">기본정보 - VAT포함</th>
		</tr>

	</thead>
	<tbody>
        <tr>
			<th class="color-contract">프로젝트 번호</th>
			<td id="manage_no" colspan="3"></td>
			<th class="color-contract">작성일(자동)</th>
			<td id="regist_dtm"></td>
			<th class="color-contract">계약일</th>
			<td id="cntrct_de"></td>
		</tr>
        <tr>
			<th class="color-contract">거래처명</th>
			<td id="bcnc_nm" colspan="3"></td>
			<th class="color-contract">공사기간</th>
			<td id="cntrwk_period"></td>
			<th class="color-contract">준공예정일</th>
			<td id="expect_de"></td>
		</tr>
        <tr>
			<th class="color-contract">현장명</th>
			<td id="spt_nm" colspan="3"></td>
			<th class="color-contract">현장주소</th>
			<td id="spt_adres" colspan="3"></td>
		</tr>
		<tr>
			<th class="color-contract">세대수</th>
			<td id="home_count"></td>
			<th class="color-contract">지역</th>
			<td id="home_region"></td>
			<th class="color-contract">넥셀현장담당</th>
			<td id="spt_chrg_nm" colspan="3"></td>
		</tr>
        <tr>
            <th class="color-contract">프로젝트 유형</th>
            <th class="hasinput" colspan="3" style="padding:0px!important;">
                <div class="btn-group btn-group-justified" data-toggle="buttons">
                    {% for code in prjct_ty_code_list %}
                    <label class="btn btn-default">
                        <input type="radio" name="prjct_ty_code" value="{{code.value}}">{{code.label}}
                    </label>
                    {% endfor %}
                </div>
            </th>
			<th class="color-contract">넥셀영업담당</th>
			<td id="bsn_chrg_nm" colspan="3"></td>
		</tr>
		<tr>
            <th class="color-contract">프로젝트 생성여부</th>
            <th class="hasinput" colspan="3" style="padding:0px!important;">
                <div class="btn-group btn-group-justified" data-toggle="buttons">
                    <label class="btn btn-default">
                        <input type="radio" name="prjct_creat_at" value="Y">생성
                    </label>
                    <label class="btn btn-default">
                        <input type="radio" name="prjct_creat_at" value="N">단납건
                    </label>
                </div>
            </th>
            <th class="color-contract">진행상태</th>
            <th class="hasinput" colspan="3" style="padding:0px!important;">
                <div class="btn-group btn-group-justified" data-toggle="buttons">
                    {% for code in progrs_sttus_code_list %}
                    <label class="btn btn-default">
                        <input type="radio" name="progrs_sttus_code" value="{{code.value}}">{{code.label}}
                    </label>
                    {% endfor %}
                </div>
            </th>
		</tr>
	</tbody>
	<tfoot>
	</tfoot>
</table>
<table id="report_project" style="border-top:0px solid #000!important;">
	<colgroup>
        <col width="175">
        <col width="150">
        <col width="175">
        <col width="150">
        <col width="175">
        <col width="150">
        <col width="175">
        <col width="150">
	</colgroup>
	<tbody>
		<tr>
			<th class="colorSky" rowspan="2">본사담당</th>
			<th class="colorSky">담당자명</th>
			<th class="colorSky" colspan="2">휴대폰</th>
			<th class="colorSky" rowspan="2">거래처담당</th>
			<th class="colorSky">담당자명</th>
			<th class="colorSky" colspan="2">휴대폰</th>
		</tr>
		<tr>
			<td id="charger_nm1">-</td>
			<td id="charger_moblphon1" colspan="2"></td>
			<td id="charger_nm2">-</td>
			<td id="charger_moblphon2" colspan="2"></td>
		</tr>
<!--
		<tr>
			<th class="colorSky">장비내역</th>
			<td colspan="9" id="eqpmn_dtls"></td>
		</tr>
-->
		<tr>
			<th class="colorSky">장비/공사내역</th>
			<td colspan="3" id="cntrwk_dtls"></td>
			<th class="colorSky">계약DC(%)</th>
            <td id="cntrct_dscnt_rt" colspan=""></td>
			<th class="colorSky">품의DC(%)</th>
            <td id="cnsul_dscnt_rt" colspan="1"></td>
		</tr>
        <tr>
            <th class="colorSky">설치팀장</th>
			<td id="charger_nm6"></td>
			<td id="charger_moblphon6" colspan="2"></td>
			<th class="colorSky">실적신고</th>
            <td id="acmslt_sttemnt_at" colspan="1"></td>
			<th class="colorSky">건설공사대장</th>
            <td id="cntwrk_regstr_ennc" colspan="1"></td>
        </tr>

	</tbody>
</table>

<!-- ---------------------------------------------------------------------- -->
<table id="rptTable3" style="border-top:0px solid #000!important;">
	<colgroup>
        <col width="175">
        <col width="150">
        <col width="175">
        <col width="150">
        <col width="175">
        <col width="150">
        <col width="175">
        <col width="150">
	</colgroup>
	<!--
	<tbody id="cCostList">
		<tr>
			<th class="colorSky">설치공사금액산출</th>
			<th class="colorSky">실내기대수</th>
			<th class="colorSky">대당단가</th>
			<th class="colorSky">공급가액</th>
			<th class="colorSky">세액</th>
			<th class="colorSky">합계</th>
			<th class="colorSky">공사비총액</th>
		</tr>
		<tr>
			<td class="text-center" id="cCost5_model_no"></td>
			<td class="text-number" id="cCost5_qy"></td>
			<td class="text-number" id="cCost5_amt"></td>
			<td class="text-number" id="cCost5_amt_total"></td>
			<td class="text-number" id="cCost5_vat_total"></td>
			<td class="text-number" id="cCost5_sum"></td>
			<td class="text-number" id="cCost5_total"></td>
		</tr>
	</tbody>
	-->
	<tbody>
		<tr>
			<th class="colorSky" colspan="1">결제방법(1)</th>
			<td class="text-left" colspan="7" id="setle_mth"></td>
		</tr>
		<tr>
			<th class="colorSky" colspan="1">결제방법(2)</th>
			<th class="colorSky" colspan="2">금액</th>
			<th class="colorSky" colspan="1">일자</th>
			<th class="colorSky" colspan="4">비고(특이사항)</th>
		</tr>
		<tr>
			<th class="colorSky" colspan="1">계약금</th>
			<td class="text-number" colspan="2" id="enty"></td>
			<td colspan="1" id="enty_de"></td>
			<td id="enty_rm" colspan="4"></td>
		</tr>
		<tr>
			<th class="colorSky" colspan="1">중도금</th>
			<td class="text-number" colspan="2" id="prtpay"></td>
			<td colspan="1" id="prtpay_de"></td>
			<td id="prtpay_rm" colspan="4"></td>
		</tr>
		<tr>
			<th class="colorSky" colspan="1">잔금</th>
			<td class="text-number" colspan="2" id="surlus"></td>
			<td colspan="1" id="surlus_de"></td>
			<td id="surlus_rm" colspan="4"></td>
		</tr>
	</tbody>
</table>
<table>
    <colgroup>
        <col width="80"/>
        <col width="180"/>
        <col width="40"/>
        <col width="100"/>
        <col width="100"/>
        <col width="60"/>
        <col width="100"/>
        <col width="120"/>
        <col width="60"/>
        <col width="120"/>
    </colgroup>
    <tbody>
        <tr>
			<th class="sub-title colorN text-center" colspan="10">수주 품목 및 내역 - VAT포함</th>
        </tr>
        <tr>
            <th class="color-contract text-center">구분</th>
            <th class="color-contract text-center">모델명</th>
            <th class="color-contract text-center">수량</th>
            <th class="color-contract text-center">옵션율</th>
            <th class="color-contract text-center">출고가</th>
            <th class="color-contract text-center">DC율(%)</th>
            <th class="color-contract text-center">납품단가</th>
            <th class="color-contract text-center">삼성전자 수주총액</th>
            <th class="color-contract text-center">수수료율(%)</th>
            <th class="color-contract text-center">당사수주(수수료) 총액</th>
        </tr>
    </tbody>
    <tbody role="construct_expect_row">

    </tbody>
    <tbody role="construct_expect_row_total">
        <tr>
            <th class="colorG text-center" colspan="2">합계</th>
            <td class="colorG text-center" data-column="expect_qy_total"></td>
            <td class="colorG text-center"></td>
            <td class="colorG text-center"></td>
            <td class="colorG text-center" data-column="expect_dc_rate_total"></td>
            <td class="colorG text-center"></td>
            <td class="colorG text-number" data-column="expect_cntrct_amount_total"></td>
            <td class="colorG text-center" data-column="expect_rate_total"></td>
            <td class="colorG text-number" data-column="expect_cntrct_fee_amount_total"></td>
        </tr>
    </tbody>
    <tbody role="construct_row">
    </tbody>
    <tbody role="construct_row_total" style="display:none;">
        <tr>
            <th class="colorG text-center" colspan="2">합계</th>
            <td class="colorG text-center" data-column="qy_total"></td>
            <td class="colorG text-center"></td>
            <td class="colorG text-center"></td>
            <td class="colorG text-center" data-column="dc_rate_total"></td>
            <td class="colorG text-center"></td>
            <td class="colorG text-number" data-column="cntrct_amount_total"></td>
            <td class="colorG text-center" data-column="rate_total"></td>
            <td class="colorG text-number" data-column="cntrct_fee_amount_total"></td>
        </tr>
    </tbody>
</table>
<!--<table id="report_e_cost">-->
<!--	<colgroup>-->
<!--		<col width="80">-->
<!--		<col width="145">-->
<!--		<col width="*">-->
<!--	</colgroup>-->
<!--	<tbody>-->
<!--		<tr>-->
<!--			<th class="sub-title colorN text-center" colspan="10">M,S/H (영업) - VAT포함</th>-->
<!--		</tr>-->
<!--		<tr>-->
<!--			<th class="colorSky">구분</th>-->
<!--			<th class="colorSky">전시구분(재고)</th>-->
<!--			<th class="colorSky">출고일</th>-->
<!--			<th class="colorSky">모델명</th>-->
<!--			<th class="colorSky">수량</th>-->
<!--			<th class="colorSky">출고가</th>-->
<!--			<th class="colorSky">M,S/H 매입단가</th>-->
<!--			<th class="colorSky">M,S/H 매입금액</th>-->
<!--			<th class="colorSky">M,S/H 추가DC금액</th>-->
<!--			<th class="colorSky">실전시비용</th>-->
<!--		</tr>-->
<!--	</tbody>-->
<!--	<tbody role="body"></tbody>-->

<!--</table>-->
<!-- ---------------------------------------------------------------------- -->

<!-- ---------------------------------------------------------------------- -->

<!-- ---------------------------------------------------------------------- -->
<table id="report_plan">
	<colgroup>
		<col width="90">
		<col width="*">
	</colgroup>
	<thead>
		<tr>
			<th class="sub-title colorN text-center" colspan="14">수수료 보고서 (영업) - VAT포함</th>
		</tr>
		<tr>
			<th class="colorN">구분</th>
			<th class="color-contract">내역</th>
			<th class="color-contract">당사수주(수수료)총액</th>
			<th class="color-contract">수수료율(%)</th>
			<th class="color-contract">삼성전자 수주총액</th>
			<th class="color-contract">M,S/H 매입금액</th>
			<th class="color-contract">M,S/H 추가DC금액</th>
			<th class="color-contract">M,S/H 판매금액</th>
			<th class="color-contract">옵션행사비</th>
			<th class="color-contract">기타비용</th>
			<th class="color-contract">설계변경</th>
			<th class="colorLP">이익금(VA)</th>
			<th class="colorLP">VA율</th>
			<th class="color-contract">결재완료일</th>
<!--			<th class="colorN">구분</th>-->
<!--			<th class="color-contract">당사수주(수수료) 총액</th>-->
<!--			<th class="colorSky">수수료율(%)</th>-->
<!--			<th class="colorSky">삼성전자 수주총액</th>-->
<!--			<th class="colorSky">M,S/H 매입금액</th>-->
<!--			<th class="colorSky">M,S/H 추가DC금액</th>-->
<!--			<th class="colorSky">M,S/H 판매금액</th>-->
<!--			<th class="colorSky">옵션행사비</th>-->
<!--			<th class="colorSky">기타비용</th>-->
<!--			<th class="colorSky">이익금(VA)</th>-->
<!--			<th class="colorSky">VA율(%)</th>-->
		</tr>
	</thead>
	<tbody role="plan">
        <tr>
            <th class="colorN text-center">사전입찰</th>
            <th class="colorSky text-center">예정가</th>
            <td class="color text-number"></td>
            <td class="color text-number"></td>
            <td class="color text-number"></td>
            <td class="color text-number"></td>
            <td class="color text-number"></td>
            <td class="color text-number"></td>
            <td class="color text-number"></td>
            <td class="color text-number"></td>
            <td class="color text-number"></td>
            <td class="color text-number"></td>
            <td class="color text-number"></td>
            <td class="color text-center"></td>
        </tr>
	</tbody>
	<tbody role="exec">
		<tr>
            <th class="colorN text-center">수주계약</th>
            <th class="colorSky text-center">계약가</th>
            <td class="color text-number"></td>
            <td class="color text-number"></td>
            <td class="color text-number"></td>
            <td class="color text-number"></td>
            <td class="color text-number"></td>
            <td class="color text-number"></td>
            <td class="color text-number"></td>
            <td class="color text-number"></td>
            <td class="color text-number"></td>
            <td class="color text-number"></td>
            <td class="color text-number"></td>
            <td class="color text-center"></td>

        </tr>
	</tbody></table>
<!-- ---------------------------------------------------------------------- -->

<!-- ---------------------------------------------------------------------- -->

<!-- ---------------------------------------------------------------------- -->
<table id="report_exec">
	<colgroup>
		<col width="50">
		<col width="100">
		<col width="100">
		<col width="50">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="60">
	</colgroup>
	<tbody>
		<tr>
			<th class="sub-title colorN text-center" colspan="13">결산내역 (관리) - VAT포함</th>
		</tr>
	</tbody>
	<tbody role="body">
		<tr>
			<th class="colorN" rowspan="2">결산내역</th>
			<th class="colorP">입금합계</th>
			<th class="colorP">삼성전자 수주총액</th>
			<th class="colorP">수수료율(%)</th>
			<th class="colorP">① 당사수주(수수료) 총액</th>
			<th class="colorP">② M,S/H 매입금액</th>
			<th class="colorP">③ M,S/H 추가DC금액</th>
			<th class="colorP">④ M,S/H 판매금액</th>
			<th class="colorP">⑤ 옵션행사비</th>
			<th class="colorP">⑥ 기타비용(총액 0.5%)</th>
			<th class="colorP">이익금(VA)</th>
			<th class="colorP">VA율</th>
		</tr>
		<tr data-row="result">
			<th class="text-number colorP"></th>
			<td class="colorX text-number"></td>
			<td class="colorX text-number"></td>
			<th class="text-number colorP"></th>
			<td class="colorX text-number"></td>
			<td class="colorX text-number"></td>
			<td class="colorX text-number"></td>
			<td class="colorX text-number"></td>
			<td class="colorX text-number"></td>
			<td class="colorX text-number"></td>
			<td class="colorX text-number"></td>
		</tr>
	</tbody>
</table>
<!--
<table id="report_biss">
	<colgroup>
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
	</colgroup>
	<tbody>
        <tr>
			<th class="sub-title colorN text-center" colspan="9">협력업체 현황</th>
		</tr>
		<tr>
			<th class="colorG">계약이행증권</th>
			<th class="colorG">국세,지방세</th>
			<th class="colorG">직불적용(2억이상)</th>
			<th class="colorG">하자이행증권</th>
			<th class="colorG">실명제라벨</th>
			<th class="colorG">준공도면</th>
			<th class="colorG">S-NET</th>
			<th class="colorG">준공현장정보</th>
			<th class="colorP">마지막기성</th>
		</tr>
	</tbody>
	<tbody role="body">
		<tr>
			<td class="text-center" id="biss_a"></td>
			<td class="text-center" id="biss_b"></td>
			<td class="text-center" id="biss_c"></td>
			<td class="text-center" id="biss_d"></td>
			<td class="text-center" id="biss_e"></td>
			<td class="text-center" id="biss_f"></td>
			<td class="text-center" id="biss_g"></td>
			<td class="text-center" id="biss_h"></td>
			<td class="text-center" id="biss_i"></td>
		</tr>
	</tbody>
</table>
-->
<!-- ---------------------------------------------------------------------- -->
<table>
	<tbody>
		<tr>
			<th class="sub-title colorN text-center" colspan="2">① 입금현황 (관리) - VAT포함</th>
		</tr>
	</tbody>
	<tbody role="body">
		<tr>
			<th style="width:53%;padding:0px!important;vertical-align:top!important;border-right:2px solid #555!important;">
<table style="width:100%;border:0px!important;" id="report_s1_taxbil">
	<colgroup>
		<col width="143">
		<col width="*">
		<col width="*">
		<col width="*">
		<col width="*">
	</colgroup>
	<thead>
		<tr>
			<th class="color-contract">세금계산서일자</th>
			<th class="color-contract">공급가액</th>
			<th class="color-contract">부가세</th>
			<th class="color-contract">합계</th>
			<th class="color-contract">발행업체</th>
		</tr>
	</thead>
	<tbody>
	</tbody>
	<tfoot>
		<tr>
			<th class="colorG" colspan="3">합계</th>
			<th class="colorG text-number"></th>
			<th class="colorG text-number"></th>
		</tr>
	</tfoot>
</table>
			</th>
			<th style="width:47%;padding:0px!important;vertical-align:top!important;">
<table style="width:100%;border:0px!important;" id="report_i1_rcppay">
	<colgroup>
		<col width="130">
		<col width="*">
		<col width="*">
		<col width="*">
		<col width="*">
	</colgroup>
	<thead>
		<tr>
			<th class="colorY">입금일자</th>
			<th class="colorY">금액</th>
			<th class="colorY">잔액</th>
			<th class="colorY">수금율</th>
			<th class="colorY">수금내역</th>
		</tr>
	</thead>
	<tbody>
	</tbody>
	<tfoot>
		<tr>
			<th class="colorG">합계</th>
			<th class="colorP text-number"></th>
			<th class="colorG text-number"></th>
			<th class="colorG text-number"></th>
			<th class="colorG text-number"></th>
		</tr>
	</tfoot>
</table>
			</th>
		</tr>
	</tbody>
</table>
<!-- ---------------------------------------------------------------------- -->
<table id="rptTable14">
	<colgroup>
        <col width="80"/>
        <col width="100"/>
        <col width="120"/>
        <col width="50"/>
        <col width="100"/>
        <col width="100"/>
        <col width="100"/>
        <col width="100"/>
        <col width="100"/>
        <col width="100"/>
        <col width="100"/>
        <col width="100"/>
        <col width="50"/>
        <col width="50"/>
        <col width="80"/>
	</colgroup>
	<tbody>
		<tr>
			<th class="sub-title colorN text-center" colspan="15">② M,S/H 설치·회수 (관리) - VAT포함</th>
		</tr>
		</tr>
	</tbody>
	<tbody role="m_house_header">
		<th class="color-contract text-center">구분</th>
		<th class="color-contract text-center">출고일</th>
		<th class="color-contract text-center">모델명</th>
		<th class="color-contract text-center">수량</th>
		<th class="color-contract text-center">출고가</th>
		<th class="color-contract text-center">M/H 매입단가</th>
		<th class="color-contract text-center">M/H 매입금액</th>
		<th class="color-contract text-center">M/H 추가DC금액</th>
		<th class="color-contract text-center">실전시비용</th>
		<th class="color-contract text-center">매입형태</th>
		<th class="colorP text-center">회수예정(출+12개월)</th>
		<th class="colorY text-center">회수일</th>
		<th class="colorY text-center">회수수량</th>
		<th class="colorY text-center">차이수량</th>
		<th class="colorY text-center">회수창고</th>
	</tbody>
	<tbody role="m_house_row">

	</tbody>
	<tbody role="m_house_foot">

	</tbody>
	<tbody role="s_house_header">
		<th class="color-contract text-center">구분</th>
		<th class="color-contract text-center">출고일</th>
		<th class="color-contract text-center">모델명</th>
		<th class="color-contract text-center">수량</th>
		<th class="color-contract text-center">출고가</th>
		<th class="color-contract text-center">S/H 매입단가</th>
		<th class="color-contract text-center">S/H 매입금액</th>
		<th class="color-contract text-center">S/H 추가DC금액</th>
		<th class="color-contract text-center">실전시비용</th>
		<th class="color-contract text-center">매입형태</th>
		<th class="colorP text-center">회수예정(출+6개월)</th>
		<th class="colorY text-center">회수일</th>
		<th class="colorY text-center">회수수량</th>
		<th class="colorY text-center">차이수량</th>
		<th class="colorY text-center">회수창고</th>
	</tbody>
	<tbody role="s_house_row">

	</tbody>
	<tbody role="s_house_foot">

	</tbody>
	<tfoot>
		<th class="colorG text-center">합계</th>
		<th class="colorG text-center"></th>
		<th class="colorG text-center"></th>
		<th class="colorG text-center" data-column="total_qy"></th>
		<th class="colorG text-center"></th>
		<th class="colorG text-center"></th>
		<th class="colorP text-right" data-column="total_amount"></th>
		<th class="colorG text-right" data-column="total_dc"></th>
		<th class="colorG text-right" data-column="total_ramount"></th>
		<th class="colorG text-center"></th>
		<th class="colorG text-center"></th>
		<th class="colorG text-center"></th>
		<th class="colorG text-center" data-column="total_return"></th>
		<th class="colorG text-center"></th>
		<th class="colorG text-center"></th>
	</tfoot>


</table>
<!-- ---------------------------------------------------------------------- -->
<table>
	<tbody>
		<tr>
			<th class="sub-title colorN text-center" colspan="2">③ M,S/H 전시차감 현황 (관리) - VAT포함</th>
		</tr>
	</tbody>
	<tbody role="body">
		<tr>
			<th style="width:53%;padding:0px!important;vertical-align:top!important;border-right:2px solid #555!important;">
<table style="width:100%;border:0px!important;" id="report_s2_taxbil">
	<colgroup>
		<col width="*">
		<col width="143">
		<col width="*">
		<col width="*">
		<col width="*">
		<col width="*">
	</colgroup>
	<thead>
		<tr>
			<th class="color-contract">구분</th>
			<th class="color-contract">세금계산서일자</th>
			<th class="color-contract">공급가액</th>
			<th class="color-contract">부가세</th>
			<th class="color-contract">합계</th>
			<th class="color-contract">발행업체</th>
		</tr>
	</thead>
	<tbody role="m_tax">
	</tbody>
	<tbody role="m_tax_foot">
		<tr>
			<th class="colorG">합계</th>
			<th class="colorG text-number"></th>
			<th class="colorG text-number"></th>
			<th class="colorG text-number"></th>
			<th class="colorG text-number"></th>
			<th class="colorG text-number"></th>
		</tr>
	</tbody>
	<tbody role="s_tax">
	</tbody>
	<tbody role="s_tax_foot">
		<tr>
			<th class="colorG">합계</th>
			<th class="colorG text-number"></th>
			<th class="colorG text-number"></th>
			<th class="colorG text-number"></th>
			<th class="colorG text-number"></th>
			<th class="colorG text-number"></th>
		</tr>
	</tbody>
</table>
			</th>
			<th style="width:47%;padding:0px!important;vertical-align:top!important;">
<table style="width:100%;border:0px!important;" id="report_i2_rcppay">
	<colgroup>
		<col width="130">
		<col width="*">
		<col width="*">
		<col width="*">
		<col width="*">
	</colgroup>
	<thead>
		<tr>
			<th class="colorY">입금일자</th>
			<th class="colorY">금액</th>
			<th class="colorY">잔액</th>
			<th class="colorY">수금율</th>
			<th class="colorY">수금내역</th>
		</tr>
	</thead>
	<tbody role="m_rcppay">
	</tbody>
	<tbody role="m_rcppay_foot">
		<tr>
			<th class="colorG">합계</th>
			<th class="colorP text-number"></th>
			<th class="colorG text-number"></th>
			<th class="colorG text-number"></th>
			<th class="colorG text-number"></th>
		</tr>
	</tbody>
	<tbody role="s_rcppay">
	</tbody>
	<tbody role="s_rcppay_foot">
		<tr>
			<th class="colorG">합계</th>
			<th class="colorP text-number"></th>
			<th class="colorG text-number"></th>
			<th class="colorG text-number"></th>
			<th class="colorG text-number"></th>
		</tr>
	</tbody>
</table>
			</th>
		</tr>
	</tbody>
</table>
<!-- ---------------------------------------------------------------------- -->
<table>
	<tbody>
		<tr>
			<th class="sub-title colorN text-center" colspan="2">④ M,S/H 판매현황 (관리) - VAT포함</th>
		</tr>
	</tbody>
	<tbody role="body">
		<tr>
			<th style="width:53%;padding:0px!important;vertical-align:top!important;border-right:2px solid #555!important;">
<table style="width:100%;border:0px!important;" id="report_s3_taxbil">
	<colgroup>
		<col width="143">
		<col width="*">
		<col width="*">
		<col width="*">
		<col width="*">
	</colgroup>
	<thead>
		<tr>
			<th class="color-contract">판매일</th>
			<th class="color-contract">모델명</th>
			<th class="color-contract">수량</th>
			<th class="color-contract">금액</th>
			<th class="color-contract">판매금액</th>
		</tr>
	</thead>
	<tbody>
	</tbody>
	<tfoot>
		<tr>
			<th class="colorG">합계</th>
			<th class="colorG text-number"></th>
			<th class="colorG"></th>
			<th class="colorG text-number"></th>
			<th class="colorG text-number"></th>
		</tr>
	</tfoot>
</table>
			</th>
			<th style="width:47%;padding:0px!important;vertical-align:top!important;">
<table style="width:100%;border:0px!important;" id="report_i3_rcppay">
	<colgroup>
		<col width="130">
		<col width="*">
		<col width="*">
		<col width="*">
		<col width="*">
		<col width="*">
		<col width="*">
	</colgroup>
	<thead>
		<tr>
			<th class="colorY">발행업체</th>
			<th class="colorY">발행일자</th>
			<th class="colorY">발행금액</th>
			<th class="colorY">입금일자</th>
			<th class="colorY">입금금액</th>
			<th class="colorY">잔액</th>
			<th class="colorY">수금율</th>
		</tr>
	</thead>
	<tbody>
	</tbody>
	<tfoot>
		<tr>
			<th class="colorG"></th>
			<th class="colorG"></th>
			<th class="colorG text-number"></th>
			<th class="colorG"></th>
			<th class="colorP text-number"></th>
			<th class="colorG text-number"></th>
			<th class="colorG"></th>
		</tr>
	</tfoot>
</table>
			</th>
		</tr>
	</tbody>
</table>

<table id="rptTableOpt">
	<colgroup>
		<col width="50"/>
		<col width="160"/>
		<col width="80"/>
		<col width="80"/>
		<col width="80"/>
		<col width="180"/>
		<col width="100"/>
		<col width="160"/>
	</colgroup>
	<thead>
		<tr>
			<th class="sub-title colorN text-center" colspan="8">⑤ 옵션행사비</th>
		</tr>
		<tr>
			<th class="color-contract text-center">구분</th>
			<th class="color-contract text-center">행사기간</th>
			<th class="color-contract text-center">행사일(일)</th>
			<th class="color-contract text-center">도우미(명)</th>
			<th class="color-contract text-center">옵션율</th>
			<th class="color-contract text-center">옵션행사비</th>
			<th class="color-contract text-center">행사비 지급일</th>
			<th class="color-contract text-center">비고</th>
		</tr>
	</thead>
	<tbody role="body">
		<tr>
			<th class="colorSky text-center">예상</th>
			<td class="text-center" data-column="e_opt_period"></td>
			<td class="text-center" data-column="e_opt_dtm"></td>
			<td class="text-center" data-type="number" data-column="e_opt_helper"></td>
			<td class="text-center" data-column="e_opt_rate"></td>
			<td class="text-right" data-type="number" data-column="e_opt_amount"></td>
			<td class="text-center" data-column="e_opt_pay_dtm"></td>
			<td class="text-center" data-column="e_opt_rm"></td>
		</tr>
		<tr>
			<th class="colorSky text-center">정산</th>
			<td class="text-center" data-column="c_opt_period"></td>
			<td class="text-center" data-column="c_opt_dtm"></td>
			<td class="text-center" data-type="number" data-column="c_opt_helper"></td>
			<td class="text-center" data-column="c_opt_rate"></td>
			<td class="colorP text-right" data-type="number" data-column="c_opt_amount"></td>
			<td class="text-center" data-column="c_opt_pay_dtm"></td>
			<td class="text-center" data-column="c_opt_rm"></td>
		</tr>
	</tbody>
	<tfoot>
		<tr>
			<th class="colorG text-center">차이</th>
			<td class="colorG text-center"></td>
			<td class="colorG text-center"></td>
			<td class="colorG text-center"></td>
			<td class="colorG text-center"></td>
			<td class="colorG text-right" data-column="diff"></td>
			<td class="colorG text-center"></td>
			<td class="colorG text-center"></td>
		</tr>
	</tfoot>
</table>


<!-- ---------------------------------------------------------------------- -->
<table id="report_e_etc">
	<colgroup>
		<col width="145">
		<col width="150">
		<col width="*">
	</colgroup>
	<tbody>
		<tr>
			<th class="sub-title colorN text-center" colspan="6">⑥ 기타비용 (관리) - VAT포함</th>
		</tr>
		<tr>
			<th class="color-contract">일자</th>
			<th class="color-contract">계정과목</th>
			<th class="color-contract">내역</th>
			<th class="color-contract">지출자</th>
			<th class="color-contract">금액</th>
			<th class="color-contract">비고</th>
		</tr>
	</tbody>
	<tbody role="body"></tbody>
	<tfoot>
		<tr>
			<th class="colorG" colspan="4">합계</th>
			<th class="colorP text-number"></th>
			<th class="colorG"></th>
		</tr>
	</tfoot>
</table>
<!-- ---------------------------------------------------------------------- -->
<table id="rptTable13">
	<colgroup>
		<col width="145">
		<col width="*">
	</colgroup>
	<thead>
		<tr>
			<th class="sub-title colorN text-center" colspan="14">M,S/H, 옵션행사 예상/정산 비용 - VAT포함</th>
		</tr>
		<tr>
			<th class="colorO">구분</th>
			<th class="colorO">품목</th>
			<th class="colorO">세대수</th>
			<th class="colorO">분양세대</th>
			<th class="colorO">분양률</th>
			<th class="colorO">옵션 채택</th>
			<th class="colorO">옵션률</th>
			<th class="colorO">추정계약금액</th>
			<th class="colorO">추정수수료액</th>
			<th class="colorO">M,S/H건립비(장비+설치비)</th>
			<th class="colorO">옵션행사 비용</th>
			<th class="colorO">투입비용 합계</th>
			<th class="colorO" colspan="2">VA(%)</th>
		</tr>
	</thead>
	<tbody></tbody>
</table>
<!-- ---------------------------------------------------------------------- -->
<table>
	<colgroup>
		<col width="145">
		<col width="*">
		<col width="370">
	</colgroup>
	<tbody>
		<tr>
			<th class="colorO">특이사항</th>
			<td class="text-left" style="vertical-align: top!important;word-break:break-all!important;" id="partclr_matter">
			</td>
			<th class="colorW">
				<table>
					<tbody>
						<tr>
							<th class="colorW text-left" width="100">A:매우잘함</th>
							<th class="colorW">평가(관리,작성,정확성,카드작성)</th>
						</tr>
						<tr>
							<th class="colorW text-left">B:잘함</th>
							<td class="colorW" rowspan="3"></td>
						</tr>
						<tr>
							<th class="colorW text-left">C:부족</th>
						</tr>
						<tr>
							<th class="colorW text-left">D:불량</th>
						</tr>
					</tbody>
				</table>
			</th>
		</tr>
	</tbody>
</table>

			</div><!--modal-body-->
        </div><!--modal-content-->
    </div><!--modal-dialog-->
</div>
<!-- 레포트1 레이어 팝업 끝 -->

<script>
    $(document).ready(function(){
	$.ajax({
		url: '/api/project/ajax_get_reportBF',
		type: 'GET',
		data: {{ params | tojson | safe }},
		success: function(pResult) {
			console.log('getReportBF', pResult);
			if (pResult.status)
			{
				var contract = pResult.contract;
				var project = pResult.project;
				var charger = pResult.charger;

				$('#popReportBF').find('td').html(''); // 폼 초기화

				/* 프로젝트 기본 정보 */
				/* ********************************************************* */
				$('#popReportBF').find('#manage_no').html(contract.cntrct_no); //관리자,관리번호
				$('#popReportBF').find('#regist_dtm').html(contract.regist_dtm); //작성일
				$('#popReportBF').find('#bsn_chrg_nm').html(contract.bsn_chrg_nm); //영업담당
				$('#popReportBF').find('#spt_chrg_nm').html(contract.spt_chrg_nm); //공무담당
				$('#popReportBF').find('#cntrct_de').html(contract.cntrct_de); //계약일
				$('#popReportBF').find('#bcnc_nm').html(contract.bcnc_nm); //거래처
				$('#popReportBF').find('#spt_nm').html(contract.spt_nm); //현장명
				$('#popReportBF').find('#cntrwk_period').html(contract.cntrwk_period); //공사기간
				$('#popReportBF').find('#expect_de').html(contract.expect_de); //공사기간
				$('#popReportBF').find('#home_count').html(contract.home_count); //세대수
				$('#popReportBF').find('#home_region').html(contract.home_region); //지역
				$('#popReportBF').find('[name=prjct_ty_code]').yVal(contract.prjct_ty_code); //프로젝트 유형
				$('#popReportBF').find('[name=prjct_ty_code]').yReadonly(true); //프로젝트 유형
				$('#popReportBF').find('[name=prjct_creat_at]').yVal(contract.prjct_creat_at); //프로젝트 생성
				$('#popReportBF').find('[name=prjct_creat_at]').yReadonly(true); //프로젝트 생성
				$('#popReportBF').find('[name=progrs_sttus_code]').yVal(contract.progrs_sttus_code); //프로젝트 진행
				$('#popReportBF').find('[name=progrs_sttus_code]').yReadonly(true); //프로젝트 진행

//                $('#popReportBF').find('#biss_a').html(biss2text(contract.biss_a));
//                $('#popReportBF').find('#biss_b').html(biss2text(contract.biss_b));
//                $('#popReportBF').find('#biss_c').html(biss2text(contract.biss_c));
//                $('#popReportBF').find('#biss_d').html(biss2text(contract.biss_d));
//                $('#popReportBF').find('#biss_e').html(biss2text(contract.biss_e));
//                $('#popReportBF').find('#biss_f').html(biss2text(contract.biss_f));
//                $('#popReportBF').find('#biss_g').html(biss2text(contract.biss_g));
//                $('#popReportBF').find('#biss_h').html(biss2text(contract.biss_h));
//                $('#popReportBF').find('#biss_i').html(biss2text(contract.biss_i));

				if(contract.renewal == 0){
					$('#renewal').removeClass("btn-success").addClass("btn-danger");
					$('#renewal').find("i").removeClass("fa-smile-o").addClass("fa-frown-o");
				}
				else{
					$('#renewal').removeClass("btn-danger").addClass("btn-success");
					$('#renewal').find("i").removeClass("fa-frown-o").addClass("fa-smile-o");
				}

				{% if session["member"]["auth_cd"] == 1 or session["member"]["member_sn"] in (4, 21, 26, 63) %}
				$(document).on("click", "#renewal", function(){
					var renewal = $('#renewal').hasClass("btn-danger") ? 1 : 0;
					var params = {"cntrct_sn" : contract.cntrct_sn, "renewal" : renewal};
					$.ajax({
						url : '/api/project/ajax_update_renewal',
						method : 'POST',
						data : params,
						success: function(){
							$('#renewal').toggleClass("btn-danger").toggleClass("btn-success");
							$('#renewal').find("i").toggleClass("fa-frown-o").toggleClass("fa-smile-o");
						},
						error: function(){
							alert("에러가 발생했습니다. 다시 시도해주세요.");
						}
					})


				});
				{% endif %}

				$('#popReportBF').find('#spt_adres').html(contract.spt_adres); //현장주소
				$('#popReportBF').find('#eqpmn_dtls').html(project.eqpmn_dtls); //장비내역
				$('#popReportBF').find('#cntrwk_dtls').html(project.cntrwk_dtls); //공사내역
				$('#popReportBF').find('#drw_opertor_nm').html(project.drw_opertor_nm); //도면작업자
				$('#popReportBF').find('#acmslt_sttemnt_at').html(project.acmslt_sttemnt_at); //실적신고
				$('#popReportBF').find('#cntwrk_regstr_ennc').html(project.cntwrk_regstr_ennc); //건설공사대장

				$.each(charger, function(pIndex, pValue) { //담당자정보
					$('#popReportBF').find('#charger_nm'+pValue.charger_se_code).html(pValue.charger_nm);
					$('#popReportBF').find('#charger_moblphon'+pValue.charger_se_code).html(pValue.charger_moblphon);
				});

				if (project.cntrct_dscnt_rt != 0) { //계약할인율
					$('#popReportBF').find('#cntrct_dscnt_rt').html(project.cntrct_dscnt_rt+'%');
				}
				if (project.cnsul_dscnt_rt != 0) { //품의할인율
					$('#popReportBF').find('#cnsul_dscnt_rt').html(project.cnsul_dscnt_rt+'%');
				}
				$('#popReportBF').find('#enty').html(project.enty.toString().toFormat('NUMBER')); //계약금
				$('#popReportBF').find('#enty_de').html(project.enty_de); //계약금일자
				$('#popReportBF').find('#enty_rm').html(project.enty_rm); //계약금비고
				$('#popReportBF').find('#prtpay').html(project.prtpay.toString().toFormat('NUMBER')); //중도금
				$('#popReportBF').find('#prtpay_de').html(project.prtpay_de); //중도금일자
				$('#popReportBF').find('#prtpay_rm').html(project.prtpay_rm); //중도금비고
				$('#popReportBF').find('#surlus').html(project.surlus.toString().toFormat('NUMBER')); //잔금
				$('#popReportBF').find('#surlus_de').html(project.surlus_de); //잔금일자
				$('#popReportBF').find('#surlus_rm').html(project.surlus_rm); //잔금비고
				$('#popReportBF').find('#setle_mth').html(project.setle_mth); //결제방법(2)

				/* ********************************************************* */

				/* 프로젝트 진행 예정 보고서 (영업) */
				/* ********************************************************* */
				var cCostTotalExtra = 0;
				var eCostTotalExtra = 0;
				/* ********************************************************* */

				/* 수주 품목 및 수수료 내역 (영업) */
				/* ********************************************************* */
				var html = '';
				var cCostList = pResult.cCostListExtra;
				var p_sum_totalExtra = 0, dlivy_sum = 0, fee_rt_avgExtra = 0.0, real_amt_totalExtra = 0;
                var qy_totExtra = 0;
				var bCostDTM = '9999-99-99';

				$.each(cCostList, function(pIndex, pValue) {
					if(bCostDTM > pValue.regist_dtm){
						bCostDTM = pValue.regist_dtm;
					}
					var dscnt_rt = '';
					if (pValue.dscnt_rt != '') dscnt_rt = parseFloat(pValue.dscnt_rt).toFixed(1)+'%';
					var fee_rt = '';
					if (pValue.fee_rt != '') fee_rt = parseFloat(pValue.fee_rt).toFixed(1)+'%';
					var p_dc_amt = Math.round(pValue.puchas_amount * ((100-pValue.dscnt_rt)/100));
					var p_dc_amt_sum = p_dc_amt * parseInt(pValue.qy);
					var real_amt = p_dc_amt_sum * (pValue.fee_rt/100);
					html += '<tr>';
					html += '    <td class="colorSky">사전입찰</td>';
					html += '    <td>'+pValue.model_no+'</td>';
					html += '    <td class="text-center">'+pValue.qy.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number"></td>';
					html += '    <td class="text-number">'+pValue.puchas_amount.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-center">'+dscnt_rt+'</td>';
					html += '    <td class="text-number">'+p_dc_amt.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+p_dc_amt_sum.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-center">'+fee_rt+'</td>';
					html += '    <td class="text-number">'+real_amt.toString().toFormat('NUMBER')+'</td>';
					html += '</tr>';
					p_sum_totalExtra += p_dc_amt_sum;
					dlivy_sum += parseInt(pValue.puchas_amount)*parseInt(pValue.qy);
					real_amt_totalExtra += real_amt;
                    qy_totExtra += parseInt(pValue.qy);
				});
				fee_rt_avgExtra = (real_amt_totalExtra/p_sum_totalExtra)*100;
                // html += '<tr>';
                // html += '    <td class="colorSky" style="border-bottom:2px solid #000!important;">예정</td>';
                // html += '    <td class="colorSky" style="border-bottom:2px solid #000!important;">합계</td>';
                // html += '    <td class="text-number colorSky" style="border-bottom:2px solid #000!important;">'+qy_totExtra.toString().toFormat('NUMBER')+'</td>';
                // html += '    <td class="text-number colorSky" style="border-bottom:2px solid #000!important;"></td>';
                // html += '    <td class="text-number colorSky" style="border-bottom:2px solid #000!important;"></td>';
                // html += '    <td class="text-number colorSky" style="border-bottom:2px solid #000!important;"></td>';
                // html += '    <td class="text-number colorSky" style="border-bottom:2px solid #000!important;">'+p_sum_totalExtra.toString().toFormat('NUMBER')+'</td>';
                // html += '    <td class="text-number colorSky" style="border-bottom:2px solid #000!important;">'+fee_rt_avgExtra.toFixed(1)+'%'+'</td>';
                // html += '    <td class="text-number colorSky" style="border-bottom:2px solid #000!important;">'+real_amt_totalExtra.toString().toFormat('NUMBER')+'</td>';
                // html += '</tr>';

                $('#popReportBF').find('tbody[role="construct_expect_row"]').html(html);
                $('#popReportBF').find('tbody[role="construct_expect_row"]').yRowspan(0);
                $('#popReportBF').find(`td[data-column="expect_qy_total"]`).html(qy_totExtra.toString().toFormat('NUMBER'));
                $('#popReportBF').find(`td[data-column="expect_dc_rate_total"]`).html(((100 - p_sum_totalExtra*100.0/dlivy_sum)).toFixed(1)+"%");
                $('#popReportBF').find(`td[data-column="expect_cntrct_amount_total"]`).html(p_sum_totalExtra.toString().toFormat('NUMBER'));
                $('#popReportBF').find(`td[data-column="expect_rate_total"]`).html(fee_rt_avgExtra.toFixed(1)+'%');
                $('#popReportBF').find(`td[data-column="expect_cntrct_fee_amount_total"]`).html(real_amt_totalExtra.toString().toFormat('NUMBER'));



				cCostTotalExtra = real_amt_totalExtra;
				// $('#popReportBF').find('#report_plan tbody[role=plan] td:eq(0)').html('㉠ 예상 (사전입찰)');
				$('#popReportBF').find('#report_plan tbody[role=plan] td:eq(0)').html(real_amt_totalExtra.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_plan tbody[role=plan] td:eq(1)').html((real_amt_totalExtra*100.0/p_sum_totalExtra).toFixed(1)+'%');
				$('#popReportBF').find('#report_plan tbody[role=plan] td:eq(2)').html(p_sum_totalExtra.toString().toFormat('NUMBER'));



                /* 프로젝트 진행 예정 보고서 (영업) */
				/* ********************************************************* */
				var cCostTotal = 0;
				var eCostTotal = 0;
				/* ********************************************************* */
				/* 수주 품목 및 수수료 내역 (영업) */
				/* ********************************************************* */
				var base = {0 : {"real_amt_total" : 0, "p_sum_total" : 0, "p_dsp_amt_total" : 0, "p_add_dc_amt_total" : 0, "p_sell_amt_total" : 0, "p_option_amt_total" : 0, "p_etc_amt_total" : 0, "cCostDTM" : "9999-99-99"}};
				if(contract.progrs_sttus_code != 'B') {
					var cCostList = pResult.cCostList;
					console.log(cCostList);
					var p_sum_total = 0, dlivy_sum = 0, fee_rt_avg = 0.0, real_amt_total = 0;
					var qy_tot = 0;
					var html = '';
					$.each(cCostList, function (pIndex, pValue) {
						var dscnt_rt = '';
						if (pValue.dscnt_rt != '') dscnt_rt = parseFloat(pValue.dscnt_rt).toFixed(1) + '%';
						var fee_rt = '';
						if (pValue.fee_rt != '') fee_rt = parseFloat(pValue.fee_rt).toFixed(1) + '%';
						var p_dc_amt = Math.round(pValue.puchas_amount * ((100 - pValue.dscnt_rt) / 100));
						var p_dc_amt_sum = p_dc_amt * parseInt(pValue.qy);
						var real_amt = p_dc_amt_sum * (pValue.fee_rt / 100);
						html += '<tr>';
						html += '    <td class="colorSky">수주계약</td>';
						html += '    <td>' + pValue.model_no + '</td>';
						html += '    <td class="text-center">' + pValue.qy.toString().toFormat('NUMBER') + '</td>';
						html += '    <td class="text-number"></td>';
						html += '    <td class="text-number">' + pValue.puchas_amount.toString().toFormat('NUMBER') + '</td>';
						html += '    <td class="text-center">' + dscnt_rt + '</td>';
						html += '    <td class="text-number">' + p_dc_amt.toString().toFormat('NUMBER') + '</td>';
						html += '    <td class="text-number">' + p_dc_amt_sum.toString().toFormat('NUMBER') + '</td>';
						html += '    <td class="text-center">' + fee_rt + '</td>';
						html += '    <td class="text-number">' + real_amt.toString().toFormat('NUMBER') + '</td>';
						html += '</tr>';
						if(!base.hasOwnProperty(pValue.extra_sn)){
							base[pValue.extra_sn] = {"real_amt_total" : 0, "p_sum_total" : 0, "p_dsp_amt_total" : 0, "p_add_dc_amt_total" : 0, "p_sell_amt_total" : 0, "p_option_amt_total" : 0, "p_etc_amt_total" : 0, "cCostDTM" : "9999-99-99"};
						}
						base[pValue.extra_sn].p_sum_total += p_dc_amt_sum;
						base[pValue.extra_sn].real_amt_total += real_amt;
						if(base[pValue.extra_sn].cCostDTM > pValue.regist_dtm){
							base[pValue.extra_sn].cCostDTM = pValue.regist_dtm;
						}

						p_sum_total += p_dc_amt_sum;
						real_amt_total += real_amt;
						dlivy_sum += parseInt(pValue.puchas_amount) * parseInt(pValue.qy);
						qy_tot += parseInt(pValue.qy);
					});
					fee_rt_avg = (real_amt_total / p_sum_total) * 100;
					// html += '<tr>';
					// html += '    <td class="colorSky">확정</td>';
					// html += '    <td class="colorSky">합계</td>';
					// html += '    <td class="text-number colorSky">'+qy_tot.toString().toFormat('NUMBER')+'</td>';
					// html += '    <td class="text-number colorSky"></td>';
					// html += '    <td class="text-number colorSky"></td>';
					// html += '    <td class="text-number colorSky"></td>';
					// html += '    <td class="text-number colorSky">'+p_sum_total.toString().toFormat('NUMBER')+'</td>';
					// html += '    <td class="text-number colorSky">'+fee_rt_avg.toFixed(1)+'%'+'</td>';
					// html += '    <td class="text-number color-contract">'+real_amt_total.toString().toFormat('NUMBER')+'</td>';
					// html += '</tr>';
					$('#popReportBF').find('tbody[role="construct_row"]').html(html);
					$('#popReportBF').find('tbody[role="construct_row"]').yRowspan(0);
					$('#popReportBF').find('tbody[role="construct_row_total"]').show();
					$('#popReportBF').find(`td[data-column="qy_total"]`).html(qy_tot.toString().toFormat('NUMBER'));
					$('#popReportBF').find(`td[data-column="dc_rate_total"]`).html(((100 - p_sum_total * 100.0 / dlivy_sum)).toFixed(1) + "%");
					$('#popReportBF').find(`td[data-column="cntrct_amount_total"]`).html(p_sum_total.toString().toFormat('NUMBER'));
					$('#popReportBF').find(`td[data-column="rate_total"]`).html(fee_rt_avg.toFixed(1) + '%');
					$('#popReportBF').find(`td[data-column="cntrct_fee_amount_total"]`).html(real_amt_total.toString().toFormat('NUMBER'));
					cCostTotal = real_amt_total;
					// $('#popReportBF').find('#report_plan tbody[role=exec] td:eq(0)').html('㉡ 계약현황');
					$('#popReportBF').find('#report_plan tbody[role=exec] td:eq(0)').html(base[0].real_amt_total.toString().toFormat('NUMBER'));
					$('#popReportBF').find('#report_plan tbody[role=exec] td:eq(1)').html((base[0].real_amt_total*100.0/base[0].p_sum_total).toFixed(1)+'%');
					$('#popReportBF').find('#report_plan tbody[role=exec] td:eq(2)').html(base[0].p_sum_total.toString().toFormat('NUMBER'));

					$('#popReportBF').find('#report_exec tbody[role=body] tr[data-row="result"] td:eq(1)').html(fee_rt_avg.toFixed(1)+'%');
					$('#popReportBF').find('#report_exec tbody[role=body] tr[data-row="result"] td:eq(0)').html(p_sum_total.toString().toFormat('NUMBER'));
					$('#popReportBF').find('#report_exec tbody[role=body] tr[data-row="result"] th:eq(1)').html((p_sum_total * (isNaN(fee_rt_avg) ? 0 : fee_rt_avg) / 100.0).toString().toFormat('NUMBER'));

				}

                // $('#popReportBF').find('#report_c_cost tbody[role=body]').html(html);
                // $('#popReportBF').find('#report_c_cost tbody[role=body]').yRowspan(0);




				/* ********************************************************* */
				/* 모델(샘플)하우스 전시내역 */
				/* ********************************************************* */
				var html = '';
				var eCostList = pResult.eCostListExtra;
				var p_dsp_amt_totalExtra = 0, p_add_dc_amt_totalExtra = 0, p_real_dsp_amt_totalExtra = 0, p_option_amt_totalExtra = 0, p_etc_amt_totalExtra = 0;
                var p_dc_amt_totExtra = 0, qy_totExtra = 0;
				$.each(eCostList, function(pIndex, pValue) {
					if (pValue.dspy_se_code != '') {
						if(bCostDTM > pValue.regist_dtm){
							bCostDTM = pValue.regist_dtm;
						}

                        var p_puchas_amount = pValue.puchas_amount;
                        var p_puchas = (p_puchas_amount*parseInt(pValue.qy));
						var p_dc_amt = Math.round(pValue.puchas_amount * ((100-pValue.dscnt_rt)/100));
						var p_dsp_amt = p_dc_amt * parseInt(pValue.qy);
						var p_add_dc_amt = Math.round(((pValue.puchas_amount * parseInt(pValue.qy))*pValue.add_dscnt_rt)/100);
						var p_real_dsp_amt = p_dsp_amt - p_add_dc_amt;
						if (pValue.ct_se_code != '7') {
							html += '<tr>';
							html += '    <td class="colorSky">예정</td>';
							html += '    <td>'+pValue.dspy_se_nm+'</td>';
							html += '    <td>'+pValue.dspy_de+'</td>';
							html += '    <td>'+pValue.model_no+'</td>';
							html += '    <td class="text-number">'+pValue.qy.toString().toFormat('NUMBER')+'</td>';
							html += '    <td class="text-number">'+pValue.puchas_amount.toString().toFormat('NUMBER')+'</td>';
							if (pValue.ct_se_code == '61') {
								html += '    <td class="text-number">'+p_dc_amt.toString().toFormat('NUMBER')+'</td>';
								html += '    <td class="text-number">'+p_dsp_amt.toString().toFormat('NUMBER')+'</td>';
								html += '    <td class="text-number">'+p_add_dc_amt.toString().toFormat('NUMBER')+'</td>';
								html += '    <td class="text-number">'+p_real_dsp_amt.toString().toFormat('NUMBER')+'</td>';
							} else {
								html += '    <td class="text-number"></td>';
								html += '    <td class="text-number"></td>';
								html += '    <td class="text-number"></td>';
								html += '    <td class="text-number"></td>';
							}
							html += '</tr>';
                            qy_totExtra += parseInt(pValue.qy);
						}
						if (pValue.ct_se_code == '61') { //모델하우스(매입)
							p_dsp_amt_totalExtra += p_dsp_amt;
							p_add_dc_amt_totalExtra += p_add_dc_amt;
							p_real_dsp_amt_totalExtra += p_real_dsp_amt;
                            p_dc_amt_totExtra += p_dc_amt;

						}

					}

					var t_pamt = pValue.puchas_amount == '' ? 0 : parseInt(pValue.puchas_amount);
					var t_pqty = pValue.qy == '' ? 0 : parseInt(pValue.qy);
					if (pValue.ct_se_code == '7') { //옵션행사비
						p_option_amt_totalExtra += (t_pamt*t_pqty);
					} else if (pValue.ct_se_code == '10') { //기타
						p_etc_amt_totalExtra += (t_pamt*t_pqty);
					}
				});
                html += '<tr>';
                html += '    <td class="colorSky" style="border-bottom:2px solid #000!important;">예정</td>';
                html += '    <td class="colorSky" style="border-bottom:2px solid #000!important;">합계</td>';
                html += '    <td class="colorSky" style="border-bottom:2px solid #000!important;"></td>';
                html += '    <td class="colorSky" style="border-bottom:2px solid #000!important;"></td>';
                html += '    <td class="text-number colorSky" style="border-bottom:2px solid #000!important;">'+qy_totExtra.toString().toFormat('NUMBER')+'</td>';
                html += '    <td class="text-number colorSky" style="border-bottom:2px solid #000!important;"></td>';
                html += '    <td class="text-number colorSky" style="border-bottom:2px solid #000!important;"></td>';
                html += '    <td class="text-number colorSky" style="border-bottom:2px solid #000!important;">'+p_dsp_amt_totalExtra.toString().toFormat('NUMBER')+'</td>';
                html += '    <td class="text-number colorSky" style="border-bottom:2px solid #000!important;">'+p_add_dc_amt_totalExtra.toString().toFormat('NUMBER')+'</td>';
                html += '    <td class="text-number colorSky" style="border-bottom:2px solid #000!important;">'+p_real_dsp_amt_totalExtra.toString().toFormat('NUMBER')+'</td>';
                html += '</tr>';


                var gCostList = pResult.gCostListExtra;
                console.log('gCostList', gCostList);
                var p_sell_amt_totalExtra = 0;
                $.each(gCostList, function(pIndex, pValue) {
					if(bCostDTM > pValue.regist_dtm){
						bCostDTM = pValue.regist_dtm;
					}

					var p_puchas_amount = pValue.salamt;
                    var p_puchas = (p_puchas_amount*parseInt(pValue.qy));

                    if (pValue.ct_se_code == '63') { //모델하우스(판매)
                        p_sell_amt_totalExtra += p_puchas;
                        console.log("sell_amt_total", p_sell_amt_totalExtra);
                    }

					var t_pamt = pValue.puchas_amount == '' ? 0 : parseInt(pValue.puchas_amount);
					var t_pqty = pValue.qy == '' ? 0 : parseInt(pValue.qy);

				});
                $('#popReportBF').find('#report_plan tbody[role=plan] td:eq(5)').html(p_sell_amt_totalExtra.toString().toFormat('NUMBER'));
				eCostTotalExtra = p_add_dc_amt_totalExtra;
				var tmp = real_amt_totalExtra - p_real_dsp_amt_totalExtra - p_option_amt_totalExtra - p_etc_amt_totalExtra + p_sell_amt_totalExtra;
				var va = (tmp/cCostTotalExtra)*100;
				$('#popReportBF').find('#report_plan tbody[role=plan] td:eq(3)').html(p_dsp_amt_totalExtra.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_plan tbody[role=plan] td:eq(4)').html(p_add_dc_amt_totalExtra.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_plan tbody[role=plan] td:eq(6)').html(p_option_amt_totalExtra.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_plan tbody[role=plan] td:eq(7)').html(p_etc_amt_totalExtra.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_plan tbody[role=plan] td:eq(9)').html(tmp.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_plan tbody[role=plan] td:eq(10)').html(va.toFixed(1)+'%');
				$('#popReportBF').find('#report_plan tbody[role=plan] td:eq(11)').html(bCostDTM);

				var eCostList = pResult.eCostList;
				var p_dsp_amt_total = 0, p_add_dc_amt_total = 0, p_real_dsp_amt_total = 0, p_option_amt_total = 0, p_etc_amt_total = 0;
                var p_dc_amt_tot = 0, qy_tot = 0;
				$.each(eCostList, function(pIndex, pValue) {
					if (pValue.dspy_se_code != '') {
                        var p_puchas_amount = pValue.puchas_amount;
                        var p_puchas = (p_puchas_amount*parseInt(pValue.qy));
						var p_dc_amt = Math.round(pValue.puchas_amount * ((100-pValue.dscnt_rt)/100));
						var p_dsp_amt = p_dc_amt * parseInt(pValue.qy);
						var p_add_dc_amt = Math.round(((pValue.puchas_amount * parseInt(pValue.qy))*pValue.add_dscnt_rt)/100);
						var p_real_dsp_amt = p_dsp_amt - p_add_dc_amt;
						if (pValue.ct_se_code != '7') {
							html += '<tr>';
							html += '    <td class="colorSky">확정</td>';
							html += '    <td>'+pValue.dspy_se_nm+'</td>';
							html += '    <td>'+pValue.dspy_de+'</td>';
							html += '    <td>'+pValue.model_no+'</td>';
							html += '    <td class="text-number">'+pValue.qy.toString().toFormat('NUMBER')+'</td>';
							html += '    <td class="text-number">'+pValue.puchas_amount.toString().toFormat('NUMBER')+'</td>';
							if (pValue.ct_se_code == '61') {
								html += '    <td class="text-number">'+p_dc_amt.toString().toFormat('NUMBER')+'</td>';
								html += '    <td class="text-number">'+p_dsp_amt.toString().toFormat('NUMBER')+'</td>';
								html += '    <td class="text-number">'+p_add_dc_amt.toString().toFormat('NUMBER')+'</td>';
								html += '    <td class="text-number">'+p_real_dsp_amt.toString().toFormat('NUMBER')+'</td>';
							} else {
								html += '    <td class="text-number"></td>';
								html += '    <td class="text-number"></td>';
								html += '    <td class="text-number"></td>';
								html += '    <td class="text-number"></td>';
							}
							html += '</tr>';
                            qy_tot += parseInt(pValue.qy);
						}
						if (pValue.ct_se_code == '61' || pValue.ct_se_code == '64') { //모델하우스(매입)
							if(!base.hasOwnProperty(pValue.extra_sn)){
								base[pValue.extra_sn] = {"real_amt_total" : 0, "p_sum_total" : 0, "p_dsp_amt_total" : 0, "p_add_dc_amt_total" : 0, "p_sell_amt_total" : 0, "p_option_amt_total" : 0, "p_etc_amt_total" : 0, "cCostDTM" : "9999-99-99"};
							}
							if(base[pValue.extra_sn].cCostDTM > pValue.regist_dtm){
								base[pValue.extra_sn].cCostDTM = pValue.regist_dtm;
							}

							base[pValue.extra_sn].p_dsp_amt_total += p_dsp_amt;
							base[pValue.extra_sn].p_add_dc_amt_total += p_add_dc_amt;

							p_dsp_amt_total += p_dsp_amt;
							p_add_dc_amt_total += p_add_dc_amt;
							p_real_dsp_amt_total += p_real_dsp_amt;
                            p_dc_amt_tot += p_dc_amt;

						}

					}

					var t_pamt = pValue.puchas_amount == '' ? 0 : parseInt(pValue.puchas_amount);
					var t_pqty = pValue.qy == '' ? 0 : parseInt(pValue.qy);
					if (pValue.ct_se_code == '7') { //옵션행사비

						if(!base.hasOwnProperty(pValue.extra_sn)){
							base[pValue.extra_sn] = {"real_amt_total" : 0, "p_sum_total" : 0, "p_dsp_amt_total" : 0, "p_add_dc_amt_total" : 0, "p_sell_amt_total" : 0, "p_option_amt_total" : 0, "p_etc_amt_total" : 0, "cCostDTM" : "9999-99-99"};
						}
						if(base[pValue.extra_sn].cCostDTM > pValue.regist_dtm){
							base[pValue.extra_sn].cCostDTM = pValue.regist_dtm;
						}

						p_option_amt_total += (t_pamt*t_pqty);
						base[pValue.extra_sn].p_option_amt_total += (t_pamt*t_pqty);
					} else if (pValue.ct_se_code == '10') { //기타
						if(!base.hasOwnProperty(pValue.extra_sn)){
							base[pValue.extra_sn] = {"real_amt_total" : 0, "p_sum_total" : 0, "p_dsp_amt_total" : 0, "p_add_dc_amt_total" : 0, "p_sell_amt_total" : 0, "p_option_amt_total" : 0, "p_etc_amt_total" : 0, "cCostDTM" : "9999-99-99"};
						}
						if(base[pValue.extra_sn].cCostDTM > pValue.regist_dtm){
							base[pValue.extra_sn].cCostDTM = pValue.regist_dtm;
						}

						p_etc_amt_total += (t_pamt*t_pqty);
						base[pValue.extra_sn].p_etc_amt_total += (t_pamt*t_pqty);
					}
				});
                html += '<tr>';
                html += '    <td class="colorSky">확정</td>';
                html += '    <td class="colorSky">합계</td>';
                html += '    <td class="colorSky"></td>';
                html += '    <td class="colorSky"></td>';
                html += '    <td class="text-number colorSky">'+qy_tot.toString().toFormat('NUMBER')+'</td>';
                html += '    <td class="text-number colorSky"></td>';
                html += '    <td class="text-number colorSky"></td>';
                html += '    <td class="text-number colorSky">'+p_dsp_amt_total.toString().toFormat('NUMBER')+'</td>';
                html += '    <td class="text-number colorSky">'+p_add_dc_amt_total.toString().toFormat('NUMBER')+'</td>';
                html += '    <td class="text-number colorSky">'+p_real_dsp_amt_total.toString().toFormat('NUMBER')+'</td>';
                html += '</tr>';

				// $('#popReportBF').find('#report_e_cost tbody[role=body]').html(html);
                // $('#popReportBF').find('#report_e_cost tbody[role=body]').yRowspan(0);


                var gCostList = pResult.gCostList;
                console.log('gCostList', gCostList);
                var p_sell_amt_total = 0;
                $.each(gCostList, function(pIndex, pValue) {
					var p_puchas_amount = pValue.salamt;
                    var p_puchas = (p_puchas_amount*parseInt(pValue.qy));

                    if (pValue.ct_se_code == '63') { //모델하우스(판매)
                    	if(!base.hasOwnProperty(pValue.extra_sn)){
							base[pValue.extra_sn] = {"real_amt_total" : 0, "p_sum_total" : 0, "p_dsp_amt_total" : 0, "p_add_dc_amt_total" : 0, "p_sell_amt_total" : 0, "p_option_amt_total" : 0, "p_etc_amt_total" : 0, "cCostDTM" : "9999-99-99"};
						}
						if(base[pValue.extra_sn].cCostDTM > pValue.regist_dtm){
							base[pValue.extra_sn].cCostDTM = pValue.regist_dtm;
						}

                        base[pValue.extra_sn].p_sell_amt_total += p_puchas;
                        p_sell_amt_total += p_puchas;
                        console.log("sell_amt_total", p_sell_amt_total);
                    }

					var t_pamt = pValue.puchas_amount == '' ? 0 : parseInt(pValue.puchas_amount);
					var t_pqty = pValue.qy == '' ? 0 : parseInt(pValue.qy);

				});

				console.log(base);
				base[0].p_option_amt_total = (pResult.sOptionCostList!= null) ? parseInt(pResult.sOptionCostList.c_opt_amount) : base[0].p_option_amt_total;
				if(isNaN(base[0].p_option_amt_total)) base[0].p_option_amt_total = 0;

                $('#popReportBF').find('#report_plan tbody[role=exec] td:eq(5)').html(base[0].p_sell_amt_total.toString().toFormat('NUMBER'));
				eCostTotal = p_add_dc_amt_total;

				real_amt_total = isNaN(real_amt_total) ? 0 : real_amt_total;
				p_real_dsp_amt_total = isNaN(p_real_dsp_amt_total) ? 0 : p_real_dsp_amt_total;
				base[0].p_option_amt_total = isNaN(base[0].p_option_amt_total) ? 0 : base[0].p_option_amt_total;
				base[0].p_etc_amt_total = isNaN(base[0].p_etc_amt_total) ? 0 : base[0].p_etc_amt_total;
				base[0].p_sell_amt_total = isNaN(base[0].p_sell_amt_total) ? 0 : base[0].p_sell_amt_total;

				var tmp = base[0].real_amt_total - (base[0].p_dsp_amt_total - base[0].p_add_dc_amt_total) - base[0].p_option_amt_total - base[0].p_etc_amt_total + base[0].p_sell_amt_total;
//				var va = (tmp/p_sum_total)*100;
				var va = (tmp/base[0].real_amt_total)*100;

				$('#popReportBF').find('#report_plan tbody[role=exec] td:eq(3)').html(base[0].p_dsp_amt_total.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_plan tbody[role=exec] td:eq(4)').html(base[0].p_add_dc_amt_total.toString().toFormat('NUMBER'));
//				$('#popReportBF').find('#report_plan tbody td:eq(6)').html(p_real_dsp_amt_total.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_plan tbody[role=exec] td:eq(6)').html(base[0].p_option_amt_total.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_plan tbody[role=exec] td:eq(7)').html(base[0].p_etc_amt_total.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_plan tbody[role=exec] td:eq(9)').html(tmp.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_plan tbody[role=exec]  td:eq(10)').html((va == Infinity)? "-" : (va.toFixed(1)+'%'));
				$('#popReportBF').find('#report_plan tbody[role=exec]  td:eq(11)').html(base[0].cCostDTM);
				/* ********************************************************* */

				var base_temp = {};
				var html = '<tbody role="extra">';
				$.each(Object.keys(base).sort(), function(pIndex, extra_sn){
					if(extra_sn == 0){
						base_temp = base[extra_sn];
					}
					else{
						$.each(base[extra_sn], function(key, value){
							if(key != "cCostDTM"){
								base_temp[key] += isNaN(value) ? 0 : value;
							}
						});
						var tmp = base_temp.real_amt_total - (base_temp.p_dsp_amt_total - base_temp.p_add_dc_amt_total) - base_temp.p_option_amt_total - base_temp.p_etc_amt_total + base_temp.p_sell_amt_total;
						var va = (tmp/base_temp.real_amt_total)*100;
						html += `
									<tr>
										<th class="colorN text-center">변경-${pIndex}</th>
										<th class="colorSky text-center">계약가</th>
										<td class="color text-number">${base_temp.real_amt_total.toString().toFormat('NUMBER')}</td>
										<td class="color text-number">${(base_temp.real_amt_total*100.0/base_temp.p_sum_total).toFixed(1)+'%'}</td>
										<td class="color text-number">${base_temp.p_sum_total.toString().toFormat('NUMBER')}</td>
										<td class="color text-number">${base_temp.p_dsp_amt_total.toString().toFormat('NUMBER')}</td>
										<td class="color text-number">${base_temp.p_add_dc_amt_total.toString().toFormat('NUMBER')}</td>
										<td class="color text-number">${base_temp.p_sell_amt_total.toString().toFormat('NUMBER')}</td>
										<td class="color text-number">${base_temp.p_option_amt_total.toString().toFormat('NUMBER')}</td>
										<td class="color text-number">${base_temp.p_etc_amt_total.toString().toFormat('NUMBER')}</td>
										<td class="color text-number"></td>
										<td class="color text-number">${tmp.toString().toFormat('NUMBER')}</td>
										<td class="color text-number">${(va == Infinity)? "-" : (va.toFixed(1)+'%')}</td>
										<td class="color text-center">${base[extra_sn].cCostDTM}</td>
									</tr>
								`
					}
				});
				html += '</tbody>';
				$(html).insertAfter($(document).find(`#report_plan tbody[role="exec"]`));
                				/* 계약조건 */
				/* ********************************************************* */
				$('#popReportBF').find('#enty').html(project.enty.toString().toFormat('NUMBER')); //계약금
				$('#popReportBF').find('#enty_de').html(project.enty_de); //계약금일자
				$('#popReportBF').find('#enty_rm').html(project.enty_rm); //계약금비고
				$('#popReportBF').find('#prtpay').html(project.prtpay.toString().toFormat('NUMBER')); //중도금
				$('#popReportBF').find('#prtpay_de').html(project.prtpay_de); //중도금일자
				$('#popReportBF').find('#prtpay_rm').html(project.prtpay_rm); //중도금비고
				$('#popReportBF').find('#surlus').html(project.surlus.toString().toFormat('NUMBER')); //잔금
				$('#popReportBF').find('#surlus_de').html(project.surlus_de); //잔금일자
				$('#popReportBF').find('#surlus_rm').html(project.surlus_rm); //잔금비고
				$('#popReportBF').find('#setle_mth').html(project.setle_mth); //결제방법(2)
				/* ********************************************************* */


				/* 계약, 영업수수료 정산 (관리) */
				/* ********************************************************* */
				var html = '';
				var sTaxbilList = pResult.s1TaxbilList;
				var splpc_am_total = 0, vat_total = 0, sum_total = 0;
				$.each(sTaxbilList, function(pIndex, pValue) {
					html += '<tr class="colorW">';
					html += '    <td>'+pValue.pblicte_de+'</td>';
					html += '    <td class="text-number">'+pValue.splpc_am.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+pValue.vat.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+pValue.total.toString().toFormat('NUMBER')+'</td>';
					html += '    <td>'+pValue.pblicte_trget_nm+'</td>';
					html += '</tr>';
					splpc_am_total += parseInt(pValue.splpc_am);
					vat_total += parseInt(pValue.vat);
					sum_total += parseInt(pValue.total);
				});
				if (pResult.s1TaxbilList.length < pResult.i1RcppayList.length) {
					var max = pResult.i1RcppayList.length - pResult.s1TaxbilList.length
					for (i=0; i<max; i++) {
						html += '<tr class="colorW">';
						html += '    <td>-</td>';
						html += '    <td></td>';
						html += '    <td></td>';
						html += '    <td></td>';
						html += '    <td></td>';
						html += '</tr>';
					}
				}
				$('#popReportBF').find('#report_s1_taxbil tbody').html(html);
				$('#popReportBF').find('#report_s1_taxbil tfoot th:eq(1)').html(sum_total.toString().toFormat('NUMBER'));

				var html = '';
				var iRcppayList = pResult.i1RcppayList;
				var iRcppay_sub = cCostTotal, iRcppay_rate = 0.0;
				var amount_total = 0, sub_total = 0, rate_total = 0.0;
				$.each(iRcppayList, function(pIndex, pValue) {
					iRcppay_sub -= parseInt(pValue.amount);
					iRcppay_rate = ((cCostTotal-iRcppay_sub)/cCostTotal)*100;
					html += '<tr class="colorW">';
					html += '    <td>'+pValue.rcppay_de+'</td>';
					html += '    <td class="text-number">'+pValue.amount.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+iRcppay_sub.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+iRcppay_rate.toFixed(1)+'%</td>';
					html += '    <td>'+pValue.rcppay_dtls+'</td>';
					html += '</tr>';
					amount_total += parseInt(pValue.amount);
					sub_total = iRcppay_sub;
					rate_total = iRcppay_rate;
				});
				if (pResult.i1RcppayList.length < pResult.s1TaxbilList.length) {
					var max = pResult.s1TaxbilList.length - pResult.i1RcppayList.length
					for (i=0; i<max; i++) {
						html += '<tr class="colorW">';
						html += '    <td>-</td>';
						html += '    <td></td>';
						html += '    <td></td>';
						html += '    <td></td>';
						html += '    <td></td>';
						html += '</tr>';
					}
				}
				$('#popReportBF').find('#report_i1_rcppay tbody').html(html);
				$('#popReportBF').find('#report_exec tbody[role=body] tr[data-row="result"] th:eq(0)').html(amount_total.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_i1_rcppay tfoot th:eq(1)').html(amount_total.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_i1_rcppay tfoot th:eq(2)').html(sub_total.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_i1_rcppay tfoot th:eq(3)').html(rate_total.toFixed(1)+'%');
				/* ********************************************************* */

				/* 모델(샘플)하우스 장비 매입 현황 (관리) */
				/* ********************************************************* */
// 				var a_dlnt_total = 0, a_dlamt_total = 0, a_last_dlamt_total = 0;
// 				var html = '';
// 				var sAccountList = pResult.s6AccountList;
// 				var s_dlnt_sum = 0, p_dlamt_sum_total = 0, p_last_dlamt_sum_total = 0;
//                 var p_dlamt_tot = 0;
//                 var wrhousng_tot = 0;
// 				$.each(sAccountList, function(pIndex, pValue) {
//                     var wrhousng_de = [];
//                     if(pResult['modelList'].hasOwnProperty(pValue.s_model_no.trim()) && pResult['modelList'][pValue.s_model_no.trim()].hasOwnProperty(pValue.s_dlivy_de)){
//
//                         $.each(pResult['modelList'][pValue.s_model_no.trim()][pValue.s_dlivy_de], function(pI, pV){
//                             if(pV.p_bcnc_nm == pValue.p_bcnc_nm)
//                                 wrhousng_de.push([pV.ddt_man, pV.dlnt]);
//                         });
//                     }
//                     window.modellist = pResult['modelList'];
//                     console.log(pValue.s_model_no.trim());
//                     console.log(pValue.s_dlivy_de);
//
//                     console.log(wrhousng_de);
// 					var p_dlamt_sum = pValue.s_dlnt * pValue.p_dlamt;
// 					var p_last_dlamt_sum = Math.round(pValue.p_dlivy_amt * (pValue.p_add_dscnt_rt/100))*pValue.s_dlnt;
// 					if(wrhousng_de.length == 0){
//                         html += '<tr>';
//                         html += '    <td class="colorG">M,S/H</td>';
//                         html += '    <td>'+pValue.s_dlivy_de+'</td>';
//                         html += '    <td>'+pValue.s_model_no+'</td>';
//                         html += '    <td class="text-number">'+pValue.s_dlnt.toString().toFormat('NUMBER')+'</td>';
//                         html += '    <td class="text-number">'+pValue.p_dlivy_amt.toString().toFormat('NUMBER')+'</td>';
//                         html += '    <td class="text-number">'+pValue.p_dlamt.toString().toFormat('NUMBER')+'</td>';
//                         html += '    <td class="text-number">'+p_dlamt_sum.toString().toFormat('NUMBER')+'</td>';
//                         html += '    <td class="text-number">'+p_last_dlamt_sum.toString().toFormat('NUMBER')+'</td>';
//                         html += '    <td class="text-number">'+(p_dlamt_sum - p_last_dlamt_sum).toString().toFormat('NUMBER')+'</td>';
//
//                         if (pValue.p_bcnc_nm == '넥셀시스템') {
//                             html += '    <td>재고활용</td>';
//                         } else {
//                             html += '    <td>'+pValue.p_bcnc_nm+'</td>';
//                         }
//                         html += '    <td></td>';
//                         html += '    <td></td>';
//                         html += '    <td>'+pValue.s_rm+'</td>';
//                         html += '</tr>';
//                     }
//                     else{
//                         $.each(wrhousng_de, function(i,v){
//                             html += '<tr>';
//                             html += '    <td class="colorG">M,S/H</td>';
//                             if(i == 0){
//                                 html += '    <td rowspan="'+wrhousng_de.length+'">'+pValue.s_dlivy_de+'</td>';
//                                 html += '    <td rowspan="'+wrhousng_de.length+'">'+pValue.s_model_no+'</td>';
//                                 html += '    <td class="text-number" rowspan="'+wrhousng_de.length+'">'+pValue.s_dlnt.toString().toFormat('NUMBER')+'</td>';
//                                 html += '    <td class="text-number" rowspan="'+wrhousng_de.length+'">'+pValue.p_dlivy_amt.toString().toFormat('NUMBER')+'</td>';
//                                 html += '    <td class="text-number" rowspan="'+wrhousng_de.length+'">'+pValue.p_dlamt.toString().toFormat('NUMBER')+'</td>';
//                                 html += '    <td class="text-number" rowspan="'+wrhousng_de.length+'">'+p_dlamt_sum.toString().toFormat('NUMBER')+'</td>';
//                                 html += '    <td class="text-number" rowspan="'+wrhousng_de.length+'">'+p_last_dlamt_sum.toString().toFormat('NUMBER')+'</td>';
//                                 html += '    <td class="text-number" rowspan="'+wrhousng_de.length+'">'+(p_dlamt_sum - p_last_dlamt_sum).toString().toFormat('NUMBER')+'</td>';
//
//                                 if (pValue.p_bcnc_nm == '넥셀시스템') {
//                                     html += '    <td rowspan="'+wrhousng_de.length+'">재고활용</td>';
//                                 } else {
//                                     html += '    <td rowspan="'+wrhousng_de.length+'">'+pValue.p_bcnc_nm+'</td>';
//                                 }
//                             }
//                             html += '    <td>'+v[0]+'</td>';
//                             html += '    <td class="text-number">'+v[1]+'</td>';
//                             if(i==0){
// //                                html += '    <td rowspan="'+wrhousng_de.length+'">'+pValue.s_rm+'</td>';
//                                 html += '    <td rowspan="'+wrhousng_de.length+'">'+pValue.s_rm+'</td>';
//                             }
//                             html += '</tr>';
//                             wrhousng_tot += parseInt(v[1]);
//                         });
//                     }
// 					s_dlnt_sum += parseInt(pValue.s_dlnt);
// 					p_dlamt_sum_total += parseInt(p_dlamt_sum);
// 					p_last_dlamt_sum_total += parseInt(p_last_dlamt_sum);
//
// //					if (sAccountList.length == (pIndex+1)) {
// //						html += '<tr>';
// //						html += '    <td class="colorG">소개</td>';
// //						html += '    <td class="colorG"></td>';
// //						html += '    <td class="colorG text-number">'+s_dlnt_sum.toString().toFormat('NUMBER')+'</td>';
// //						html += '    <td class="colorG text-number"></td>';
// //						html += '    <td class="colorG text-number">'+p_dlamt_sum_total.toString().toFormat('NUMBER')+'</td>';
// //						html += '    <td class="colorG text-number">'+p_last_dlamt_sum_total.toString().toFormat('NUMBER')+'</td>';
// //						html += '    <td class="colorG"></td>';
// //						html += '    <td class="colorG"></td>';
// //						html += '    <td class="colorG"></td>';
// //						html += '</tr>';
// //					}
// 					// 전체합계처리
// 					a_dlnt_total += parseInt(pValue.s_dlnt);
// 					if (pValue.p_delng_ty_code == 61) {
// 						a_dlamt_total += parseInt(p_dlamt_sum);
// 						a_last_dlamt_total += parseInt(p_last_dlamt_sum);
//                         p_dlamt_tot += parseInt(pValue.p_dlamt);
// 					}
// 				});
// 				$('#popReportBF').find('#report_s6_account').html(html);
// 				$('#popReportBF').find('#report_s6_account').yRowspan(0);
//
// 				var html = '';
// 				var sAccountList = pResult.s7AccountList;
// 				var s_dlnt_sum = 0, p_dlamt_sum_total = 0, p_last_dlamt_sum_total = 0;
//
// 				$.each(sAccountList, function(pIndex, pValue) {
//                     var wrhousng_de = [];
//                     if(pResult['modelList'].hasOwnProperty(pValue.s_model_no) && pResult['modelList'][pValue.s_model_no].hasOwnProperty(pValue.s_dlivy_de)){
//                         $.each(pResult['modelList'][pValue.s_model_no][pValue.s_dlivy_de], function(pI, pV){
//                             if(pV.p_bcnc_nm == pValue.p_bcnc_nm)
//                                 wrhousng_de.push([pV.ddt_man, pV.dlnt]);
//                         });
//                     }
//
//
// 					var p_dlamt_sum = pValue.s_dlnt * pValue.p_dlamt;
// 					var p_last_dlamt_sum = Math.round(pValue.p_dlivy_amt * (pValue.p_add_dscnt_rt/100))*pValue.s_dlnt;
// 					if(wrhousng_de.length == 0){
//                         html += '<tr>';
//                         html += '    <td class="colorG">M,S/H</td>';
//                         html += '    <td>'+pValue.s_dlivy_de+'</td>';
//                         html += '    <td>'+pValue.s_model_no+'</td>';
//                         html += '    <td class="text-number">'+pValue.s_dlnt.toString().toFormat('NUMBER')+'</td>';
//                         html += '    <td class="text-number">'+pValue.p_dlivy_amt.toString().toFormat('NUMBER')+'</td>';
//                         html += '    <td class="text-number">'+pValue.p_dlamt.toString().toFormat('NUMBER')+'</td>';
//                         html += '    <td class="text-number">'+p_dlamt_sum.toString().toFormat('NUMBER')+'</td>';
//                         html += '    <td class="text-number">'+p_last_dlamt_sum.toString().toFormat('NUMBER')+'</td>';
//                         html += '    <td class="text-number">'+(p_dlamt_sum - p_last_dlamt_sum).toString().toFormat('NUMBER')+'</td>';
//
//                         if (pValue.p_bcnc_nm == '넥셀시스템') {
//                             html += '    <td>재고활용</td>';
//                         } else {
//                             html += '    <td>'+pValue.p_bcnc_nm+'</td>';
//                         }
//                         html += '    <td></td>';
//                         html += '    <td></td>';
//                         html += '    <td>'+pValue.s_rm+'</td>';
//                         html += '</tr>';
//                     }
//                     else{
//                         $.each(wrhousng_de, function(i,v){
//                             html += '<tr>';
//                             html += '    <td class="colorG">M,S/H</td>';
//                             if(i == 0){
//                                 html += '    <td rowspan="'+wrhousng_de.length+'">'+pValue.s_dlivy_de+'</td>';
//                                 html += '    <td rowspan="'+wrhousng_de.length+'">'+pValue.s_model_no+'</td>';
//                                 html += '    <td class="text-number" rowspan="'+wrhousng_de.length+'">'+pValue.s_dlnt.toString().toFormat('NUMBER')+'</td>';
//                                 html += '    <td class="text-number" rowspan="'+wrhousng_de.length+'">'+pValue.p_dlivy_amt.toString().toFormat('NUMBER')+'</td>';
//                                 html += '    <td class="text-number" rowspan="'+wrhousng_de.length+'">'+pValue.p_dlamt.toString().toFormat('NUMBER')+'</td>';
//                                 html += '    <td class="text-number" rowspan="'+wrhousng_de.length+'">'+p_dlamt_sum.toString().toFormat('NUMBER')+'</td>';
//                                 html += '    <td class="text-number" rowspan="'+wrhousng_de.length+'">'+p_last_dlamt_sum.toString().toFormat('NUMBER')+'</td>';
//                                 html += '    <td class="text-number" rowspan="'+wrhousng_de.length+'">'+(p_dlamt_sum - p_last_dlamt_sum).toString().toFormat('NUMBER')+'</td>';
//
//                                 if (pValue.p_bcnc_nm == '넥셀시스템') {
//                                     html += '    <td rowspan="'+wrhousng_de.length+'">재고활용</td>';
//                                 } else {
//                                     html += '    <td rowspan="'+wrhousng_de.length+'">'+pValue.p_bcnc_nm+'</td>';
//                                 }
//                             }
//                             html += '    <td>'+v[0]+'</td>';
//                             html += '    <td class="text-number">'+v[1]+'</td>';
//                             if(i==0){
// //                                html += '    <td rowspan="'+wrhousng_de.length+'">'+pValue.s_rm+'</td>';
//                                 html += '    <td rowspan="'+wrhousng_de.length+'">'+pValue.s_rm+'</td>';
//                             }
//                             html += '</tr>';
//                             wrhousng_tot += parseInt(v[1]);
//
//                         });
//                     }
// 					s_dlnt_sum += parseInt(pValue.s_dlnt);
// 					p_dlamt_sum_total += parseInt(p_dlamt_sum);
// 					p_last_dlamt_sum_total += parseInt(p_last_dlamt_sum);
// 					// 전체합계처리
// 					a_dlnt_total += parseInt(pValue.s_dlnt);
// 					a_dlamt_total += parseInt(p_dlamt_sum);
// 					a_last_dlamt_total += parseInt(p_last_dlamt_sum);
//                     p_dlamt_tot += parseInt(pValue.p_dlamt);
// 				});
// 				$('#popReportBF').find('#report_s7_account').html(html);
// 				$('#popReportBF').find('#report_s7_account').yRowspan(0);
// 				$('#popReportBF').find('#report_s_account tfoot th:eq(2)').html(a_dlnt_total.toString().toFormat('NUMBER'));
// //				$('#popReportBF').find('#report_s_account tfoot th:eq(4)').html(p_dlamt_tot.toString().toFormat('NUMBER'));
// 				$('#popReportBF').find('#report_s_account tfoot th:eq(5)').html(a_dlamt_total.toString().toFormat('NUMBER'));
// 				$('#popReportBF').find('#report_s_account tfoot th:eq(6)').html(a_last_dlamt_total.toString().toFormat('NUMBER'));
// 				$('#popReportBF').find('#report_s_account tfoot th:eq(7)').html((a_dlamt_total - a_last_dlamt_total).toString().toFormat('NUMBER'));
// 				$('#popReportBF').find('#report_s_account tfoot th:eq(10)').html(wrhousng_tot.toString().toFormat('NUMBER'));
// 				$('#popReportBF').find('#report_exec tbody[role=body] tr[data-row="result"] td:eq(2)').html(a_dlamt_total.toString().toFormat('NUMBER'));
// 				/* ********************************************************* */

				var model_cost_list = pResult.sModelCostList;
				var return_list = pResult.modelList;
				var html = [''];
				var total_qy = [0, 0];
				var total_amount = [0, 0];
				var total_dc = [0, 0];
				var total_ramount = [0, 0];
				var total_return = [0, 0];
				var total_diff = [0, 0];
				$.each(model_cost_list, function(pIndex, pValue){
					var return_de = '';
					var return_dlnt = 0;
					var return_place = '';
					if(return_list.hasOwnProperty(pValue.delng_sn)){
						return_de = return_list[pValue.delng_sn].return_de;
						return_place = return_list[pValue.delng_sn].return_place;
						return_dlnt = return_list[pValue.delng_sn].count;
					}
					var dlamt = parseInt(pValue.dlamt); if(isNaN(dlamt)) dlamt = 0;
					var dlnt = parseInt(pValue.dlnt); if(isNaN(dlnt)) dlnt = 0;
					var amount = dlamt*dlnt;
					var diff = dlnt - return_dlnt;

					var _type = ["61", "62"].includes(pValue.delng_ty_code) ? 0 : 1;
					total_qy[_type] += dlnt;
					total_return[_type] += return_dlnt;
					total_diff[_type] += diff;

					if(pValue.dlivy_de != ''){
						var dlivy_year = pValue.dlivy_de.split("-")[0];
						var dlivy_month = pValue.dlivy_de.split("-")[1];
						var dlivy = new Date(dlivy_year, parseInt(dlivy_month)-1+((_type == 1) ? 6 : 12), 15);
						var expect_de = (new Date(dlivy.getTime() - (new Date()).getTimezoneOffset())).toISOString().split("T")[0];
						var expect = expect_de.split("-")[0]+"-"+expect_de.split("-")[1];
						total_amount[_type] += amount;
						total_dc[_type] += Math.round(pValue.dlivy_amt*dlnt * pValue.add_dscnt_rt / 100.0);
						total_ramount[_type] += (amount - Math.round(pValue.dlivy_amt*dlnt * pValue.add_dscnt_rt / 100.0));
					}
					else{
						var expect = "";
					}

					html[_type] += `<tr>
								<td class="text-center">${(_type == 0)? "M/H" : "S/H"}</td>
								<td class="text-center">${pValue.dlivy_de}</td>
								<td class="text-center">${pValue.model_no}</td>
								<td class="text-center">${dlnt.toFormat('NUMBER')}</td>
								<td class="text-right">${pValue.dlivy_amt.toFormat('NUMBER')}</td>
								<td class="text-right">${dlamt.toFormat('NUMBER')}</td>
								<td class="text-right">${amount.toFormat('NUMBER')}</td>
								<td class="text-right">${Math.round(pValue.dlivy_amt*dlnt * pValue.add_dscnt_rt / 100.0).toFormat('NUMBER')}</td>
								<td class="text-right">${(amount - Math.round(pValue.dlivy_amt*dlnt * pValue.add_dscnt_rt / 100.0)).toFormat('NUMBER')}</td>
								<td class="text-center">${pValue.bcnc_nm}</td>
								<td class="text-center">${expect}</td>
								<td class="text-center">${return_de}</td>
								<td class="text-center">${return_dlnt.toFormat('NUMBER')}</td>
								<td class="text-center">${diff.toFormat('NUMBER')}</td>
								<td class="text-center">${return_place}</td>
							</tr>`
				});
				var html_tot1 = `<tr>
									<td class="colorG text-center">M/H 계</td>
									<td class="colorG"></td>
									<td class="colorG"></td>
									<td class="colorG text-center">${total_qy[0].toFormat('NUMBER')}</td>
									<td class="colorG"></td>
									<td class="colorG"></td>
									<td class="colorG text-right">${total_amount[0].toFormat('NUMBER')}</td>
									<td class="colorG text-right">${total_dc[0].toFormat('NUMBER')}</td>
									<td class="colorG text-right">${total_ramount[0].toFormat('NUMBER')}</td>
									<td class="colorG"></td>
									<td class="colorG"></td>
									<td class="colorG"></td>
									<td class="colorG text-center">${total_return[0].toFormat('NUMBER')}</td>
									<td class="colorG text-center">${total_diff[0].toFormat('NUMBER')}</td>
									<td class="colorG"></td>
								</tr>`;
				var html_tot2 = `<tr>
									<td class="colorG text-center">S/H 계</td>
									<td class="colorG"></td>
									<td class="colorG"></td>
									<td class="colorG text-center">${total_qy[1].toFormat('NUMBER')}</td>
									<td class="colorG"></td>
									<td class="colorG"></td>
									<td class="colorG text-right">${total_amount[1].toFormat('NUMBER')}</td>
									<td class="colorG text-right">${total_dc[1].toFormat('NUMBER')}</td>
									<td class="colorG text-right">${total_ramount[1].toFormat('NUMBER')}</td>
									<td class="colorG"></td>
									<td class="colorG"></td>
									<td class="colorG"></td>
									<td class="colorG text-center">${total_return[1].toFormat('NUMBER')}</td>
									<td class="colorG text-center">${total_diff[1].toFormat('NUMBER')}</td>
									<td class="colorG"></td>
								</tr>`;
				$('#popReportBF').find('#rptTable14 tbody[role=m_house_row]').html(html[0]);
				$('#popReportBF').find('#rptTable14 tbody[role=m_house_foot]').html(html_tot1);
				$('#popReportBF').find('#rptTable14 tbody[role=s_house_row]').html(html[1]);
				$('#popReportBF').find('#rptTable14 tbody[role=s_house_foot]').html(html_tot2);
				var a_last_dlamt_total = total_dc;

				$('#popReportBF').find('#rptTable14 tfoot').find("[data-column='total_qy']").html((total_qy[0] + total_qy[1]).toFormat('NUMBER'));
				$('#popReportBF').find('#rptTable14 tfoot').find("[data-column='total_amount']").html((total_amount[0] + total_amount[1]).toFormat('NUMBER'));
				$('#popReportBF').find('#rptTable14 tfoot').find("[data-column='total_dc']").html((total_dc[0] + total_dc[1]).toFormat('NUMBER'));
				$('#popReportBF').find('#rptTable14 tfoot').find("[data-column='total_ramount']").html((total_ramount[0] + total_ramount[1]).toFormat('NUMBER'));
				$('#popReportBF').find('#rptTable14 tfoot').find("[data-column='total_return']").html((total_return[0] + total_return[1]).toFormat('NUMBER'));
				$('#popReportBF').find('#rptTable14 tfoot').find("[data-column='total_diff']").html((total_diff[0] + total_diff[1]).toFormat('NUMBER'));
				$('#popReportBF').find('#report_exec tbody[role=body] tr[data-row="result"] td:eq(2)').html((total_amount[0]+total_amount[1]).toFormat('NUMBER'));

				// $('#popReportBF').find('#rptTable14 tfoot').find("[data-column='total_diff']").html(total_diff.toFormat('NUMBER'));


				/* 모델(샘플)하우스 추가 DC 현황 (관리) */
				/* ********************************************************* */
				var html = '';
				var dc_total = 0;
				var sTaxbilList = pResult.s2TaxbilList.M;
				var splpc_am_total = 0, vat_total = 0, sum_total = 0;
				$.each(sTaxbilList, function(pIndex, pValue) {
					html += '<tr class="colorW">';
					html += '    <td>M/H</td>';
					html += '    <td>'+pValue.pblicte_de+'</td>';
					html += '    <td class="text-number">'+pValue.splpc_am.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+pValue.vat.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+pValue.total.toString().toFormat('NUMBER')+'</td>';
					html += '    <td>'+pValue.pblicte_trget_nm+'</td>';
					html += '</tr>';
					splpc_am_total += parseInt(pValue.splpc_am);
					vat_total += parseInt(pValue.vat);
					sum_total += parseInt(pValue.total);
				});
				if (pResult.s2TaxbilList.M.length < pResult.i2RcppayList.M.length) {
					var max = pResult.i2RcppayList.M.length - pResult.s2TaxbilList.M.length
					for (let i=0; i<max; i++) {
						html += '<tr class="colorW">';
						html += '    <td>-</td>';
						html += '    <td></td>';
						html += '    <td></td>';
						html += '    <td></td>';
						html += '    <td></td>';
						html += '</tr>';
					}
				}
				$('#popReportBF').find('#report_s2_taxbil tbody[role="m_tax"]').html(html);
				$('#popReportBF').find('#report_s2_taxbil tbody[role="m_tax_foot"] th:eq(2)').html(splpc_am_total.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_s2_taxbil tbody[role="m_tax_foot"] th:eq(3)').html(vat_total.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_s2_taxbil tbody[role="m_tax_foot"] th:eq(4)').html(sum_total.toString().toFormat('NUMBER'));

				var html = '';
				var iRcppayList = pResult.i2RcppayList.M;
				var iRcppay_sub = a_last_dlamt_total[0], iRcppay_rate = 0.0;
				var amount_total = 0, sub_total = 0, rate_total = 0.0;
				$.each(iRcppayList, function(pIndex, pValue) {
					iRcppay_sub -= parseInt(pValue.amount);
					iRcppay_rate = ((a_last_dlamt_total[0]-iRcppay_sub)/a_last_dlamt_total[0])*100;
					html += '<tr class="colorW">';
					html += '    <td>'+pValue.rcppay_de+'</td>';
					html += '    <td class="text-number">'+pValue.amount.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+iRcppay_sub.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+iRcppay_rate.toFixed(1)+'%</td>';
					html += '    <td>'+pValue.rcppay_dtls+'</td>';
					html += '</tr>';
					amount_total += parseInt(pValue.amount);
					sub_total = iRcppay_sub;
					rate_total = iRcppay_rate;
				});
				if (pResult.i2RcppayList.M.length < pResult.s2TaxbilList.M.length) {
					var max = pResult.s2TaxbilList.M.length - pResult.i2RcppayList.M.length
					for (let i=0; i<max; i++) {
						html += '<tr class="colorW">';
						html += '    <td>-</td>';
						html += '    <td></td>';
						html += '    <td></td>';
						html += '    <td></td>';
						html += '    <td></td>';
						html += '</tr>';
					}
				}
				dc_total += amount_total;
				$('#popReportBF').find('#report_i2_rcppay tbody[role="m_rcppay"]').html(html);
				$('#popReportBF').find('#report_i2_rcppay tbody[role="m_rcppay_foot"] th:eq(1)').html(amount_total.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_i2_rcppay tbody[role="m_rcppay_foot"] th:eq(2)').html(sub_total.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_i2_rcppay tbody[role="m_rcppay_foot"] th:eq(3)').html(rate_total.toFixed(1)+'%');

				var html = '';
				var sTaxbilList = pResult.s2TaxbilList.S;
				var splpc_am_total = 0, vat_total = 0, sum_total = 0;
				$.each(sTaxbilList, function(pIndex, pValue) {
					html += '<tr class="colorW">';
					html += '    <td>S/H</td>';
					html += '    <td>'+pValue.pblicte_de+'</td>';
					html += '    <td class="text-number">'+pValue.splpc_am.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+pValue.vat.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+pValue.total.toString().toFormat('NUMBER')+'</td>';
					html += '    <td>'+pValue.pblicte_trget_nm+'</td>';
					html += '</tr>';
					splpc_am_total += parseInt(pValue.splpc_am);
					vat_total += parseInt(pValue.vat);
					sum_total += parseInt(pValue.total);
				});
				if (pResult.s2TaxbilList.S.length < pResult.i2RcppayList.S.length) {
					var max = pResult.i2RcppayList.S.length - pResult.s2TaxbilList.S.length
					for (let i=0; i<max; i++) {
						html += '<tr class="colorW">';
						html += '    <td>-</td>';
						html += '    <td></td>';
						html += '    <td></td>';
						html += '    <td></td>';
						html += '    <td></td>';
						html += '</tr>';
					}
				}
				$('#popReportBF').find('#report_s2_taxbil tbody[role="s_tax"]').html(html);
				$('#popReportBF').find('#report_s2_taxbil tbody[role="s_tax_foot"] th:eq(2)').html(splpc_am_total.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_s2_taxbil tbody[role="s_tax_foot"] th:eq(3)').html(vat_total.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_s2_taxbil tbody[role="s_tax_foot"] th:eq(4)').html(sum_total.toString().toFormat('NUMBER'));

				var html = '';
				var iRcppayList = pResult.i2RcppayList.S;
				var iRcppay_sub = a_last_dlamt_total[1], iRcppay_rate = 0.0;
				var amount_total = 0, sub_total = iRcppay_sub, rate_total = 0.0;
				$.each(iRcppayList, function(pIndex, pValue) {
					iRcppay_sub -= parseInt(pValue.amount);
					iRcppay_rate = ((a_last_dlamt_total[1]-iRcppay_sub)/a_last_dlamt_total[1])*100;
					html += '<tr class="colorW">';
					html += '    <td>'+pValue.rcppay_de+'</td>';
					html += '    <td class="text-number">'+pValue.amount.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+iRcppay_sub.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+iRcppay_rate.toFixed(1)+'%</td>';
					html += '    <td>'+pValue.rcppay_dtls+'</td>';
					html += '</tr>';
					amount_total += parseInt(pValue.amount);
					sub_total = iRcppay_sub;
					rate_total = iRcppay_rate;
				});
				if (pResult.i2RcppayList.S.length < pResult.s2TaxbilList.S.length) {
					var max = pResult.s2TaxbilList.S.length - pResult.i2RcppayList.S.length
					for (let i=0; i<max; i++) {
						html += '<tr class="colorW">';
						html += '    <td>-</td>';
						html += '    <td></td>';
						html += '    <td></td>';
						html += '    <td></td>';
						html += '    <td></td>';
						html += '</tr>';
					}
				}
				dc_total += amount_total;
				$('#popReportBF').find('#report_i2_rcppay tbody[role="s_rcppay"]').html(html);
				$('#popReportBF').find('#report_i2_rcppay tbody[role="s_rcppay_foot"] th:eq(1)').html(amount_total.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_i2_rcppay tbody[role="s_rcppay_foot"] th:eq(2)').html(sub_total.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_i2_rcppay tbody[role="s_rcppay_foot"] th:eq(3)').html(rate_total.toFixed(1)+'%');

				// $('#popReportBF').find('#report_exec tbody[role=body] tr[data-row="result"] td:eq(3)').html(amount_total.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_exec tbody[role=body] tr[data-row="result"] td:eq(3)').html(dc_total.toFormat('NUMBER'));

				/* ********************************************************* */
				/* M/SH, 옵션 */
				var html = '';
				var dspyOptionList = pResult.sOptionCostList;
				console.log(dspyOptionList);
				if(dspyOptionList != null){
					$.each(dspyOptionList, function(pKey, pValue){
						var target = $(document).find(`#rptTableOpt tbody[role=body] [data-column='${pKey}']`);
						if($(target).data("type") != 'number'){
							$(target).html(pValue);
						}
						else{
							$(target).html(pValue.toFormat('NUMBER'));
						}
					});
					var c_opt_amount = parseInt(dspyOptionList.c_opt_amount); if(isNaN(c_opt_amount)) c_opt_amount = 0;
					var e_opt_amount = parseInt(dspyOptionList.e_opt_amount); if(isNaN(e_opt_amount)) e_opt_amount = 0;

					var diff = e_opt_amount - c_opt_amount;
					$(document).find(`#rptTableOpt tfoot [data-column='diff']`).html(diff.toFormat('NUMBER'));
				}
				/* 모델(샘플)하우스 판매현황 (관리) */
				/* ********************************************************* */
				var html = '';
				var s_total_dlnt = 0, s_total_amount = 0;
				$.each(pResult.s63List, function(pIndex, pValue){
						html += '<tr class="colorW">';
						html += '	<td class="text-center">'+pValue.dlivy_de+'</td>';
						html += '	<td class="text-center">'+pValue.model_no+'</td>';
						html += '	<td class="text-center">'+pValue.dlnt.toFormat('NUMBER')+'</td>';
						html += '	<td class="text-right">'+pValue.dlamt.toFormat('NUMBER')+'</td>';
						html += '	<td class="text-right">'+(pValue.dlnt*pValue.dlamt).toFormat('NUMBER')+'</td>';
						html += '</tr>';
						s_total_dlnt += pValue.dlnt;
						s_total_amount += (pValue.dlnt*pValue.dlamt);
				});

				if(pResult.si3ListLength > pResult.s63ListLength){
					for(let i=0;i<pResult.si3ListLength-pResult.s63ListLength;i++){
						html += '<tr class="colorW">';
						html += '	<td>&nbsp;</td>';
						html += '	<td>&nbsp;</td>';
						html += '	<td>&nbsp;</td>';
						html += '	<td>&nbsp;</td>';
						html += '	<td>&nbsp;</td>';
						html += '</tr>';
					}
				}
				$('#popReportBF').find('#report_s3_taxbil tbody').html(html);
				$('#popReportBF').find('#report_s3_taxbil tfoot th:eq(2)').html(s_total_dlnt.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_s3_taxbil tfoot th:eq(4)').html(s_total_amount.toString().toFormat('NUMBER'));
				// $('#popReportBF').find('#report_s3_taxbil tfoot th:eq(1)').html(splpc_am_total.toString().toFormat('NUMBER'));

				var html = '';
				var sTaxbilList = pResult.s3TaxbilList;
				var splpc_am_total = 0, vat_total = 0, sum_total = 0;
				$.each(sTaxbilList, function(pIndex, pValue) {
					splpc_am_total += parseInt(pValue.splpc_am);
					vat_total += parseInt(pValue.vat);
					sum_total += parseInt(pValue.total);

				});
				var iRcppay_sub = sum_total, iRcppay_rate = 0.0;
				var amount_total = 0, sub_total = 0, rate_total = 0.0;

				$.each(pResult.si3List, function(pIndex, pValue) {
					if(!pValue.hasOwnProperty('rcppay')){
						html += '<tr class="colorW">';
						html += '    <td>'+pValue.pblicte_trget_nm+'</td>';
						html += '    <td>'+pValue.pblicte_de+'</td>';
						html += '    <td class="text-number">'+pValue.total.toString().toFormat('NUMBER')+'</td>';
						html += '    <td></td>';
						html += '    <td></td>';
						html += '    <td class="text-number">'+pValue.total.toString().toFormat('NUMBER')+'</td>';
						html += '    <td>0%</td>';
						html += '</tr>';
					}
					else{
						var rcppayList = pValue.rcppay;
						html += '<tr class="colorW">';
						html += '    <td class="middle" rowspan="'+rcppayList.length+'">'+pValue.pblicte_trget_nm+'</td>';
						html += '    <td class="middle" rowspan="'+rcppayList.length+'">'+pValue.pblicte_de+'</td>';
						html += '    <td class="text-number middle" rowspan="'+rcppayList.length+'">'+pValue.total.toString().toFormat('NUMBER')+'</td>';
						$.each(rcppayList, function(pI, pR){
							iRcppay_sub -= parseInt(pR.amount);
							iRcppay_rate = ((sum_total-iRcppay_sub)/sum_total)*100;
							if(pI != 0){
								html += '<tr class="colorW">';

							}
								html += '    <td>'+pR.rcppay_de+'</td>';
								html += '    <td class="text-number">'+pR.amount.toFormat('NUMBER')+'</td>';
								html += '    <td class="text-number">'+iRcppay_sub.toString().toFormat('NUMBER')+'</td>';
								html += '    <td class="text-number">'+iRcppay_rate.toFixed(1)+'%</td>';

							html += '</tr>';
							amount_total += parseInt(pR.amount);
							sub_total = iRcppay_sub;
							rate_total = iRcppay_rate;

						});

					}
				});
				if(pResult.si3ListLength < pResult.s63ListLength){
					for(let i=0;i<pResult.s63ListLength-pResult.si3ListLength;i++){
						html += '<tr class="colorW">';
						html += '	<td>&nbsp;</td>';
						html += '	<td>&nbsp;</td>';
						html += '	<td>&nbsp;</td>';
						html += '	<td>&nbsp;</td>';
						html += '	<td>&nbsp;</td>';
						html += '	<td>&nbsp;</td>';
						html += '	<td>&nbsp;</td>';
						html += '</tr>';
					}
				}

				$('#popReportBF').find('#report_i3_rcppay tbody').html(html);
				$('#popReportBF').find('#report_i3_rcppay tfoot th:eq(4)').html(amount_total.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_i3_rcppay tfoot th:eq(5)').html(sub_total.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_i3_rcppay tfoot th:eq(6)').html(rate_total.toFixed(1)+'%');
				$('#popReportBF').find('#report_i3_rcppay tfoot th:eq(2)').html(sum_total.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_exec tbody[role=body] tr[data-row="result"] td:eq(4)').html(amount_total.toString().toFormat('NUMBER'));
				/* ********************************************************* */

				/* 기타 */
				/* ********************************************************* */
				var html = '';
				var etcRcppayList = pResult.etcRcppayList;
				var amt_total = 0;
				var c_opt_amount = 0;
				var c_opt_date = [];
				$.each(etcRcppayList, function(pIndex, pValue) {
					var amt = parseInt(pValue.amount);
					if(parseInt(pValue.acntctgr_code) != 504) {
						html += '<tr>';
						html += '    <td>' + pValue.rcppay_de + '</td>';
						html += '    <td>' + pValue.acntctgr_nm + '</td>';
						html += '    <td class="text-left">' + pValue.rcppay_dtls + '</td>';
						html += '    <td>' + pValue.papr_invstmnt_nm + '</td>';
						html += '    <td class="text-number">' + amt.toString().toFormat('NUMBER') + '</td>';
						html += '    <td></td>';
						html += '</tr>';
						amt_total += parseInt(amt);
					}
					else{
						c_opt_amount += parseInt(amt);
						c_opt_date.push(pValue.rcppay_de);
					}
				});
				$('#popReportBF').find('#report_exec tbody[role=body] tr[data-row="result"] td:eq(5)').html(c_opt_amount.toFormat('NUMBER'));
				$('#popReportBF').find(`[data-column='c_opt_amount']`).html(c_opt_amount.toFormat('NUMBER'));
				$('#popReportBF').find(`[data-column='c_opt_pay_dtm']`).html(c_opt_date.join(","));

//                var etcCardList = pResult.etcCardList;
//                $.each(etcCardList, function(pIndex, pValue) {
//					var amt = parseInt(pValue.amount);
//					html += '<tr>';
//					html += '    <td class="">'+pValue.card_de+'</td>';
//					html += '    <td class="">'+pValue.acntctgr_nm+'</td>';
//					html += '    <td class="text-left">'+pValue.card_dtls+'</td>';
//					html += '    <td class="">'+pValue.papr_invstmnt_nm+'</td>';
//					html += '    <td class=" text-number">'+amt.toString().toFormat('NUMBER')+'</td>';
//					html += '</tr>';
//					amt_total += parseInt(amt);
//				});
				$('#popReportBF').find('#report_e_etc tbody[role=body]').html(html);
				$('#popReportBF').find('#report_e_etc tfoot th:eq(1)').html(amt_total.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_exec tbody[role=body] tr[data-row="result"] td:eq(6)').html(amt_total.toString().toFormat('NUMBER'));
				/* ********************************************************* */

				/* M/SH, 옵션 */
				/* ********************************************************* */
				var html = '';
				var dspyCostList = pResult.dspyCostList;
				var all_sum_total = 0;
				$.each(dspyCostList, function(pIndex, pValue) {
					var dspy_ct_se_nm = pValue.ct_se_code == '10' ? '예상' : '정산';
                    var color = pValue.ct_se_code == '10' ? '  colorY' : ' colorG';
					var lttot_rt = (parseInt(pValue.lttot_hshld_co)/parseInt(pValue.hshld_co))*100;
					var optn_rt = (parseInt(pValue.optn_hshld_co)/parseInt(pValue.hshld_co))*100;
                    var fee = (parseFloat(pValue.dsct_rt) * parseInt(pValue.prsmp_cntrct_amount) / 100);
					all_sum_total = parseInt(pValue.erc_ct)+parseInt(pValue.optn_event_ct);
					html += '<tr>';
					html += '    <td class="text-center '+color+'">'+dspy_ct_se_nm+'</td>';
					html += '    <td class="text-number">'+pValue.model_no_new.toString()+'</td>';
					html += '    <td class="text-number">'+pValue.hshld_co.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+pValue.lttot_hshld_co.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-center">'+lttot_rt.toFixed(0)+'%'+'</td>';
					html += '    <td class="text-number">'+pValue.optn_hshld_co.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-center">'+optn_rt.toFixed(0)+'%'+'</td>';
					html += '    <td class="text-number">'+pValue.prsmp_cntrct_amount.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+fee.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-center">'+pValue.erc_ct.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+pValue.optn_event_ct.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+all_sum_total.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+(fee-all_sum_total).toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+((fee-all_sum_total)/parseInt(pValue.prsmp_cntrct_amount) * 100).toFixed(1)+'%'+'</td>';
					html += '</tr>';
				});
				$('#popReportBF').find('#rptTable13 tbody').html(html);
				$('#popReportBF').find('#rptTable13 tbody').yRowspan(0);


				/* ********************************************************* */

				/* 결산내역 (관리) */
				/* ********************************************************* */
				var totData = $('#popReportBF').find('#report_exec tbody[role=body] tr[data-row="result"] th');
				var totData1 = $(totData[1]).html().replaceAll(',', '');
				if (totData1 != '') {
					totData1 = parseInt(totData1);
				} else {
					totData1 = 0;
				}
				var execData = $('#popReportBF').find('#report_exec tbody[role=body] tr[data-row="result"] td');
				var execAmt0 = $(execData[0]).html().replaceAll(',', '');
				if (execAmt0 != '') {
					execAmt0 = parseInt(execAmt0);
				} else {
					execAmt0 = 0;
				}
				var execAmt2 = $(execData[2]).html().replaceAll(',', '');
				if (execAmt2 != '') {
					execAmt2 = parseInt(execAmt2);
				} else {
					execAmt2 = 0;
				}
				var execAmt3 = $(execData[3]).html().replaceAll(',', '');
				if (execAmt3 != '') {
					execAmt3 = parseInt(execAmt3);
				} else {
					execAmt3 = 0;
				}
				var execAmt4 = $(execData[4]).html().replaceAll(',', '');
				if (execAmt4 != '') {
					execAmt4 = parseInt(execAmt4);
				} else {
					execAmt4 = 0;
				}
				var execAmt5 = $(execData[5]).html().replaceAll(',', '');
				if (execAmt5 != '') {
					execAmt5 = parseInt(execAmt5);
				} else {
					execAmt5 = 0;
				}
				var execAmt6 = $(execData[6]).html().replaceAll(',', '');
				if (execAmt6 != '') {
					execAmt6 = parseInt(execAmt6);
				} else {
					execAmt6 = 0;
				}
				var vaTotal = (totData1 + execAmt3 + execAmt4)-(execAmt2 + execAmt5 + execAmt6);
				var vaRate = (vaTotal/totData1)*100;
				$('#popReportBF').find('#report_exec tbody[role=body] tr[data-row="result"] td:eq(7)').html(vaTotal.toString().toFormat('NUMBER'));
				$('#popReportBF').find('#report_exec tbody[role=body] tr[data-row="result"] td:eq(8)').html(vaRate == Infinity ? '-' : (vaRate.toFixed(1)+'%'));
				/* ********************************************************* */

				/* 특이사항 */
				/* ********************************************************* */
				// $('#popReportBF').find('#partclr_matter').html(project.partclr_matter.trim().replaceAll("\n", "<br>")); //특이사항
				var partclrs = project.partclr_matter.trim().split("\n");
				var re_partclrs = "";
				for(let i=0;i<partclrs.length;i++){
					if(isValidDate(partclrs[i].split(" ")[0])){
						re_partclrs += "<span style='color:blue!important;'>" + partclrs[i] + "</span><br>";
					}
					else{
						re_partclrs += partclrs[i] + "<br>";
					}
				}
				$('#popReportBF').find('#partclr_matter').html(re_partclrs);

				/* ********************************************************* */
                var cells = $('#popReportBF').find('td, th');
                $.each(cells, function(pIndex, pValue){
                    let value = $(pValue).clone().children().remove().end().text();
                    if(value == 'NaN%' || value == '-NaN%'){
                        $(pValue).html('');
                    }
                });

			}
		}
	});

    });
    function isValidDate(dateString) {
      var regEx = /^\d{4}-\d{2}-\d{2}$/;
      if(!dateString.match(regEx)) return false;  // Invalid format
      var d = new Date(dateString);

      var dNum = d.getTime();
      if(!dNum && dNum !== 0) return false; // NaN value, Invalid date
      return (new Date(d.getTime()-(new Date()).getTimezoneOffset())).toISOString().slice(0,10) === dateString;
    }

	$(function() {
    /**************************************************************************
     * 인쇄 버튼 클릭 처리
     */
	$('#btnPrint3').on('click', function(pEvent) {
		var html = $('#popReportBF').find('.modal-body').html();
		$('#_print').contents().find('body>div.report').html('');
		$('#_print').contents().find('body>div.report').html(html);
		parent.frames['_print'].focus();
    	parent.frames['_print'].print();
	});
});

</script>
{% endblock %}