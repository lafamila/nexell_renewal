{% extends 'common/report_base.html' %}
{% block content %}
<link rel="stylesheet" type="text/css" href="/static/nexell/css/smartadmin-nexell-report.css">

<!--########################################################################-->
<!--# page layer start                                                     #-->
<!--########################################################################-->
<!-- 레포트1 레이어 팝업 시작 -->
<div id="popReportNR">
    <div>
        <div class="modal-content">
			<div class="modal-header">
				<div class="pull-right" style="margin-right:10px;">
<!--					<button type="button" class="btn btn-success" id="renewal"><i class="fa fa-smile-o" aria-hidden="true"></i></button>-->
					<button type="button" class="btn" id="renewal"><i class="fa fa-frown-o" aria-hidden="true"></i></button>
					<button type="button" class="btn btn-primary" id="btnPrint1"><i class="fa fa-print">&nbsp;출력</i></button>
					<button type="button" class="btn btn-default" id="btnClose" aria-hidden="true" data-dismiss="modal"><i class="fa fa-times">&nbsp;취소</i></button>
				</div>
			</div>
			<div class="modal-body report" id="exportExcelNR">

<style>
#report_patrol tr[data-row='E'] th, #report_patrol tr[data-row='E'] td{
	border-bottom:2px solid #555!important;
}
#report_patrol tr[data-row='C'] th[rowspan="2"], #report_patrol tr[data-row='C'] td[rowspan="2"]{
	border-bottom:2px solid #555!important;
}
div.report .sub-title {
    padding-top: 4px!important;
}
div.report table {
	border-bottom: 0px solid #000!important;
}
div.report table:last-child {
	border-bottom: 3px solid #000!important;
}
body.smart-style-6 .form-control{
	border: 0px solid #ccc!important;
}
div.report table th, div.report table td {
	border: 1px solid #999 !important;
}
div.report table thead,
div.report table tbody,
div.report table tbody[role=header],
div.report table tbody[role=body],
div.report table tbody[role=footer],
div.report table tfoot {
	border: 2px solid #000!important;
	border-left: 1px solid #000!important;
	border-right: 1px solid #000!important;
	border-bottom: 0px solid #000!important;
	border-top: 0px solid #000!important;
}
div.report table tbody tr:first-child th, div.report table tbody tr:first-child td, div.report table thead tr:first-child th, div.report table thead tr:first-child td{
	border-top:0px solid #555!important;
}
div.report table:not(:last-child){
	border-bottom: 0px solid #000!important;
}
div.report table:not(:first-child){
	/* BETWEEN TABLE, 2px */
	border-top: 0px solid #000!important;
}
div.report table tbody:first-child{
	border-top:0px solid #000!important;
}
div.report table th, div.report table td {
    padding: 5px!important;
}
div.report table table tr td:last-child, div.report table table tr th:last-child{
	border-right:0px solid #555!important;
}
div.report table table tr td:first-child, div.report table table tr th:first-child{
	border-left:0px solid #555!important;
}
div.report table table thead, div.report table table tbody, div.report table table tbody[role=body], div.report table table tfoot{
	border-right:0px solid #000!important;
	border-left:0px solid #000!important;
}
</style>
<style>
#popReportNR{
    font-size: 12px !important;
    line-height: 1.0 !important;
}
</style>
<style>
    span[name=alte]{
        font-size:15px!important;
        font-weight:bold!important;
    }
    span[name=blank]{
        display:inline;
    }
@media (min-width: 100px) and (max-width: 1024px) {

    span[name=alte]{
        font-size:9px!important;
        font-weight:bold!important;
    }
    span[name=blank]{
        display:none;
    }
}
</style>

                <div class="title"><span name="alte" style="vertical-align:bottom;">※사전입찰 확정 후 7일이내 프로젝트 작성<span name="blank" style="font-size:15px!important;font-weight:bold!important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span>&nbsp;<h2 class="colorLS">프로젝트 보고서 (공조)</h2>&nbsp;<span name="alte" style="vertical-align:bottom;"><span name="blank" style="font-size:15px!important;font-weight:bold!important;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>※공사완료 후 7일이내 마감/유보 결재</span></div>



<table id="report_contract">
	<colgroup>
        <col width="175">
        <col width="150">
        <col width="175">
        <col width="150">
        <col width="175">
        <col width="150">
        <col width="175">
        <col width="150">
	</colgroup>
	<thead style="border-top:3px solid #000!important;">
		<tr>
			<th class="sub-title colorN text-center" colspan="8">기본정보 - VAT포함</th>
		</tr>

	</thead>
	<tbody>
        <tr>
			<th class="color-contract">프로젝트 번호</th>
			<td id="manage_no" colspan="3"></td>
			<th class="color-contract">작성일(자동)</th>
			<td id="regist_dtm"></td>
			<th class="color-contract">계약일</th>
			<td id="cntrct_de"></td>
		</tr>
        <tr>
			<th class="color-contract">거래처명</th>
			<td id="bcnc_nm" colspan="3"></td>
			<th class="color-contract">공사기간</th>
			<td id="cntrwk_period" colspan="3"></td>
		</tr>
        <tr>
			<th class="color-contract">현장명</th>
			<td id="spt_nm" colspan="3"></td>
			<th class="color-contract">현장주소</th>
			<td id="spt_adres" colspan="3"></td>
		</tr>
		<tr>
			<th class="color-contract">세대수</th>
			<td id="home_count"></td>
			<th class="color-contract">지역</th>
			<td id="home_region"></td>
			<th class="color-contract">넥셀현장담당</th>
			<td id="spt_chrg_nm" colspan="3"></td>
		</tr>
        <tr>
            <th class="color-contract">프로젝트 유형</th>
            <th class="hasinput" colspan="3" style="padding:0px!important;">
                <div class="btn-group btn-group-justified" data-toggle="buttons">
                    {% for code in prjct_ty_code_list %}
                    <label class="btn btn-default">
                        <input type="radio" name="prjct_ty_code" value="{{code.value}}">{{code.label}}
                    </label>
                    {% endfor %}
                </div>
            </th>
			<th class="color-contract">넥셀영업담당</th>
			<td id="bsn_chrg_nm" colspan="3"></td>
		</tr>
		<tr>
            <th class="color-contract">프로젝트 생성여부</th>
            <th class="hasinput" colspan="3" style="padding:0px!important;">
                <div class="btn-group btn-group-justified" data-toggle="buttons">
                    <label class="btn btn-default">
                        <input type="radio" name="prjct_creat_at" value="Y">생성
                    </label>
                    <label class="btn btn-default">
                        <input type="radio" name="prjct_creat_at" value="N">단납건
                    </label>
                </div>
            </th>
            <th class="color-contract">진행상태</th>
            <th class="hasinput" colspan="3" style="padding:0px!important;">
                <div class="btn-group btn-group-justified" data-toggle="buttons">
                    {% for code in progrs_sttus_code_list %}
                    <label class="btn btn-default">
                        <input type="radio" name="progrs_sttus_code" value="{{code.value}}">{{code.label}}
                    </label>
                    {% endfor %}
                </div>
            </th>
		</tr>
	</tbody>
	<tfoot>
	</tfoot>
</table>
<table id="report_project" style="border-top:0px solid #000!important;">
	<colgroup>
        <col width="175">
        <col width="150">
        <col width="175">
        <col width="150">
        <col width="175">
        <col width="150">
        <col width="175">
        <col width="150">
	</colgroup>
	<tbody>
		<tr>
			<th class="colorSky" rowspan="2">본사담당</th>
			<th class="colorSky">담당자명</th>
			<th class="colorSky" colspan="2">휴대폰</th>
			<th class="colorSky" rowspan="2">거래처담당</th>
			<th class="colorSky">담당자명</th>
			<th class="colorSky" colspan="2">휴대폰</th>
		</tr>
		<tr>
			<td id="charger_nm1">-</td>
			<td id="charger_moblphon1" colspan="2"></td>
			<td id="charger_nm2">-</td>
			<td id="charger_moblphon2" colspan="2"></td>
		</tr>
<!--
		<tr>
			<th class="colorSky">장비내역</th>
			<td colspan="9" id="eqpmn_dtls"></td>
		</tr>
-->
		<tr>
			<th class="colorSky">장비/공사내역</th>
			<td colspan="3" id="cntrwk_dtls"></td>
			<th class="colorSky">계약DC(%)</th>
            <td id="cntrct_dscnt_rt" colspan=""></td>
			<th class="colorSky">품의DC(%)</th>
            <td id="cnsul_dscnt_rt" colspan="1"></td>
		</tr>
        <tr>
            <th class="colorSky">도면작업자</th>
			<td id="drw_opertor_nm" colspan="3"></td>
			<th class="colorSky">실적신고</th>
            <td id="acmslt_sttemnt_at" colspan="1"></td>
			<th class="colorSky">건설공사대장</th>
            <td id="cntwrk_regstr_ennc" colspan="1"></td>
        </tr>

	</tbody>
</table>
<!-- ---------------------------------------------------------------------- -->

<!-- ---------------------------------------------------------------------- -->
<table id="rptTable3" style="border-top:0px solid #000!important;">
	<colgroup>
        <col width="175">
        <col width="150">
        <col width="175">
        <col width="150">
        <col width="175">
        <col width="150">
        <col width="175">
        <col width="150">
	</colgroup>
	<!--
	<tbody id="cCostList">
		<tr>
			<th class="colorSky">설치공사금액산출</th>
			<th class="colorSky">실내기대수</th>
			<th class="colorSky">대당단가</th>
			<th class="colorSky">공급가액</th>
			<th class="colorSky">세액</th>
			<th class="colorSky">합계</th>
			<th class="colorSky">공사비총액</th>
		</tr>
		<tr>
			<td class="text-center" id="cCost5_model_no"></td>
			<td class="text-number" id="cCost5_qy"></td>
			<td class="text-number" id="cCost5_amt"></td>
			<td class="text-number" id="cCost5_amt_total"></td>
			<td class="text-number" id="cCost5_vat_total"></td>
			<td class="text-number" id="cCost5_sum"></td>
			<td class="text-number" id="cCost5_total"></td>
		</tr>
	</tbody>
	-->
	<tbody>
		<tr>
			<th class="colorSky" colspan="1">결제방법(1)</th>
			<td class="text-left" colspan="7" id="setle_mth"></td>
		</tr>
		<tr>
			<th class="colorSky" colspan="1">결제방법(2)</th>
			<th class="colorSky" colspan="2">금액</th>
			<th class="colorSky" colspan="1">일자</th>
			<th class="colorSky" colspan="4">비고(특이사항)</th>
		</tr>
		<tr>
			<th class="colorSky" colspan="1">계약금</th>
			<td class="text-number" colspan="2" id="enty"></td>
			<td colspan="1" id="enty_de"></td>
			<td id="enty_rm" colspan="4"></td>
		</tr>
		<tr>
			<th class="colorSky" colspan="1">중도금</th>
			<td class="text-number" colspan="2" id="prtpay"></td>
			<td colspan="1" id="prtpay_de"></td>
			<td id="prtpay_rm" colspan="4"></td>
		</tr>
		<tr>
			<th class="colorSky" colspan="1">잔금</th>
			<td class="text-number" colspan="2" id="surlus"></td>
			<td colspan="1" id="surlus_de"></td>
			<td id="surlus_rm" colspan="4"></td>
		</tr>
	</tbody>
</table>
<table id="construct">
    <colgroup>
        <col width="100"/>
        <col width="100"/>
        <col width="100"/>
        <col width="100"/>
        <col width="100"/>
        <col width="100"/>
        <col width="100"/>
    </colgroup>
    <thead>
        <tr>
			<th class="sub-title colorN text-center" colspan="7" style="border-right:0px!important;">공사비 산출 (영업/자동)</th>
        </tr>
        <tr>
            <th class="color-contract text-center">내역</th>
            <th class="color-contract text-center">실내기대수</th>
            <th class="color-contract text-center">대당단가</th>
            <th class="color-contract text-center">공급가액</th>
            <th class="color-contract text-center">세액</th>
            <th class="color-contract text-center">합계</th>
            <th class="color-contract text-center">공사비총액</th>
        </tr>
    </thead>
    <tbody role="construct_row">

    </tbody>
</table>
<table id="report_patrol">
	<colgroup>
		<col width="80">
		<col width="80">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="50">
		<col width="100">

	</colgroup>
	<thead>
        <tr>
			<th class="sub-title colorN text-center" colspan="18" style="border-right:0px!important;">공사 현황 (영업) - VAT포함</th>
        </tr>
		<tr>
			<th class="colorN text-center">구분</th>
			<th class="color-contract text-center">내역</th>
			<th class="color-contract text-center">①삼성장비</th>
			<th class="color-contract text-center">②타사장비</th>
			<th class="colorG text-center" style="border-left: 2px solid #555!important;border-right: 2px solid #555!important;">장비비 계</th>
			<th class="color-contract text-center">③도급비</th>
			<th class="color-contract text-center">④로지텍자재</th>
			<th class="color-contract text-center">⑤타사자재</th>
			<th class="colorG text-center" style="border-left: 2px solid #555!important;border-right: 2px solid #555!important;">설치비 계</th>
			<th class="color-contract text-center">⑥간접비</th>
			<th class="color-contract text-center">⑦M,S/H(기준표)</th>
			<th class="color-contract text-center">⑧옵션행사비(기준표)</th>
			<th class="color-contract text-center">⑨기타(총액 0.5%)</th>
			<th class="color-contract text-center">설계변경</th>
			<th class="color-contract text-center">총액</th>
			<th class="colorLP text-center">이익금(VA)</th>
			<th class="colorLP text-center">VA율</th>
			<th class="color-contract text-center">품의일자</th>
		</tr>
	</thead>
	<tbody role="patrol">
		<tr data-row="C">
			<th class="colorN text-center" rowspan="2">사전입찰</th>
			<th class="colorSky">예정가</th>
			<td class="text-number" id="aCost1"></td>
			<td class="text-number" id="aCost2"></td>
			<td class="text-number" id="aCost12Total" style="border-left: 2px solid #555!important;border-right: 2px solid #555!important;"></td>
			<td class="text-number" id="aCost5"></td>
			<td class="text-number" id="aCost3"></td>
			<td class="text-number" id="aCost4"></td>
			<td class="text-number" id="aCost345Total" style="border-left: 2px solid #555!important;border-right: 2px solid #555!important;"></td>
			<td class="text-number" id="aCost8"></td>
			<td class="text-number" id="aCost61"></td>
			<td class="text-number" id="aCost7"></td>
			<td class="text-number" id="aCost10"></td>
			<td class="text-number" id="aCost99"></td>
			<td class="text-number" id="aCostTotal"></td>
			<td class="text-number" id="sCostTotal" rowspan="2"></td>
			<td class="text-number" id="sCost11" rowspan="2"></td>
			<td class="text-center" id="bCostDTM" rowspan="2"></td>
		</tr>
		<tr data-row="E">
			<th class="colorSky">실행가</th>
			<td class="text-number" id="bCost1"></td>
			<td class="text-number" id="bCost2"></td>
			<td class="text-number" id="bCost12Total" style="border-left: 2px solid #555!important;border-right: 2px solid #555!important;"></td>
			<td class="text-number" id="bCost5"></td>
			<td class="text-number" id="bCost3"></td>
			<td class="text-number" id="bCost4"></td>
			<td class="text-number" id="bCost345Total" style="border-left: 2px solid #555!important;border-right: 2px solid #555!important;"></td>
			<td class="text-number" id="bCost8"></td>
			<td class="text-number" id="bCost61"></td>
			<td class="text-number" id="bCost7"></td>
			<td class="text-number" id="bCost10"></td>
			<td class="text-number" id="bCost99"></td>
			<td class="text-number" id="bCostTotal"></td>
		</tr>
	</tbody>
	<tbody role="plan">
		<tr data-row="C">
			<th class="colorN text-center" rowspan="2">수주계약</th>
			<th class="colorSky">계약가</th>
			<td class="text-number" id="cCost1"></td>
			<td class="text-number" id="cCost2"></td>
			<td class="text-number" id="cCost12Total" style="border-left: 2px solid #555!important;border-right: 2px solid #555!important;"></td>
			<td class="text-number" id="cCost5"></td>
			<td class="text-number" id="cCost3"></td>
			<td class="text-number" id="cCost4"></td>
			<td class="text-number" id="cCost345Total" style="border-left: 2px solid #555!important;border-right: 2px solid #555!important;"></td>
			<td class="text-number" id="cCost8"></td>
			<td class="text-number" id="cCost61"></td>
			<td class="text-number" id="cCost7"></td>
			<td class="text-number" id="cCost10"></td>
			<td class="text-number" id="cCost99"></td>
			<td class="text-number" id="cCostTotal"></td>
			<td class="text-number" id="tCostTotal" rowspan="2"></td>
			<td class="text-number" id="tCost11" rowspan="2"></td>
			<td class="text-center" id="aCostDTM" rowspan="2"></td>
		</tr>
		<tr data-row="E">
			<th class="colorSky">실행가</th>
			<td class="text-number" id="eCost1"></td>
			<td class="text-number" id="eCost2"></td>
			<td class="text-number" id="eCost12Total" style="border-left: 2px solid #555!important;border-right: 2px solid #555!important;"></td>
			<td class="text-number" id="eCost5"></td>
			<td class="text-number" id="eCost3"></td>
			<td class="text-number" id="eCost4"></td>
			<td class="text-number" id="eCost345Total" style="border-left: 2px solid #555!important;border-right: 2px solid #555!important;"></td>
			<td class="text-number" id="eCost8"></td>
			<td class="text-number" id="eCost61"></td>
			<td class="text-number" id="eCost7"></td>
			<td class="text-number" id="eCost10"></td>
			<td class="text-number" id="eCost99"></td>
			<td class="text-number" id="eCostTotal"></td>
		</tr>
	</tbody>
</table>

<table id="report_exec">
	<colgroup>
		<col width="80">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="100">
		<col width="120">
		<col width="50">
	</colgroup>
	<thead>
		<tr>
			<th class="sub-title colorN text-center" colspan="16">결산내역 (관리) - VAT포함</th>
		</tr>
	</thead>
	<tbody role="body">
		<tr>
			<th class="colorN" rowspan="2">결산내역</th>
			<th class="colorP">공사비(계약)총액</th>
			<th class="colorP">입금합계</th>
			<th class="colorP">①삼성장비</th>
			<th class="colorP">②타사장비</th>
			<th class="colorG">장비비 계</th>
			<th class="colorP">③도급비</th>
			<th class="colorP">④로지텍자재</th>
			<th class="colorP">⑤타사자재</th>
			<th class="colorG">설치비 계</th>
			<th class="colorP">⑥간접비</th>
			<th class="colorP">⑦M,S/H 설치·회수</th>
			<th class="colorP">⑧옵션행사비</th>
			<th class="colorP">⑨기타(총액 0.5%)</th>
			<th class="colorLP">이익금(VA)</th>
			<th class="colorLP">VA율</th>
		</tr>
		<tr data-row="result">
			<td class="text-number colorP"></td>
			<th class="text-number colorP"></th>
			<td class="text-number"></td>
			<td class="text-number"></td>
			<th class="text-number colorW"></th>
			<td class="text-number"></td>
			<td class="text-number"></td>
			<td class="text-number"></td>
			<th class="text-number colorW"></th>
			<td class="text-number"></td>
			<td class="text-number"></td>
			<td class="text-number"></td>
			<td class="text-number"></td>
			<td class="text-number"></td>
			<td class="text-center"></td>
		</tr>
	</tbody>
</table>
<!-- ---------------------------------------------------------------------- -->
<table id="rcppay_status">
	<tbody>
		<tr>
			<th class="sub-title colorN text-center" colspan="2">입금현황 (관리) - VAT포함</th>
		</tr>
	</tbody>
	<tbody role="body">
	</tbody>
</table>
<!-- ---------------------------------------------------------------------- -->
<table id="rptTable7">
	<colgroup>
		<col width="100">
		<col width="120">
		<col width="180">
		<col width="180">
		<col width="100">
		<col width="180">
		<col width="180">
		<col width="180">
		<col width="180">
		<col width="180">
	</colgroup>
	<tbody class="">
		<tr>
			<th class="sub-title colorN text-center" colspan="10">① 삼성장비매입금액 (관리/자동) - VAT포함</th>
		</tr>
	</tbody>
	<tbody role="contract">
		<tr>
			<th colspan="10" class="color-contract text-center">계약장비내역</th>
		</tr>
		<tr>
			<td colspan="10" class="hasTable" style="padding:0px!important;">
				<table id="rptTable7Contract" style="border:none!important;">
					<colgroup>
						<col width="145">
						<col width="*">
					</colgroup>
					<thead>
						<th class="color-contract" colspan="1">마지막 출고일</th>
						<th class="color-contract" colspan="1">상품명</th>
						<th class="color-contract" colspan="1">모델명</th>
						<th class="color-contract" colspan="1">계약수량</th>
						<th class="color-contract" colspan="1">매입단가</th>
						<th class="color-contract" colspan="1">기출고수량</th>
						<th class="color-contract" colspan="1">매입금액</th>
						<th class="color-contract" colspan="1">매출금액</th>
						<th class="color-contract" colspan="1">VA</th>
						<th class="color-contract" colspan="1">매입처</th>
						<th class="color-contract" colspan="1">비고</th>
					<!-- 매입단가-출고수량-매입금액-VA -->
					</thead>
					<tbody>

					</tbody>
				</table>

			</td>
		</tr>
	</tbody>
	<tbody>
		<tr>
			<th colspan="10" class="color-contract text-center">출고장비내역</th>
		</tr>

		<tr>
			<th class="color-contract" colspan="1">출고일</th>
			<th class="color-contract" colspan="1">상품명</th>
			<th class="color-contract" colspan="1">모델명</th>
			<th class="color-contract" colspan="1">매입단가</th>
			<th class="color-contract" colspan="1">출고수량</th>
			<th class="color-contract" colspan="1">매입금액</th>
			<th class="color-contract" colspan="1">매출금액</th>
			<th class="color-contract" colspan="1">VA</th>
			<th class="color-contract" colspan="1">매입처</th>
			<th class="color-contract" colspan="1">비고</th>
		</tr>
	</tbody>
	<tbody role="body"></tbody>
	<tfoot>
		<th class="colorG" colspan="3">합계</th>
		<th class="text-number colorG"></th>
		<th class="text-number colorG"></th>
		<th class="text-number colorP"></th>
		<th class="text-number colorG"></th>
		<th class="text-number colorG"></th>
		<th class="text-number colorG"></th>
		<th class="text-number colorG"></th>
	</tfoot>
</table>
<!-- ---------------------------------------------------------------------- -->
<table id="rptTable8">
	<colgroup>
		<col width="100">
		<col width="160">
		<col width="180">
		<col width="100">
		<col width="180">
		<col width="180">
		<col width="180">
		<col width="180">
		<col width="180">
		<col width="180">
	</colgroup>
	<tbody>
		<tr>
			<th class="sub-title colorN text-center" colspan="10">② 타사장비 (관리/자동) - VAT포함</th>
		</tr>
	</tbody>
	<tbody role="contract">
		<tr>
			<th colspan="10" class="color-contract text-center">계약장비내역</th>
		</tr>
		<tr>
			<td colspan="10" class="hasTable" style="padding:0px!important;">
				<table id="rptTable8Contract" style="border:none!important;">
					<colgroup>
						<col width="145">
						<col width="*">
					</colgroup>
					<thead>
						<th class="color-contract" colspan="1">마지막 출고일</th>
						<th class="color-contract" colspan="1">상품명</th>
						<th class="color-contract" colspan="1">모델명</th>
						<th class="color-contract" colspan="1">계약수량</th>
						<th class="color-contract" colspan="1">매입단가</th>
						<th class="color-contract" colspan="1">기출고수량</th>
						<th class="color-contract" colspan="1">매입금액</th>
						<th class="color-contract" colspan="1">매출금액</th>
						<th class="color-contract" colspan="1">VA</th>
						<th class="color-contract" colspan="1">매입처</th>
						<th class="color-contract" colspan="1">비고</th>
					</thead>
					<tbody>

					</tbody>
				</table>

			</td>
		</tr>
	</tbody>
	<tbody>
		<tr>
			<th colspan="10" class="color-contract text-center">계약장비내역</th>
		</tr>
		<tr>
			<th class="color-contract" colspan="1">출고일</th>
			<th class="color-contract" colspan="1">상품명</th>
			<th class="color-contract" colspan="1">모델명</th>
			<th class="color-contract" colspan="1">매입단가</th>
			<th class="color-contract" colspan="1">수량</th>
			<th class="color-contract" colspan="1">매입금액</th>
			<th class="color-contract" colspan="1">매출금액</th>
			<th class="color-contract" colspan="1">VA</th>
			<th class="color-contract" colspan="1">매입처</th>
			<th class="color-contract" colspan="1">비고</th>
		</tr>
	</tbody>
	<tbody role="body"></tbody>
	<tfoot>
		<tr>
			<th class="colorG total" colspan="3">합계</th>
			<th class="colorG total"></th>
			<th class="colorG total"></th>
			<th class="colorP text-number total"></th>
			<th class="colorG text-number total"></th>
			<th class="colorG text-number total"></th>
			<th class="colorG total"></th>
			<th class="colorG total"></th>
		</tr>
	</tfoot>
</table>
<!-- ---------------------------------------------------------------------- -->
<table id="rptTable9">
	<colgroup>
		<col width="200">
		<col width="200">
		<col width="200">
		<col width="200">
		<col width="200">
		<col width="200">
		<col width="400">
	</colgroup>
	<tbody>
		<tr>
			<th class="sub-title colorN text-center" colspan="7">③ 설치비 산출 및 지급내역 (영업,관리/자동) - VAT포함</th>
		</tr>
	</tbody>
	<tbody role="body">
	</tbody>

	<tbody role="foot">
		<tr>
			<th colspan="7" style="padding:0px!important;vertical-align:top!important;border-top:1px solid #555!important;">
				<table id="report_biss" style="border:0px!important;">
					<colgroup>
						<col width="100">
						<col width="100">
						<col width="100">
						<col width="100">
						<col width="100">
						<col width="100">
						<col width="100">
						<col width="100">
						<col width="100">
						<col width="100">
						<col width="100">
					</colgroup>
					<tbody>
							<th class="color-contract" rowspan="2">업체 및 BISS 확인사항</th>
							<th class="color-contract">계약이행증권</th>
							<th class="color-contract">국세/지방세</th>
							<th class="color-contract">직불적용(2억이상)</th>
							<th class="color-contract">하자이행증권</th>
							<th class="color-contract">실명제라벨</th>
							<th class="color-contract">준공도면</th>
							<th class="color-contract">S-NET</th>
							<th class="color-contract">준공현장정보</th>
							<th class="color-contract">마지막기성</th>
							<th class="color-contract">BISS해결완료</th>
						</tr>
						<tr>
							<td class="text-center" id="biss_a"></td>
							<td class="text-center" id="biss_b"></td>
							<td class="text-center" id="biss_c"></td>
							<td class="text-center" id="biss_d"></td>
							<td class="text-center" id="biss_e"></td>
							<td class="text-center" id="biss_f"></td>
							<td class="text-center" id="biss_g"></td>
							<td class="text-center" id="biss_h"></td>
							<td class="text-center" id="biss_i"></td>
							<td class="text-center" id="biss_j"></td>
						</tr>
					</tbody>
				</table>
			</th>
		</tr>

		<tr>
			<th class="sub-title colorN text-center" colspan="7">일용직</th>
		</tr>
	</tbody>
</table>

<table id="rptTable10">
	<colgroup>
		<col width="160">
		<col width="160">
		<col width="180">
		<col width="180">
		<col width="180">
		<col width="180">
		<col width="160">
		<col width="*">
	</colgroup>
	<tbody>
		<tr>
			<th class="sub-title colorN text-center" colspan="8">④ 로지텍자재 (관리)</th>
		</tr>
		<tr>
			<th class="color-contract">출고일</th>
			<th class="color-contract">품목</th>
			<th class="color-contract">매입금액</th>
			<th class="color-contract">공급가액</th>
			<th class="color-contract">부가세</th>
			<th class="color-contract">합계</th>
			<th class="color-contract">매입처</th>
			<th class="color-contract">비고</th>
		</tr>
	</tbody>
	<tbody role="body"></tbody>
	<tfoot>
		<tr>
			<th class="colorG" colspan="2">합계</th>
			<th class="text-number colorG"></th>
			<th class="text-number colorG"></th>
			<th class="text-number colorG"></th>
			<th class="text-number colorP"></th>
			<th class=" colorG"></th>
			<th class=" colorG"></th>

		</tr>
	</tfoot>
</table>
<!-- ---------------------------------------------------------------------- -->
<table id="rptTable11">
	<colgroup>
		<col width="160">
		<col width="160">
		<col width="180">
		<col width="180">
		<col width="100">

		<col width="180">
		<col width="180">
		<col width="180">

		<col width="160">
		<col width="*">
	</colgroup>
	<tbody>
		<tr>
			<th class="sub-title colorN text-center" colspan="10">⑤ 타사자재</th>
		</tr>
		<tr>
			<th class="color-contract">출고일</th>
			<th class="color-contract">상품명</th>
			<th class="color-contract">모델명</th>
			<th class="color-contract">매입단가</th>
			<th class="color-contract">수량</th>
			<th class="color-contract">매입금액</th>
			<th class="color-contract">매출금액</th>
			<th class="color-contract">VA</th>
			<th class="color-contract">매입처</th>
			<th class="color-contract">비고</th>
		</tr>
	</tbody>
	<tbody role="body"></tbody>
	<tfoot>
		<tr>
			<th class="colorG" colspan="3">합계</th>
			<th class="colorG"></th>
			<th class="colorG"></th>
			<th class="text-number colorP"></th>
			<th class="text-number colorG"></th>
			<th class="text-number colorG"></th>
			<th class="colorG"></th>
			<th class="colorG"></th>
		</tr>
	</tfoot>
</table>

<!-- ---------------------------------------------------------------------- -->
<table id="rptTable9_indirect">
	<colgroup>
		<col width="200">
		<col width="200">
		<col width="200">
		<col width="200">
		<col width="200">
		<col width="200">
		<col width="400">
	</colgroup>
	<tbody>
		<tr>
			<th class="sub-title colorN text-center" colspan="7">⑥간접비</th>
		</tr>
	</tbody>
	<tbody role="body"></tbody>
</table>

<!-- ---------------------------------------------------------------------- -->
<table>
	<tbody role="header">
		<tr>
			<th class="sub-title colorN text-center" colspan="10">⑦ M,S/H 설치·회수</th>
		</tr>
	</tbody>
	<tbody role="body1">

		<table id="rptTable14"><!--모델하우스-->
			<colgroup>
				<col width="100"/>
				<col width="100"/>
				<col width="100"/>
				<col width="100"/>
				<col width="100"/>
				<col width="100"/>
				<col width="100"/>
				<col width="100"/>
				<col width="100"/>
				<col width="80"/>
				<col width="80"/>
				<col width="100"/>
				<col width="100"/>
			</colgroup>
			<tbody class="">
				<th class="color-contract text-center">출고일</th>
				<th class="color-contract text-center">상품명</th>
				<th class="color-contract text-center">모델명</th>
				<th class="color-contract text-center">매입단가</th>
				<th class="color-contract text-center">수량</th>
				<th class="color-contract text-center">매입금액</th>
				<th class="color-contract text-center" style="border-right:2px solid #555!important;">매입처</th>
				<th class="colorP text-center">회수예정(출+6개월)</th>
				<th class="colorY text-center">회수일</th>
				<th class="colorY text-center">회수수량</th>
				<th class="colorY text-center">차이수량</th>
				<th class="colorY text-center">회수창고</th>
				<th class="colorY text-center">비고</th>
			</tbody>
			<tbody role="body">

			</tbody>
		    <tfoot>
				<tr>
					<th class="colorG text-center" colspan="4">합계</th>
					<th class="colorG text-center" data-column="total_dlnt"></th>
					<th class="colorP text-right" data-column="total_amount"></th>
					<th class="colorG" style="border-right:2px solid #555!important;"></th>
					<th class="colorG"></th>
					<th class="colorG"></th>
					<th class="colorG text-center" data-column="total_return"></th>
					<th class="colorG text-center" data-column="total_diff"></th>
					<th class="colorG"></th>
					<th class="colorG"></th>
				</tr>
			</tfoot>
		</table>

	</tbody>
</table>
<!-- ---------------------------------------------------------------------- -->
<table id="rptTableOpt">
	<colgroup>
		<col width="80"/>
		<col width="100"/>
		<col width="100"/>
		<col width="100"/>
		<col width="100"/>
		<col width="160"/>
		<col width="100"/>
		<col width="140"/>
	</colgroup>
	<thead>
		<tr>
			<th class="sub-title colorN text-center" colspan="8">⑧ 옵션행사비</th>
		</tr>
		<tr>
			<th class="color-contract text-center">구분</th>
			<th class="color-contract text-center">행사기간</th>
			<th class="color-contract text-center">행사일(일)</th>
			<th class="color-contract text-center">도우미(명)</th>
			<th class="color-contract text-center">옵션율</th>
			<th class="color-contract text-center">옵션행사비</th>
			<th class="color-contract text-center">행사비 지급일</th>
			<th class="color-contract text-center">비고</th>
		</tr>
	</thead>
	<tbody role="body">
		<tr>
			<th class="colorSky text-center">예상</th>
			<td class="text-center" data-column="e_opt_period"></td>
			<td class="text-center" data-column="e_opt_dtm"></td>
			<td class="text-center" data-type="number" data-column="e_opt_helper"></td>
			<td class="text-center" data-column="e_opt_rate"></td>
			<td class="text-right" data-type="number" data-column="e_opt_amount"></td>
			<td class="text-center" data-column="e_opt_pay_dtm"></td>
			<td class="text-center" data-column="e_opt_rm"></td>
		</tr>
		<tr>
			<th class="colorSky text-center">정산</th>
			<td class="text-center" data-column="c_opt_period"></td>
			<td class="text-center" data-column="c_opt_dtm"></td>
			<td class="text-center" data-type="number" data-column="c_opt_helper"></td>
			<td class="text-center" data-column="c_opt_rate"></td>
			<td class="colorP text-right" data-type="number" data-column="c_opt_amount"></td>
			<td class="text-center" data-column="c_opt_pay_dtm"></td>
			<td class="text-center" data-column="c_opt_rm"></td>
		</tr>
	</tbody>
	<tfoot>
		<tr>
			<th class="colorG text-center">차이</th>
			<td class="colorG text-center"></td>
			<td class="colorG text-center"></td>
			<td class="colorG text-center"></td>
			<td class="colorG text-center"></td>
			<td class="colorG text-right" data-column="diff"></td>
			<td class="colorG text-center"></td>
			<td class="colorG text-center"></td>
		</tr>
	</tfoot>
</table>
<!-- ---------------------------------------------------------------------- -->
<table id="rptTable12">
	<colgroup>
		<col width="145">
		<col width="150">
		<col width="*">
	</colgroup>
	<tbody>
		<tr>
			<th class="sub-title colorN text-center" colspan="5">⑨ 기타비용(관리)</th>
		</tr>
		<tr>
			<th class="color-contract">일자</th>
			<th class="color-contract">계정과목</th>
			<th class="color-contract">내역</th>
			<th class="color-contract">담당자</th>
			<th class="color-contract">금액</th>
		</tr>
	</tbody>
	<tbody role="body"></tbody>
	<tfoot>
		<tr>
			<th class="colorG">합계</th>
			<th class="colorG"></th>
			<th class="colorG"></th>
			<th class="colorG"></th>
			<th class="colorP text-number"></th>
		</tr>
	</tfoot>
</table>
<table id="rptTable13">
	<colgroup>
		<col width="*">
	</colgroup>

	<thead>
		<tr>
			<th class="sub-title colorN text-center" colspan="1">참고 및 특이사항</th>
		</tr>

	</thead>
	<tbody>

	</tbody>
	<tfoot>
		<tr>
			<td class="text-left" style="vertical-align: top!important;word-break:break-all!important;" colspan="1" id="partclr_matter">
			</td>
		</tr>
	</tfoot>
</table>

<!-- <div id="img-out"></div> -->

			</div><!--modal-body-->
        </div><!--modal-content-->
    </div><!--modal-dialog-->
</div>
<!-- 레포트1 레이어 팝업 끝 -->

<script>
    $(document).ready(function(){
    	$.ajax({
		url: '/api/project/ajax_get_reportNR',
		type: 'GET',
		data: {{ params | tojson | safe}},
		success: function(pResult) {
			console.log('getReportNR', pResult);
			if (pResult.status) {
				var contract = pResult.contract;
				var project = pResult.project;
				var charger = pResult.charger;
				var construct = pResult.construct;

				$('#popReportNR').find('td').not(".hasTable").html('');

				/* 프로젝트 기본 정보 */
				/* ********************************************************* */
				$('#popReportNR').find('#manage_no').html(contract.cntrct_no); //관리자,관리번호
				$('#popReportNR').find('#regist_dtm').html(contract.regist_dtm); //작성일
				$('#popReportNR').find('#bsn_chrg_nm').html(contract.bsn_chrg_nm); //영업담당
				$('#popReportNR').find('#spt_chrg_nm').html(contract.spt_chrg_nm); //공무담당
				$('#popReportNR').find('#cntrct_de').html(contract.cntrct_de); //계약일
				$('#popReportNR').find('#bcnc_nm').html(contract.bcnc_nm); //거래처
				$('#popReportNR').find('#spt_nm').html(contract.spt_nm); //현장명
				$('#popReportNR').find('#cntrwk_period').html(contract.cntrwk_period); //공사기간
				$('#popReportNR').find('#home_count').html(contract.home_count); //세대수
				$('#popReportNR').find('#home_region').html(contract.home_region); //지역
				$('#popReportNR').find('[name=prjct_ty_code]').yVal(contract.prjct_ty_code); //프로젝트 유형
				$('#popReportNR').find('[name=prjct_ty_code]').yReadonly(true); //프로젝트 유형
				$('#popReportNR').find('[name=prjct_creat_at]').yVal(contract.prjct_creat_at); //프로젝트 생성
				$('#popReportNR').find('[name=prjct_creat_at]').yReadonly(true); //프로젝트 생성
				$('#popReportNR').find('[name=progrs_sttus_code]').yVal(contract.progrs_sttus_code); //프로젝트 진행
				$('#popReportNR').find('[name=progrs_sttus_code]').yReadonly(true); //프로젝트 진행

                $('#popReportNR').find('#biss_a').html(biss2text(contract.biss_a));
                $('#popReportNR').find('#biss_b').html(biss2text(contract.biss_b));
                $('#popReportNR').find('#biss_c').html(biss2text(contract.biss_c));
                $('#popReportNR').find('#biss_d').html(biss2text(contract.biss_d));
                $('#popReportNR').find('#biss_e').html(biss2text(contract.biss_e));
                $('#popReportNR').find('#biss_f').html(biss2text(contract.biss_f));
                $('#popReportNR').find('#biss_g').html(biss2text(contract.biss_g));
                $('#popReportNR').find('#biss_h').html(biss2text(contract.biss_h));
                $('#popReportNR').find('#biss_i').html(biss2text(contract.biss_i));
                $('#popReportNR').find('#biss_j').html(biss2text(contract.biss_j));

				if(contract.renewal == 0){
					$('#renewal').removeClass("btn-success").addClass("btn-danger");
					$('#renewal').find("i").removeClass("fa-smile-o").addClass("fa-frown-o");
				}
				else{
					$('#renewal').removeClass("btn-danger").addClass("btn-success");
					$('#renewal').find("i").removeClass("fa-frown-o").addClass("fa-smile-o");
				}
				{% if session["member"]["auth_cd"] == 1 or session["member"]["member_sn"] in (4, 21, 26, 63) %}
				$(document).on("click", "#renewal", function(){
					var renewal = $('#renewal').hasClass("btn-danger") ? 1 : 0;
					var params = {"cntrct_sn" : contract.cntrct_sn, "renewal" : renewal};
					$.ajax({
						url : '/api/project/ajax_update_renewal',
						method : 'POST',
						data : params,
						success: function(){
							$('#renewal').toggleClass("btn-danger").toggleClass("btn-success");
							$('#renewal').find("i").toggleClass("fa-frown-o").toggleClass("fa-smile-o");
						},
						error: function(){
							alert("에러가 발생했습니다. 다시 시도해주세요.");
						}
					})


				});
				{% endif %}


				$('#popReportNR').find('#spt_adres').html(contract.spt_adres); //현장주소
				$('#popReportNR').find('#eqpmn_dtls').html(project.eqpmn_dtls); //장비내역
				$('#popReportNR').find('#cntrwk_dtls').html(project.cntrwk_dtls); //공사내역
				$('#popReportNR').find('#drw_opertor_nm').html(project.drw_opertor_nm); //도면작업자
				$('#popReportNR').find('#acmslt_sttemnt_at').html(project.acmslt_sttemnt_at); //실적신고
				$('#popReportNR').find('#cntwrk_regstr_ennc').html(project.cntwrk_regstr_ennc); //건설공사대장

				$.each(charger, function(pIndex, pValue) { //담당자정보
					$('#popReportNR').find('#charger_nm'+pValue.charger_se_code).html(pValue.charger_nm);
					$('#popReportNR').find('#charger_moblphon'+pValue.charger_se_code).html(pValue.charger_moblphon);
				});

				var html = ``;
				var construct_total = 0;
				$.each(construct, function(pIndex, pValue){
					construct_total += Math.round(pValue.construct_count*pValue.construct_amt*1.1);
					html += `<tr>
								<td class="text-center">${pValue.construct_name}</td>
								<td class="text-center">${pValue.construct_count.toFormat('NUMBER')}</td>
								<td class="text-right">${pValue.construct_amt.toFormat('NUMBER')}</td>
								<td class="text-right">${(pValue.construct_count*pValue.construct_amt).toFormat('NUMBER')}</td>
								<td class="text-right">${Math.round((pValue.construct_count*pValue.construct_amt)*0.1).toFormat('NUMBER')}</td>
								<td class="text-right">${(Math.round(pValue.construct_count*pValue.construct_amt*1.1)).toFormat('NUMBER')}</td>
								<td class="text-right colorP"></td>
							 </tr>`;
				});
				$("#popReportNR").find('tbody[role="construct_row"]').html(html);
				$("#popReportNR").find('tbody[role="construct_row"]').find(".colorP").html(construct_total.toFormat('NUMBER'));
				$("#popReportNR").find('tbody[role="construct_row"]').yRowspan(6);

				/* ********************************************************* */

                /* 프로젝트 진행 투찰 예정 보고서(영업) */
				/* ********************************************************* */
				var bCostList = pResult.bCostList, cCostTotal = 0, eCostTotal = 0;
				var bCostDTM = '9999-99-99';
				var bTotals = {"A" : [0, 0], "B" : [0, 0]};
				console.log('bCostList', bCostList);
				$.each(bCostList, function(pIndex, pValue) {
					var amount = 0;
					if (pValue.amount != '') {
						amount = parseInt(pValue.amount);
						if(bCostDTM > pValue.dtm){
							bCostDTM = pValue.dtm;
						}
					}
					if (pValue.cntrct_execut_code == 'B') // 계약
					{
						if([1, 2].includes(parseInt(pValue.ct_se_code))){
							bTotals["A"][0] += amount;
						}
						else if([3, 4, 5].includes(parseInt(pValue.ct_se_code))){
							bTotals["A"][1] += amount;
						}
						cCostTotal += amount;
						$('#popReportNR').find('#aCost'+pValue.ct_se_code).html(pValue.amount.toString().toFormat('NUMBER'));
					}
					else if (pValue.cntrct_execut_code == 'D') // 실행
					{
						if([1, 2].includes(parseInt(pValue.ct_se_code))){
							bTotals["B"][0] += amount;
						}
						else if([3, 4, 5].includes(parseInt(pValue.ct_se_code))){
							bTotals["B"][1] += amount;
						}
						eCostTotal += amount;
						$('#popReportNR').find('#bCost'+pValue.ct_se_code).html(pValue.amount.toString().toFormat('NUMBER'));
					}
				});

//				if (cCostTotal != 0) {
					$('#popReportNR').find('#aCost12Total').html(bTotals["A"][0].toString().toFormat('NUMBER'));
					$('#popReportNR').find('#aCost345Total').html(bTotals["A"][1].toString().toFormat('NUMBER'));
					$('#popReportNR').find('#bCost12Total').html(bTotals["B"][0].toString().toFormat('NUMBER'));
					$('#popReportNR').find('#bCost345Total').html(bTotals["B"][1].toString().toFormat('NUMBER'));
					$('#popReportNR').find('#aCostTotal').html(cCostTotal.toString().toFormat('NUMBER'));
					$('#popReportNR').find('#bCostDTM').html((bCostDTM == '9999-99-99') ? '' : bCostDTM);

//				}
//				if (eCostTotal != 0) {
					$('#popReportNR').find('#bCostTotal').html(eCostTotal.toString().toFormat('NUMBER'));
//				}

				// 차액
				var tCost = [];
				var trList = $('#report_patrol').find('tbody tr');
				$.each(trList, function(pIndex, pValue) {
					var tdList = $(pValue).find('td');
					if (pIndex == 0) {
						$.each(tdList, function(pIndex, pValue) {
							var tmp = $(pValue).html().replaceAll(',', '');
							if (tmp != '') {
								tCost[pIndex] = parseInt(tmp);
							} else {
								tCost[pIndex] = 0;
							}
						});
					} else {
						$.each(tdList, function(pIndex, pValue) {
							var tmp = $(pValue).html().replaceAll(',', '');
							if (tmp != '') {
								tCost[pIndex] -= parseInt(tmp);
							} else {
								tCost[pIndex] -= 0;
							}
						});
					}
				});
				var thList = $('#report_patrol').find('tfoot tr td');
				$.each(thList, function(pIndex, pValue) {
                    if(pIndex >= 9){
                        return false;
                    }
					console.log('sCost['+pIndex+']', tCost[pIndex]);
					if (tCost[pIndex]!==null) {
						$(pValue).html(tCost[pIndex].toString().toFormat('NUMBER'));
                    }
				});

				var tCostTotal = cCostTotal - eCostTotal;
				$('#popReportNR').find('#sCostTotal').html(tCostTotal.toString().toFormat('NUMBER'));
                $('#popReportNR').find('#sCost11').html((tCostTotal*100.0/cCostTotal).toFixed(1)+'%')
                // if(cCostTotal == 0 && eCostTotal == 0){
                //     $('#report_patrol').hide();
                // }
                // else{
                    $('#report_patrol').show();
                // }

				/* 프로젝트 진행 예정 보고서(영업) */
				/* ********************************************************* */
				var aCostList = pResult.aCostList, cCostTotal = 0, eCostTotal = 0, cCostTotalLast = 0;
				var cTotals = {"C" : [0, 0], "E" : [0, 0]};
				var aCostDTM = '9999-99-99';
				console.log('aCostList', aCostList);
				$.each(aCostList, function(pIndex, pValue) {
					var amount = 0;
					if (pValue.amount != '') {
						amount = parseInt(pValue.amount);
						if(aCostDTM > pValue.dtm){
							aCostDTM = pValue.dtm;
						}
					}
					if (pValue.cntrct_execut_code == 'C') // 계약
					{
						if([1, 2].includes(parseInt(pValue.ct_se_code))){
							cTotals["C"][0] += amount;
						}
						else if([3, 4, 5].includes(parseInt(pValue.ct_se_code))){
							cTotals["C"][1] += amount;
						}
						cCostTotal += amount;
						cCostTotalLast += amount;
						$('#popReportNR').find('#cCost'+pValue.ct_se_code).html(pValue.amount.toString().toFormat('NUMBER'));
					}
					else if (pValue.cntrct_execut_code == 'E') // 실행
					{
						if([1, 2].includes(parseInt(pValue.ct_se_code))){
							cTotals["E"][0] += amount;
						}
						else if([3, 4, 5].includes(parseInt(pValue.ct_se_code))){ // 5: 도급비는 아래 도급비 총액에서 합산
							cTotals["E"][1] += amount;
						}
						if(parseInt(pValue.ct_se_code) != 9){
							eCostTotal += amount;
						}
						$('#popReportNR').find('#eCost'+pValue.ct_se_code).html(pValue.amount.toString().toFormat('NUMBER'));
					}
				});
				$('#popReportNR').find('#cCost12Total').html(cTotals["C"][0].toString().toFormat('NUMBER'));
				$('#popReportNR').find('#cCost345Total').html(cTotals["C"][1].toString().toFormat('NUMBER'));
				$('#popReportNR').find('#eCost12Total').html(cTotals["E"][0].toString().toFormat('NUMBER'));
				$('#popReportNR').find('#eCost345Total').html(cTotals["E"][1].toString().toFormat('NUMBER'));

				$('#popReportNR').find('#aCostDTM').html((aCostDTM == '9999-99-99') ? '' : aCostDTM);

				var extraCostList = pResult.extraCostList;
				console.log(extraCostList);
				if(extraCostList){
					cCostTotalLast = 0;
					var extraCosts = {};
					$.each(extraCostList, function(pIndex, pCost){
						var extra_sn = pCost.extra_sn;
						if(!extraCosts.hasOwnProperty(extra_sn)){
							extraCosts[extra_sn] = [];
						}
						extraCosts[extra_sn].push(pCost);
					});

					var extra_sns = Object.keys(extraCosts);
					extra_sns.sort();
					for(let i=1;i<=extra_sns.length;i++){
						var extra_sn = extra_sns[i-1];
						var costs = extraCosts[extra_sn];
						var tbody = $(`<tbody role="change">
										<tr data-row="C">
											<th class="colorN text-center" rowspan="2">변경-${i}</th>
											<th class="colorSky">변경 계약가</th>
											<td class="text-number" data-column="cCost1"></td>
											<td class="text-number" data-column="cCost2"></td>
											<td class="text-number" data-column="cCost12Total" style="border-left: 2px solid #555!important;border-right: 2px solid #555!important;"></td>
											<td class="text-number" data-column="cCost5"></td>
											<td class="text-number" data-column="cCost3"></td>
											<td class="text-number" data-column="cCost4"></td>
											<td class="text-number" data-column="cCost345Total" style="border-left: 2px solid #555!important;border-right: 2px solid #555!important;"></td>
											<td class="text-number" data-column="cCost8"></td>
											<td class="text-number" data-column="cCost61"></td>
											<td class="text-number" data-column="cCost7"></td>
											<td class="text-number" data-column="cCost10"></td>
											<td class="text-number" data-column="cCost99"></td>
											<td class="text-number" data-column="cCostTotal"></td>
											<td class="text-number" data-column="tCostTotal" rowspan="2"></td>
											<td class="text-number" data-column="tCost11" rowspan="2"></td>
											<td class="text-center" data-column="bCostDTM" rowspan="2"></td>
										</tr>
										<tr data-row="E">
											<th class="colorSky">변경 실행가</th>
											<td class="text-number" data-column="eCost1"></td>
											<td class="text-number" data-column="eCost2"></td>
											<td class="text-number" data-column="eCost12Total" style="border-left: 2px solid #555!important;border-right: 2px solid #555!important;"></td>
											<td class="text-number" data-column="eCost5"></td>
											<td class="text-number" data-column="eCost3"></td>
											<td class="text-number" data-column="eCost4"></td>
											<td class="text-number" data-column="eCost345Total" style="border-left: 2px solid #555!important;border-right: 2px solid #555!important;"></td>
											<td class="text-number" data-column="eCost8"></td>
											<td class="text-number" data-column="eCost61"></td>
											<td class="text-number" data-column="eCost7"></td>
											<td class="text-number" data-column="eCost10"></td>
											<td class="text-number" data-column="eCost99"></td>
											<td class="text-number" data-column="eCostTotal"></td>
										</tr>
									</tbody>`);
						var costTotal = {"C" : 0, "E" : 0};
						var totals = {"C" : [0, 0], "E" : [0, 0]};
						var tCostDTM = '9999-99-99';
						$.each(costs, function(pIndex, pCost){
							$(tbody).find(`td[data-column="${pCost.cntrct_execut_code.toLowerCase()}Cost${pCost.ct_se_code}"]`).html(pCost.amount.toFormat('NUMBER'));
							costTotal[pCost.cntrct_execut_code] += (pCost.amount != '') ? parseInt(pCost.amount) : 0;
							if([1, 2].includes(parseInt(pCost.ct_se_code))){
								totals[pCost.cntrct_execut_code][0] += (pCost.amount != '') ? parseInt(pCost.amount) : 0;
							}
							else if([3, 4, 5].includes(parseInt(pCost.ct_se_code))){
								totals[pCost.cntrct_execut_code][1] += (pCost.amount != '') ? parseInt(pCost.amount) : 0;
							}
							if(pCost.amount != ''){
								if(tCostDTM > pCost.dtm){
									tCostDTM = pCost.dtm;
								}
							}
						});
						$.each(costTotal, function(pIndex, pValue){
							$(tbody).find(`td[data-column="${pIndex.toLowerCase()}CostTotal"]`).html(pValue.toFormat('NUMBER'));
						});
						$(tbody).find(`td[data-column="cCost12Total"]`).html(totals["C"][0].toFormat('NUMBER'));
						$(tbody).find(`td[data-column="cCost345Total"]`).html(totals["C"][1].toFormat('NUMBER'));
						$(tbody).find(`td[data-column="eCost12Total"]`).html(totals["E"][0].toFormat('NUMBER'));
						$(tbody).find(`td[data-column="eCost345Total"]`).html(totals["E"][1].toFormat('NUMBER'));
						$(tbody).find(`td[data-column="bCostDTM"]`).html((tCostDTM == '9999-99-99') ? '' : tCostDTM);
						$(tbody).find(`td[data-column="tCostTotal"]`).html((costTotal.C - costTotal.E).toFormat('NUMBER'));
						$(tbody).find(`td[data-column="tCost11"]`).html(((costTotal.C - costTotal.E)*100.0/costTotal.C).toFixed(1)+"%");
						$("#report_patrol").append($(tbody));
						cCostTotalLast = costTotal["C"];
					}

				}
				// console.log('aCostList', extraCostList);
				// $.each(extraCostList, function(pIndex, pValue) {
				// 	var amount = 0;
				// 	if (pValue.amount != '') { amount = parseInt(pValue.amount); }
				// 	if (pValue.cntrct_execut_code == 'C') // 계약
				// 	{
				// 		cCostTotal += amount;
				// 		$('#popReportNR').find('#cCost'+pValue.ct_se_code).html(pValue.amount.toString().toFormat('NUMBER'));
				// 	}
				// 	else if (pValue.cntrct_execut_code == 'E') // 실행
				// 	{
				// 		eCostTotal += amount;
				// 		$('#popReportNR').find('#eCost'+pValue.ct_se_code).html(pValue.amount.toString().toFormat('NUMBER'));
				// 	}
				// });

//				if (cCostTotal != 0) {
					$('#popReportNR').find('#cCostTotal').html(cCostTotal.toString().toFormat('NUMBER'));
					$('#popReportNR').find('#report_exec tbody[role=body] tr[data-row=result] td:eq(0)').html((extraCostList.length > 0 ? cCostTotalLast : cCostTotal).toString().toFormat('NUMBER'));
//				}
//				if (eCostTotal != 0) {
					$('#popReportNR').find('#eCostTotal').html(eCostTotal.toString().toFormat('NUMBER'));
//				}

				// 차액
				// var tCost = [];
				// var trList = $('#report_plan').find('tbody tr');
				// $.each(trList, function(pIndex, pValue) {
				// 	var tdList = $(pValue).find('td');
				// 	console.log('tdList', tdList);
				// 	if (pIndex == 0) {
				// 		$.each(tdList, function(pIndex, pValue) {
				// 			var tmp = $(pValue).html().replaceAll(',', '');
				// 			if (tmp != '') {
				// 				tCost[pIndex] = parseInt(tmp);
				// 			} else {
				// 				tCost[pIndex] = 0;
				// 			}
				// 		});
				// 	} else {
				// 		$.each(tdList, function(pIndex, pValue) {
				// 			var tmp = $(pValue).html().replaceAll(',', '');
				// 			if (tmp != '') {
				// 				tCost[pIndex] -= parseInt(tmp);
				// 			} else {
				// 				tCost[pIndex] -= 0;
				// 			}
				// 		});
				// 	}
				// });
				// console.log('tCost', tCost);
				// var thList = $('#report_plan').find('tfoot tr td');
				// $.each(thList, function(pIndex, pValue) {
				// 	console.log('tCost[pIndex]', tCost[pIndex]);
                //     if(pIndex >= 10){
                //         return false;
                //     }
				//
				// 	if (tCost[pIndex]!==null) {
				// 		$(pValue).html(tCost[pIndex].toString().toFormat('NUMBER'));
				// 	}
				// });

				var tCostTotal = cCostTotal - eCostTotal;
				$('#popReportNR').find('#tCostTotal').html(tCostTotal.toString().toFormat('NUMBER'));

				if (project.cntrct_dscnt_rt != 0) { //계약할인율
					$('#popReportNR').find('#cntrct_dscnt_rt').html(project.cntrct_dscnt_rt+'%');
				}
				if (project.cnsul_dscnt_rt != 0) { //품의할인율
					$('#popReportNR').find('#cnsul_dscnt_rt').html(project.cnsul_dscnt_rt+'%');
				}
				if (cCostTotal != 0 && tCost.length != 0) { //VA
					var tmp = (tCostTotal/cCostTotal)*100;
					$('#popReportNR').find('#tCost11').html(tmp.toFixed(1)+'%');
				}
				/* ********************************************************* */

				/* 공사비 산출 및 대금 입금방법 */
				/* ********************************************************* */
				var cCost5 = pResult.c5CostList[0];
                var cCost5_total = 0;
				if (cCost5) {
					var cCost5_amt = cCost5.amount/1.1;
					var cCost5_amt_total = cCost5_amt * cCost5.qy;
					var cCost5_vat_total = cCost5_amt_total / 10;
					var cCost5_sum = cCost5_amt_total + cCost5_vat_total;
					html += '<tr> ';
					html += '	<th class="colorSky">설치공사금액산출</th> ';
					html += '	<th class="colorSky">실내기대수</th> ';
					html += '	<th class="colorSky">대당단가</th> ';
					html += '	<th class="colorSky">공급가액</th> ';
					html += '	<th class="colorSky">세액</th> ';
					html += '	<th class="colorSky">합계</th> ';
					html += '	<th class="colorSky">공사비총액</th> ';
					html += '</tr> ';
					html += '<tr> ';
					html += '	<td class="text-center" id="cCost5_qy">'+cCost5.model_no+'</td> ';
					html += '	<td class="text-number" id="cCost5_qy">'+cCost5.qy.toString().toFormat('NUMBER')+'</td> ';
					html += '	<td class="text-number" id="cCost5_amt">'+Math.round(cCost5_amt).toString().toFormat('NUMBER')+'</td> ';
					html += '	<td class="text-number" id="cCost5_amt_total">'+cCost5_amt_total.toString().toFormat('NUMBER')+'</td> ';
					html += '	<td class="text-number" id="cCost5_vat_total">'+cCost5_vat_total.toString().toFormat('NUMBER')+'</td> ';
					html += '	<td class="text-number" id="cCost5_sum">'+cCost5_sum.toString().toFormat('NUMBER')+'</td> ';
					cCost5_total += cCost5_sum;
					html += '	<td class="text-number" rowspan="'+pResult.c5CostList.length+'" id="cCost5_total">'+cCost5_total+'</td> ';
					html += '</tr> ';
					$.each(pResult.c5CostList, function(pIndex, pValue){
						if (pIndex != 0) {
							var cCost5_amt = pValue.amount/1.1;
							var cCost5_amt_total = cCost5_amt * pValue.qy;
							var cCost5_vat_total = cCost5_amt_total / 10;
							var cCost5_sum = cCost5_amt_total + cCost5_vat_total;
							html += '<tr> ';
							html += '	<td class="text-center">'+pValue.model_no+'</td> ';
							html += '	<td class="text-number">'+pValue.qy.toString().toFormat('NUMBER')+'</td> ';
							html += '	<td class="text-number">'+Math.round(cCost5_amt).toString().toFormat('NUMBER')+'</td> ';
							html += '	<td class="text-number">'+cCost5_amt_total.toString().toFormat('NUMBER')+'</td> ';
							html += '	<td class="text-number">'+cCost5_vat_total.toString().toFormat('NUMBER')+'</td> ';
							html += '	<td class="text-number">'+cCost5_sum.toString().toFormat('NUMBER')+'</td> ';
							html += '</tr> ';
                            cCost5_total += cCost5_sum;
						}
					});
					$('#popReportNR').find('#cCostList').html(html);
                    $('#popReportNR').find('#cCost5_total').html(cCost5_total.toString().toFormat('NUMBER'));
				}

				$('#popReportNR').find('#enty').html(project.enty.toString().toFormat('NUMBER')); //계약금
				$('#popReportNR').find('#enty_de').html(project.enty_de); //계약금일자
				$('#popReportNR').find('#enty_rm').html(project.enty_rm); //계약금비고
				$('#popReportNR').find('#prtpay').html(project.prtpay.toString().toFormat('NUMBER')); //중도금
				$('#popReportNR').find('#prtpay_de').html(project.prtpay_de); //중도금일자
				$('#popReportNR').find('#prtpay_rm').html(project.prtpay_rm); //중도금비고
				$('#popReportNR').find('#surlus').html(project.surlus.toString().toFormat('NUMBER')); //잔금
				$('#popReportNR').find('#surlus_de').html(project.surlus_de); //잔금일자
				$('#popReportNR').find('#surlus_rm').html(project.surlus_rm); //잔금비고
				$('#popReportNR').find('#setle_mth').html(project.setle_mth); //결제방법(2)
				/* ********************************************************* */

				/* 입금현황 */
				/* ********************************************************* */
				var html = '';
                var amt_tot = 0;
				$.each(pResult.rcppayList, function(pIndex, pValue) {
					console.log('pResult.rcppayList', pValue);
					var sTaxbilList = pValue.sTaxbilList;
					var iRcppayList = pValue.iRcppayList;
					html += '<tr>';
					html += '    <th style="width:53%;padding:0px!important;vertical-align:top!important;border-right:2px solid #555!important;">';
					html += '        <table style="border:0px!important;">';
					html += '            <colgroup>';
					html += '                <col width="143">';
					html += '                <col width="160">';
					html += '                <col width="160">';
					html += '                <col width="160">';
					html += '                <col width="*">';
					html += '            </colgroup>';
					html += '            <thead>';
					html += '                <tr>';
					html += '                    <th class="color-contract">세금계산서일자</th>';
					html += '                    <th class="color-contract">공급가액</th>';
					html += '                    <th class="color-contract">부가세</th>';
					html += '                    <th class="color-contract">합계</th>';
					html += '                    <th class="color-contract">발행업체</th>';
					html += '                </tr>';
					html += '            </thead>';
					html += '            <tbody role="body">';

					var splpc_am_total = 0, vat_total = 0, sum_total = 0;
					$.each(sTaxbilList, function(pIndex, pValue) {
						html += '<tr class="colorW">';
						html += '    <td>'+pValue.pblicte_de+'</td>';
						html += '    <td class="text-number">'+pValue.splpc_am.toString().toFormat('NUMBER')+'</td>';
						html += '    <td class="text-number">'+pValue.vat.toString().toFormat('NUMBER')+'</td>';
						html += '    <td class="text-number">'+pValue.total.toString().toFormat('NUMBER')+'</td>';
						html += '    <td>'+pValue.pblicte_trget_nm+'</td>';
						html += '</tr>';
						splpc_am_total += parseInt(pValue.splpc_am);
						vat_total += parseInt(pValue.vat);
						sum_total += parseInt(pValue.total);
					});
					if (sTaxbilList.length < iRcppayList.length) {
						var max = iRcppayList.length - sTaxbilList.length;
						for (i=0; i<max; i++) {
							html += '<tr class="colorW">';
							html += '    <td>-</td>';
							html += '    <td></td>';
							html += '    <td></td>';
							html += '    <td></td>';
							html += '    <td></td>';
							html += '</tr>';
						}
					}

					html += '            </tbody>';
					html += '            <tfoot>';
					html += '                <tr>';
					html += '                    <th class="colorG" colspan="3">합계</th>';
					html += '                    <th class="colorG text-number">'+sum_total.toString().toFormat('NUMBER')+'</th>';
					html += '                    <th class="colorG text-number"></th>';
					html += '                </tr>';
					html += '            </tfoot>';
					html += '        </table>';
					html += '    </th>';
					html += '    <th style="width:47%;padding:0px!important;vertical-align:top!important;">';
					html += '        <table style="border:0px!important;">';
					html += '            <colgroup>';
					html += '                <col width="130">';
					html += '                <col width="160">';
					html += '                <col width="160">';
					html += '                <col width="100">';
					html += '                <col width="*">';
					html += '            </colgroup>';
					html += '            <thead>';
					html += '                <tr>';
					html += '                    <th class="colorY">입금일자</th>';
					html += '                    <th class="colorY">금액</th>';
					html += '                    <th class="colorY">잔액</th>';
					html += '                    <th class="colorY">수금율</th>';
					html += '                    <th class="colorY">수금내역</th>';
					html += '                </tr>';
					html += '            </thead>';
					html += '            <tbody role="body">';

					var cntrct_amount = parseInt($('#popReportNR').find('#report_exec tbody[role=body] tr[data-row=result] td:eq(0)').html().replaceAll(",", ""));
					if(isNaN(cntrct_amount)) cntrct_amount = 0;
					var iRcppay_sub = cntrct_amount, iRcppay_rate = 0.0;
					var amount_total = 0, sub_total = 0, rate_total = 0.0;
					$.each(iRcppayList, function(pIndex, pValue) {

						iRcppay_sub -= parseInt(pValue.amount);
						iRcppay_rate = ((cntrct_amount-iRcppay_sub)/cntrct_amount)*100;
						html += '<tr class="colorW">';
						html += '    <td>'+pValue.rcppay_de+'</td>';
						html += '    <td class="text-number">'+pValue.amount.toString().toFormat('NUMBER')+'</td>';
						html += '    <td class="text-number">'+iRcppay_sub.toString().toFormat('NUMBER')+'</td>';
						html += '    <td class="text-number">'+iRcppay_rate.toFixed(1)+'%</td>';
						html += '    <td>'+pValue.rcppay_dtls+'</td>';
						html += '</tr>';
						amount_total += parseInt(pValue.amount);
						sub_total = iRcppay_sub;
						rate_total = iRcppay_rate;
					});
					if (iRcppayList.length < sTaxbilList.length) {
						var max = sTaxbilList.length - iRcppayList.length;
						for (i=0; i<max; i++) {
							html += '<tr class="colorW">';
							html += '    <td>-</td>';
							html += '    <td></td>';
							html += '    <td></td>';
							html += '    <td></td>';
							html += '    <td></td>';
							html += '</tr>';
						}
					}

					html += '            </tbody>';
					html += '            <tfoot>';
					html += '                <tr>';
					html += '                    <th class="colorG">합계</th>';
					html += '                    <th class="colorP text-number">'+amount_total.toString().toFormat('NUMBER')+'</th>';
					html += '                    <th class="colorG text-number">'+sub_total.toString().toFormat('NUMBER')+'</th>';
					html += '                    <th class="colorG text-number">'+rate_total.toFixed(1)+'%</th>';
					html += '                    <th class="colorG text-number"></th>';
					html += '                </tr>';
					html += '            </tfoot>';
					html += '        </table>';
					html += '    </th>';
					html += '</tr>';
                    amt_tot += amount_total;
				});
                $('#popReportNR').find('#report_exec tbody[role=body] tr[data-row=result] th:eq(0)').html(amt_tot.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#rcppay_status tbody[role=body]').html(html);
				/* ********************************************************* */

				var equipList = pResult.equipList;
				if(equipList != null && equipList.length > 0){
					var html = '';
					var count = 0;
					var before_dlnt = 0;
					var pamount = 0, va = 0, samount = 0;
					$.each(equipList, function(pIndex, pValue){
						html += `<tr>
									<td class="text-center">${pValue.dlivy_de}</td>
									<td class="text-center">${pValue.prdlst_se_nm}</td>
									<td class="text-center">${pValue.model_no}</td>
									<td class="text-center">${pValue.cnt_dlnt.toFormat('NUMBER')}</td>
									<td class="text-right">${pValue.dlamt.toFormat('NUMBER')}</td>
									<td class="text-center">${pValue.before_dlnt.toFormat('NUMBER')}</td>
									<td class="text-right">${(pValue.dlamt*pValue.cnt_dlnt).toFormat('NUMBER')}</td>
									<td class="text-right">${pValue.samount.toFormat('NUMBER')}</td>
									<td class="text-right">${((isNaN(parseInt(pValue.samount)) ? 0 : parseInt(pValue.samount)) - parseInt(pValue.dlamt)*parseInt(pValue.cnt_dlnt)).toFormat('NUMBER')}</td>
									<td class="text-center">${pValue.bcnc_nm}</td>
									<td class="text-center"></td>
								</tr>`;

						count += parseInt(pValue.cnt_dlnt);
						before_dlnt += parseInt(pValue.before_dlnt);
						pamount += pValue.dlamt*pValue.cnt_dlnt;
						samount += isNaN(parseInt(pValue.samount)) ? 0 : parseInt(pValue.smaount);
						va += ((isNaN(parseInt(pValue.samount)) ? 0 : parseInt(pValue.samount)) - parseInt(pValue.dlamt)*parseInt(pValue.cnt_dlnt));
					});
					html += `<tr>
								<td class="colorG" colspan="3">합계</td>
								<td class="colorG text-center">${count.toFormat('NUMBER')}</td>
								<td class="colorG text-center"></td>
								<td class="colorG text-center">${before_dlnt.toFormat('NUMBER')}</td>
								<td class="colorG text-right">${pamount.toFormat('NUMBER')}</td>
								<td class="colorG text-right">${samount.toFormat('NUMBER')}</td>
								<td class="colorG text-right">${va.toFormat('NUMBER')}</td>
								<td class="colorG text-right"></td>
								<td class="colorG text-right"></td>
							</tr>`
					$('#popReportNR').find("#rptTable7Contract tbody").html(html);
					$('#popReportNR').find("#rptTable7 tbody[role='contract']").show();
				}
				else{
					$('#popReportNR').find("#rptTable7 tbody[role='contract']").hide();
				}
				/* 삼성장비매입금액(삼성) */
				/* ********************************************************* */
				var html = '';
				var s1AccountList = pResult.s1AccountList;
				var dlnt1_total = 0, dlnt2_total = 0, dlnt3_total = 0, dlnt4_total = 0, dlnt9_total = 0;
				var p_sum_total = 0, s_sum_total = 0, va_total = 0;
				$.each(s1AccountList, function(pIndex, pValue) {
					var va = parseInt(pValue.s_total) - parseInt(pValue.p_total);
					html += '<tr>';
					html += '    <td class="">'+pValue.s_dlivy_de+'</td>';
					html += '    <td class="">'+pValue.prdlst_se_nm+'</td>';
					html += '    <td class="">'+pValue.s_model_no+'</td>';
					html += '    <td class=" text-number">'+pValue.p_dlamt.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class=" text-center">'+(pValue.dlnt1+pValue.dlnt2+pValue.dlnt3+pValue.dlnt4+pValue.dlnt9).toString().toFormat('NUMBER')+'</td>';
					html += '    <td class=" text-number">'+pValue.p_total.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class=" text-number">'+pValue.s_total.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class=" text-number">'+va.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="">'+pValue.p_bcnc_nm+'</td>';
					html += '    <td class=""></td>';
					html += '</tr>';
					if (pValue.dlnt1 != '') dlnt1_total += parseInt(pValue.dlnt1);
					if (pValue.dlnt2 != '') dlnt2_total += parseInt(pValue.dlnt2);
					if (pValue.dlnt3 != '') dlnt3_total += parseInt(pValue.dlnt3);
					if (pValue.dlnt4 != '') dlnt4_total += parseInt(pValue.dlnt4);
					if (pValue.dlnt9 != '') dlnt9_total += parseInt(pValue.dlnt9);
					p_sum_total += parseInt(pValue.p_total);
					s_sum_total += parseInt(pValue.s_total);
					va_total += va;
				});
				$('#popReportNR').find('#rptTable7 tbody[role=body]').html(html);
				$('#popReportNR').find('#rptTable7 tfoot th:eq(2)').html((dlnt1_total+dlnt2_total+dlnt3_total+dlnt4_total+dlnt9_total).toString().toFormat('NUMBER'));
				$('#popReportNR').find('#rptTable7 tfoot th:eq(3)').html(p_sum_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#rptTable7 tfoot th:eq(4)').html(s_sum_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#rptTable7 tfoot th:eq(5)').html(va_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#report_exec tbody[role=body] tr[data-row=result] td:eq(1)').html(p_sum_total.toString().toFormat('NUMBER'));
				/* ********************************************************* */

				/* 장비매입금액(타사) */
				/* ********************************************************* */

				var equipList = pResult.equipOtherList;
				if(equipList != null && equipList.length > 0){
					var html = '';
					var count = 0;
					var before_dlnt = 0;
					var pamount = 0, va = 0, samount = 0;
					$.each(equipList, function(pIndex, pValue){
						html += `<tr>
									<td class="text-center">${pValue.dlivy_de}</td>
									<td class="text-center">${pValue.prdlst_se_nm}</td>
									<td class="text-center">${pValue.model_no}</td>
									<td class="text-center">${pValue.cnt_dlnt.toFormat('NUMBER')}</td>
									<td class="text-right">${pValue.dlamt.toFormat('NUMBER')}</td>
									<td class="text-center">${pValue.before_dlnt.toFormat('NUMBER')}</td>
									<td class="text-right">${(pValue.dlamt*pValue.cnt_dlnt).toFormat('NUMBER')}</td>
									<td class="text-right">${pValue.samount.toFormat('NUMBER')}</td>
									<td class="text-right">${((isNaN(parseInt(pValue.samount)) ? 0 : parseInt(pValue.samount)) - parseInt(pValue.dlamt)*parseInt(pValue.cnt_dlnt)).toFormat('NUMBER')}</td>
									<td class="text-center">${pValue.bcnc_nm}</td>
									<td class="text-center"></td>
								</tr>`;
						count += parseInt(pValue.cnt_dlnt);
						before_dlnt += parseInt(pValue.before_dlnt);
						pamount += pValue.dlamt*pValue.cnt_dlnt;
						samount += isNaN(parseInt(pValue.samount)) ? 0 : parseInt(pValue.smaount);
						va += ((isNaN(parseInt(pValue.samount)) ? 0 : parseInt(pValue.samount)) - parseInt(pValue.dlamt)*parseInt(pValue.cnt_dlnt));
					});
					html += `<tr>
								<td class="colorG" colspan="3">합계</td>
								<td class="colorG text-center">${count.toFormat('NUMBER')}</td>
								<td class="colorG text-center"></td>
								<td class="colorG text-center">${before_dlnt.toFormat('NUMBER')}</td>
								<td class="colorG text-right">${pamount.toFormat('NUMBER')}</td>
								<td class="colorG text-right">${samount.toFormat('NUMBER')}</td>
								<td class="colorG text-right">${va.toFormat('NUMBER')}</td>
								<td class="colorG text-right"></td>
								<td class="colorG text-right"></td>
							</tr>`
					$('#popReportNR').find("#rptTable8Contract tbody").html(html);
					$('#popReportNR').find("#rptTable8 tbody[role='contract']").show();
				}
				else{
					$('#popReportNR').find("#rptTable8 tbody[role='contract']").hide();
				}


				var html = '';
				var s2AccountList = pResult.s2AccountList;
				var dlnt_total = 0, p_sum_total = 0, s_sum_total = 0, va_total = 0;
				$.each(s2AccountList, function(pIndex, pValue) {
					var va = parseInt(pValue.s_total) - parseInt(pValue.p_total);
					html += '<tr>';
					html += '    <td class="">'+pValue.dlivy_de+'</td>';
					html += '    <td class="">'+pValue.prdlst_se_nm+'</td>';
					html += '    <td class="">'+pValue.model_no+'</td>';
					html += '    <td class=" text-number">'+pValue.p_dlamt.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class=" text-center">'+pValue.dlnt.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class=" text-number">'+pValue.p_total.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class=" text-number">'+pValue.s_total.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class=" text-number">'+va.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="">'+pValue.p_bcnc_nm+'</td>';
					html += '    <td class=""></td>';
					html += '</tr>';
					dlnt_total += parseInt(pValue.dlnt);
					p_sum_total += parseInt(pValue.p_total);
					s_sum_total += parseInt(pValue.s_total);
					va_total += va;
				});
				$('#popReportNR').find('#rptTable8 tbody[role=body]').html(html);
				$('#popReportNR').find('#rptTable8 tfoot th:eq(2)').html(dlnt_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#rptTable8 tfoot th:eq(3)').html(p_sum_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#rptTable8 tfoot th:eq(4)').html(s_sum_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#rptTable8 tfoot th:eq(5)').html(va_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#report_exec tbody[role=body] tr[data-row=result] td:eq(2)').html(p_sum_total.toString().toFormat('NUMBER'));
				/* ********************************************************* */

				/* 설치비 산출 및 지급내역 */
				/* ********************************************************* */
				var html = '';
				var outsrcList = pResult.outsrcList;
				var outsrcItem = pResult.outsrcItem;
				var all_amt_total = 0;
                var all_sum_total = 0;
				var daily_total = 0;
				var index = 1;
				var daily_html = "";
				var daily_item_detail = [];
				var indirect_html = "";
				var indirect_sum_total = 0;
				var eCost5 = 0;
				$.each(outsrcList, function(pIndex, pValue){
					if([146].includes(pValue.outsrc_fo_sn)){
						//매입계산서
						var pTaxbilList = pValue.taxbilList;
						var splpc_am_total = 0, vat_total = 0, sum_total = 0;
						var cntrct_amount = 0;
						if(outsrcItem[146].hasOwnProperty("e5CostList")){
							$.each(outsrcItem[146]['e5CostList'], function(pIndex, pV){
								var eCost5_amt = Math.round(pV.amount / 1.1);
								var eCost5_amt_total = eCost5_amt * pV.qy;
								var eCost5_vat_total = Math.round(eCost5_amt_total * 0.1);
								var eCost5_sum = eCost5_amt_total + eCost5_vat_total;
								var daily_item_html = '';
								daily_item_html += '<tr> ';
								daily_item_html += '	<td class="text-center">(일용직)'+pV.model_no+'</td> ';
								daily_item_html += '	<td class="text-number">'+pV.qy.toString().toFormat('NUMBER')+'</td> ';
								daily_item_html += '	<td class="text-number">'+Math.round(eCost5_amt).toString().toFormat('NUMBER')+'</td> ';
								daily_item_html += '	<td class="text-number">'+eCost5_amt_total.toString().toFormat('NUMBER')+'</td> ';
								daily_item_html += '	<td class="text-number">'+eCost5_vat_total.toString().toFormat('NUMBER')+'</td> ';
								daily_item_html += '	<td class="text-number">'+eCost5_sum.toString().toFormat('NUMBER')+'</td> ';
								daily_item_html += '</tr> ';
								daily_item_detail.push(daily_item_html);
								cntrct_amount += Math.round(pV.amount*pV.qy);
							});

						}
						return true;
					}
					else if([116].includes(pValue.outsrc_fo_sn)){
						indirect_html += '<tr><td colspan="4" style="padding:0px!important;vertical-align:top!important;border-right:2px solid #555!important;">';
						//매입계산서
						var pTaxbilList = pValue.taxbilList;
						var splpc_am_total = 0, vat_total = 0, sum_total = 0;
						var cntrct_amount = 0;
						if(outsrcItem[116].hasOwnProperty("e5CostList")){
							$.each(outsrcItem[116]['e5CostList'], function(pIndex, pV){
								cntrct_amount += Math.round(pV.amount*pV.qy);
							});

						}
						indirect_html += '<table style="width:100%;border:0px!important;">';
						indirect_html += '<colgroup>';
						indirect_html += '	<col width="129">';
						indirect_html += '	<col width="160">';
						indirect_html += '	<col width="160">';
						indirect_html += '	<col width="160">';
						indirect_html += '	<col width="*">';
						indirect_html += '</colgroup>';
						indirect_html += '<thead>';
						indirect_html += '	<tr>';
						indirect_html += '		<th class="color-contract">세금계산서일자</th>';
						indirect_html += '		<th class="color-contract">공급가액</th>';
						indirect_html += '		<th class="color-contract">부가세</th>';
						indirect_html += '		<th class="color-contract">합계</th>';
						indirect_html += '		<th class="color-contract">발행업체</th>';
						indirect_html += '	</tr>';
						indirect_html += '</thead>';
						indirect_html += '<tbody>';
						$.each(pTaxbilList, function(pIndex, pValue) {
							indirect_html += '<tr>';
							indirect_html += '    <td>'+pValue.pblicte_de+'</td>';
							indirect_html += '    <td class="text-number">'+pValue.splpc_am.toString().toFormat('NUMBER')+'</td>';
							indirect_html += '    <td class="text-number">'+pValue.vat.toString().toFormat('NUMBER')+'</td>';
							indirect_html += '    <td class="text-number">'+(pValue.total == '' ? parseInt(pValue.splpc_am)+(pValue.vat == '' ? 0 : parseInt(pValue.vat)) : parseInt(pValue.total)).toString().toFormat('NUMBER')+'</td>';
							indirect_html += '    <td>'+pValue.pblicte_trget_nm+'</td>';
							indirect_html += '</tr>';
							splpc_am_total += parseInt(pValue.splpc_am);
							vat_total += pValue.vat == '' ? 0 : parseInt(pValue.vat);
							sum_total += pValue.total == '' ? parseInt(pValue.splpc_am)+(pValue.vat == '' ? 0 : parseInt(pValue.vat)) : parseInt(pValue.total);
						});
						if (pValue.taxbilList.length < pValue.rcppayList.length) {
							var max = pValue.rcppayList.length - pValue.taxbilList.length
							for (i=0; i<max; i++) {
								indirect_html += '<tr>';
								indirect_html += '    <td>-</td>';
								indirect_html += '    <td></td>';
								indirect_html += '    <td></td>';
								indirect_html += '    <td></td>';
								indirect_html += '    <td></td>';
								indirect_html += '</tr>';
							}
						}
						indirect_html += '</tbody>';
						indirect_html += '<tfoot>';
						indirect_html += '	<tr>';
						indirect_html += '		<th class="colorG">합계</th>';
						indirect_html += '		<th class="colorG text-number">'+splpc_am_total.toString().toFormat('NUMBER')+'</th>';
						indirect_html += '		<th class="colorG text-number">'+vat_total.toString().toFormat('NUMBER')+'</th>';
						indirect_html += '		<th class="colorP text-number">'+sum_total.toString().toFormat('NUMBER')+'</th>';
						indirect_html += '		<th class="colorG text-number"></th>';
						indirect_html += '	</tr>';
						indirect_html += '</tfoot>';
						indirect_html += '</table>';
						indirect_html += '</td>';
						indirect_sum_total += sum_total;
						//지급내역
						indirect_html += '<td colspan="3" style="padding:0px!important;vertical-align:top!important;">';
						var oRcppayList = pValue.rcppayList;
						var eCostTotal = 0, iRcppay_sub = cntrct_amount, iRcppay_rate = 0.0;
						var amount_total = 0, sub_total = 0, rate_total = 0.0;
						indirect_html += '<table style="width:100%;border:0px!important;">';
						indirect_html += '<colgroup>';
						indirect_html += '	<col width="129">';
						indirect_html += '	<col width="160">';
						indirect_html += '	<col width="160">';
						indirect_html += '	<col width="100">';
						indirect_html += '	<col width="*">';
						indirect_html += '</colgroup>';
						indirect_html += '<thead>';
						indirect_html += '	<tr>';
						indirect_html += '		<th class="colorY">지급일자</th>';
						indirect_html += '		<th class="colorY">금액</th>';
						indirect_html += '		<th class="colorY">잔액</th>';
						indirect_html += '		<th class="colorY">지급율</th>';
						indirect_html += '		<th class="colorY">지급내역</th>';
						indirect_html += '	</tr>';
						indirect_html += '</thead>';
						indirect_html += '<tbody>';
						$.each(oRcppayList, function(pIndex, pValue) {
							iRcppay_sub -= parseInt(pValue.amount);
							iRcppay_rate = ((cntrct_amount-iRcppay_sub)/cntrct_amount)*100;
							indirect_html += '<tr>';
							indirect_html += '    <td>'+pValue.rcppay_de+'</td>';
							indirect_html += '    <td class="text-number">'+pValue.amount.toString().toFormat('NUMBER')+'</td>';
							indirect_html += '    <td class="text-number">'+iRcppay_sub.toString().toFormat('NUMBER')+'</td>';
							indirect_html += '    <td class="text-number">'+iRcppay_rate.toFixed(1)+'%</td>';
							indirect_html += '    <td>'+pValue.rcppay_dtls+'</td>';
							indirect_html += '</tr>';
							amount_total += parseInt(pValue.amount);
							sub_total = iRcppay_sub;
							rate_total = iRcppay_rate;
						});
						if (pValue.rcppayList.length < pValue.taxbilList.length) {
							var max = pValue.taxbilList.length - pValue.rcppayList.length
							for (i=0; i<max; i++) {
								indirect_html += '<tr>';
								indirect_html += '    <td>-</td>';
								indirect_html += '    <td></td>';
								indirect_html += '    <td></td>';
								indirect_html += '    <td></td>';
								indirect_html += '    <td></td>';
								indirect_html += '</tr>';
							}
						}
						indirect_html += '</tbody>';
						indirect_html += '<tfoot>';
						indirect_html += '	<tr>';
						indirect_html += '		<th class="colorG">합계</th>';
						indirect_html += '		<th class="colorG text-number">'+amount_total.toString().toFormat('NUMBER')+'</th>';
						indirect_html += '		<th class="colorG text-number">'+sub_total.toString().toFormat('NUMBER')+'</th>';
						indirect_html += '		<th class="colorG text-number">'+rate_total.toFixed(1)+'%'+'</th>';
						indirect_html += '		<th class="colorG text-number"></th>';
						indirect_html += '	</tr>';
						indirect_html += '</tfoot>';
						indirect_html += '</table>';
						indirect_html += '</td></tr>';
						$('#popReportNR').find('#rptTable9_indirect tbody[role=body]').append(indirect_html);
						return true;
					}

				});

				$.each(outsrcList, function(pIndex, pValue) {
					if([146, 116].includes(pValue.outsrc_fo_sn)){
						return true;
					}
					html += '<tr>';
					html += '    <th class="color-contract">도급계약사-'+index+'</th>';
					html += '    <td colspan="3">'+pValue.outsrc_fo_nm+'</td>';
					html += '    <th class="color-contract">도급계약일</th>';
					html += '    <td colspan="2">'+pValue.cntrct_de+'</td>';
					html += '</tr>';
					html += '<tr>';
					html += '    <th class="color-contract">업무총책임자</th>';
					html += '    <td colspan="3">'+pValue.rspnber_nm+'</td>';
					html += '    <th class="color-contract">연락처</th>';
					html += '    <td colspan="2">'+pValue.rspnber_telno+'</td>';
					html += '</tr>';
					html += '<tr>';
					html += '    <th class="color-contract">담당자</th>';
					html += '    <td colspan="3">'+pValue.charger_nm+'</td>';
					html += '    <th class="color-contract">연락처</th>';
					html += '    <td colspan="2">'+pValue.charger_telno+'</td>';
					html += '</tr>';
					html += '<tr> ';
					html += '	<th class="color-contract">내역</th> ';
					html += '	<th class="color-contract">실내기대수</th> ';
					html += '	<th class="color-contract">대당단가</th> ';
					html += '	<th class="color-contract">공급가액</th> ';
					html += '	<th class="color-contract">세액</th> ';
					html += '	<th class="color-contract">합계</th> ';
					html += '	<th class="color-contract">공사비총액</th> ';
					html += '</tr> ';
					if(outsrcItem.hasOwnProperty(pValue.outsrc_fo_sn)){
					var eCost5 = outsrcItem[pValue.outsrc_fo_sn]['e5CostList'][0];
					var eCost5Total = 0;
					$.each(outsrcItem[pValue.outsrc_fo_sn]['e5CostList'], function(pIndex, pV){
						eCost5Total += Math.round(pV.amount*pV.qy);
					});
					if(outsrcItem.hasOwnProperty("146") && outsrcItem["146"].hasOwnProperty('e5CostList')){
						$.each(outsrcItem["146"]['e5CostList'], function(pIndex, pV){
							eCost5Total += Math.round(pV.amount*pV.qy);
						});

					}
					if (eCost5) {
						var eCost5_amt = Math.round(eCost5.amount / 1.1);
						var eCost5_amt_total = eCost5_amt * eCost5.qy;
						var eCost5_vat_total = Math.round(eCost5_amt_total * 0.1);
						var eCost5_sum = eCost5_amt_total + eCost5_vat_total;
						console.log('eCost5', eCost5, eCost5_amt);
						html += '<tr> ';
						html += '	<td class="text-center" id="eCost5_qy">'+eCost5.model_no+'</td> ';
						html += '	<td class="text-number" id="eCost5_qy">'+eCost5.qy.toString().toFormat('NUMBER')+'</td> ';
						html += '	<td class="text-number" id="eCost5_amt">'+Math.round(eCost5_amt).toString().toFormat('NUMBER')+'</td> ';
						html += '	<td class="text-number" id="eCost5_amt_total">'+eCost5_amt_total.toString().toFormat('NUMBER')+'</td> ';
						html += '	<td class="text-number" id="eCost5_vat_total">'+eCost5_vat_total.toString().toFormat('NUMBER')+'</td> ';
						html += '	<td class="text-number" id="eCost5_sum">'+eCost5_sum.toString().toFormat('NUMBER')+'</td> ';
						html += '	<td class="text-number" rowspan="'+(outsrcItem[pValue.outsrc_fo_sn]['e5CostList'].length+daily_item_detail.length)+'">'+eCost5Total.toString().toFormat('NUMBER')+'</td> ';
						html += '</tr> ';
						$.each(outsrcItem[pValue.outsrc_fo_sn]['e5CostList'], function(pIndex, pValue){
							if (pIndex != 0) {

								var eCost5_amt = Math.round(pValue.amount / 1.1);
								var eCost5_amt_total = eCost5_amt * pValue.qy;
								var eCost5_vat_total = Math.round(eCost5_amt_total * 0.1);
								var eCost5_sum = eCost5_amt_total + eCost5_vat_total;
								html += '<tr> ';
								html += '	<td class="text-center">'+pValue.model_no+'</td> ';
								html += '	<td class="text-number">'+pValue.qy.toString().toFormat('NUMBER')+'</td> ';
								html += '	<td class="text-number">'+Math.round(eCost5_amt).toString().toFormat('NUMBER')+'</td> ';
								html += '	<td class="text-number">'+eCost5_amt_total.toString().toFormat('NUMBER')+'</td> ';
								html += '	<td class="text-number">'+eCost5_vat_total.toString().toFormat('NUMBER')+'</td> ';
								html += '	<td class="text-number">'+eCost5_sum.toString().toFormat('NUMBER')+'</td> ';
								html += '</tr> ';
							}
						});
						$.each(daily_item_detail, function(pIndex, pValue){
							html += pValue;
						});
						daily_item_detail = [];
					}
					index++;
				}
				html += '<tr> ';
				html += '	<td class="color-contract">내역</td> ';
				html += '	<td class="color-contract">인건비</td> ';
				html += '	<td class="color-contract">직불</td> ';
				html += '	<td class="color-contract">일용직</td> ';
				html += '	<td class="color-contract">로지텍/타사</td> ';
				html += '	<td class="color-contract">합계</td> ';
				html += '	<td class="color-contract">집행률</td> ';
				html += '</tr> ';
				if(pValue.pymnt_mth && pValue.pymnt_mth.split("-").length == 4){
					html += '<tr>';
					html += '    <th class="color-contract">계약내역</th>';
					html += '    <td class="text-right">'+pValue.pymnt_mth.split("-")[0].toFormat('NUMBER')+'</td>';
					html += '    <td class="text-right">'+pValue.pymnt_mth.split("-")[1].toFormat('NUMBER')+'</td>';
					html += '    <td class="text-right">'+pValue.pymnt_mth.split("-")[2].toFormat('NUMBER')+'</td>';
					html += '    <td class="text-right">'+pValue.pymnt_mth.split("-")[3].toFormat('NUMBER')+'</td>';
					html += '    <td class="text-right">'+pValue.pymnt_mth.split("-").reduce((partialSum, a) => partialSum + parseInt(a), 0).toFormat('NUMBER')+'</td>';
					html += '    <td class="text-right" rowspan="4"></td>';
					html += '</tr>';
					daily_total += parseInt(pValue.pymnt_mth.split("-")[2]);
					eCost5 += (parseInt(pValue.pymnt_mth.split("-")[0]) + parseInt(pValue.pymnt_mth.split("-")[1]) + parseInt(pValue.pymnt_mth.split("-")[2]));
				}
				else{
					html += '<tr>';
					html += '    <th class="color-contract">계약내역</th>';
					html += '    <td class="text-right"></td>';
					html += '    <td class="text-right"></td>';
					html += '    <td class="text-right"></td>';
					html += '    <td class="text-right"></td>';
					html += '    <td class="text-right"></td>';
					html += '    <td class="text-right" rowspan="4"></td>';
					html += '</tr>';

				}
				if(pValue.outsrc_dtls && pValue.outsrc_dtls.split("-").length == 4) {
					html += '<tr>';
					html += '    <th class="color-contract">계약변경</th>';
					html += '    <td class="text-right">'+pValue.outsrc_dtls.split("-")[0].toFormat('NUMBER')+'</td>';
					html += '    <td class="text-right">'+pValue.outsrc_dtls.split("-")[1].toFormat('NUMBER')+'</td>';
					html += '    <td class="text-right">'+pValue.outsrc_dtls.split("-")[2].toFormat('NUMBER')+'</td>';
					html += '    <td class="text-right">'+pValue.outsrc_dtls.split("-")[3].toFormat('NUMBER')+'</td>';
					html += '    <td class="text-right">'+pValue.outsrc_dtls.split("-").reduce((partialSum, a) => partialSum + parseInt(a), 0).toFormat('NUMBER')+'</td>';
					html += '</tr>';
					if(pValue.pymnt_mth && pValue.pymnt_mth.split("-").length == 4) {
						daily_total -= parseInt(pValue.pymnt_mth.split("-")[2]);
						eCost5 -= (parseInt(pValue.pymnt_mth.split("-")[0]) + parseInt(pValue.pymnt_mth.split("-")[1]) + parseInt(pValue.pymnt_mth.split("-")[2]));

					}
					daily_total += parseInt(pValue.outsrc_dtls.split("-")[2]);
					eCost5 += (parseInt(pValue.outsrc_dtls.split("-")[0]) + parseInt(pValue.outsrc_dtls.split("-")[1]) + parseInt(pValue.outsrc_dtls.split("-")[2]));


				}
				else{
					html += '<tr>';
					html += '    <th class="color-contract">계약변경</th>';
					html += '    <td class="text-right"></td>';
					html += '    <td class="text-right"></td>';
					html += '    <td class="text-right"></td>';
					html += '    <td class="text-right"></td>';
					html += '    <td class="text-right"></td>';
					html += '</tr>';

				}

				html += '<tr>';
				html += '    <th class="color-contract">집행</th>';
				html += '    <td class="text-right"></td>';
				html += '    <td class="text-right"></td>';
				html += '    <td class="text-right"></td>';
				html += '    <td class="text-right"></td>';
				html += '    <td class="text-right"></td>';
				html += '</tr>';
				html += '<tr>';
				html += '    <th class="color-contract">잔액</th>';
				html += '    <td class="text-right"></td>';
				html += '    <td class="text-right"></td>';
				html += '    <td class="text-right"></td>';
				html += '    <td class="text-right"></td>';
				html += '    <td class="text-right"></td>';
				html += '</tr>';


					html += '<tr><td colspan="4" style="padding:0px!important;vertical-align:top!important;border-bottom:2px solid #555!important;border-right:2px solid #555!important;">';
					//매입계산서
					var pTaxbilList = pValue.taxbilList;
					var splpc_am_total = 0, vat_total = 0, sum_total = 0;
					html += '<table style="width:100%;border:0px!important;">';
					html += '<colgroup>';
					html += '	<col width="129">';
					html += '	<col width="160">';
					html += '	<col width="160">';
					html += '	<col width="160">';
					html += '	<col width="*">';
					html += '</colgroup>';
					html += '<thead>';
					html += '	<tr>';
					html += '		<th class="color-contract">세금계산서일자</th>';
					html += '		<th class="color-contract">공급가액</th>';
					html += '		<th class="color-contract">부가세</th>';
					html += '		<th class="color-contract">합계</th>';
					html += '		<th class="color-contract">발행업체</th>';
					html += '	</tr>';
					html += '</thead>';
					html += '<tbody>';
					$.each(pTaxbilList, function(pIndex, pValue) {
						html += '<tr>';
						html += '    <td>'+pValue.pblicte_de+'</td>';
						html += '    <td class="text-number">'+pValue.splpc_am.toString().toFormat('NUMBER')+'</td>';
						html += '    <td class="text-number">'+pValue.vat.toString().toFormat('NUMBER')+'</td>';
						html += '    <td class="text-number">'+(pValue.total == '' ? parseInt(pValue.splpc_am)+(pValue.vat == '' ? 0 : parseInt(pValue.vat)) : parseInt(pValue.total)).toString().toFormat('NUMBER')+'</td>';
						html += '    <td>'+pValue.pblicte_trget_nm+'</td>';
						html += '</tr>';
						splpc_am_total += parseInt(pValue.splpc_am);
						vat_total += pValue.vat == '' ? 0 : parseInt(pValue.vat);
						sum_total += pValue.total == '' ? parseInt(pValue.splpc_am)+(pValue.vat == '' ? 0 : parseInt(pValue.vat)) : parseInt(pValue.total);
					});
					if (pValue.taxbilList.length < pValue.rcppayList.length) {
						var max = pValue.rcppayList.length - pValue.taxbilList.length
						for (i=0; i<max; i++) {
							html += '<tr>';
							html += '    <td>-</td>';
							html += '    <td></td>';
							html += '    <td></td>';
							html += '    <td></td>';
							html += '    <td></td>';
							html += '</tr>';
						}
					}
					html += '</tbody>';
					html += '<tfoot>';
					html += '	<tr>';
					html += '		<th class="colorG">합계</th>';
					html += '		<th class="colorG text-number">'+splpc_am_total.toString().toFormat('NUMBER')+'</th>';
					html += '		<th class="colorG text-number">'+vat_total.toString().toFormat('NUMBER')+'</th>';
					html += '		<th class="colorP text-number">'+sum_total.toString().toFormat('NUMBER')+'</th>';
					html += '		<th class="colorG text-number"></th>';
					html += '	</tr>';
					html += '</tfoot>';
					html += '</table>';
					html += '</td>';
                    all_sum_total += sum_total;
					//지급내역
					html += '<td colspan="3" style="padding:0px!important;vertical-align:top!important;border-bottom:2px solid #555!important;">';
					var oRcppayList = pValue.rcppayList;
					var eCostTotal = 0, iRcppay_sub = 0, iRcppay_rate = 0.0;
					if (eCost5 != undefined) {
						eCostTotal = eCost5.total;
						iRcppay_sub = eCost5.total;
					}
					var amount_total = 0, sub_total = 0, rate_total = 0.0;
					html += '<table style="width:100%;border:0px!important;">';
					html += '<colgroup>';
					html += '	<col width="129">';
					html += '	<col width="160">';
					html += '	<col width="160">';
					html += '	<col width="100">';
					html += '	<col width="*">';
					html += '</colgroup>';
					html += '<thead>';
					html += '	<tr>';
					html += '		<th class="colorY">지급일자</th>';
					html += '		<th class="colorY">금액</th>';
					html += '		<th class="colorY">잔액</th>';
					html += '		<th class="colorY">지급율</th>';
					html += '		<th class="colorY">지급내역</th>';
					html += '	</tr>';
					html += '</thead>';
					html += '<tbody>';
					iRcppay_sub = eCost5Total;
					$.each(oRcppayList, function(pIndex, pValue) {
						iRcppay_sub -= parseInt(pValue.amount);
						iRcppay_rate = ((eCost5Total-iRcppay_sub)/eCost5Total)*100;
						html += '<tr>';
						html += '    <td>'+pValue.rcppay_de+'</td>';
						html += '    <td class="text-number">'+pValue.amount.toString().toFormat('NUMBER')+'</td>';
						html += '    <td class="text-number">'+iRcppay_sub.toString().toFormat('NUMBER')+'</td>';
						html += '    <td class="text-number">'+iRcppay_rate.toFixed(1)+'%</td>';
						html += '    <td>'+pValue.rcppay_dtls+'</td>';
						html += '</tr>';
						amount_total += parseInt(pValue.amount);
						sub_total = iRcppay_sub;
						rate_total = iRcppay_rate;
					});
					if (pValue.rcppayList.length < pValue.taxbilList.length) {
						var max = pValue.taxbilList.length - pValue.rcppayList.length
						for (i=0; i<max; i++) {
							html += '<tr>';
							html += '    <td>-</td>';
							html += '    <td></td>';
							html += '    <td></td>';
							html += '    <td></td>';
							html += '    <td></td>';
							html += '</tr>';
						}
					}
					html += '</tbody>';
					html += '<tfoot>';
					html += '	<tr>';
					html += '		<th class="colorG">합계</th>';
					html += '		<th class="colorG text-number">'+amount_total.toString().toFormat('NUMBER')+'</th>';
					html += '		<th class="colorG text-number">'+sub_total.toString().toFormat('NUMBER')+'</th>';
					html += '		<th class="colorG text-number">'+rate_total.toFixed(1)+'%'+'</th>';
					html += '		<th class="colorG text-number"></th>';
					html += '	</tr>';
					html += '</tfoot>';
					html += '</table>';
					html += '</td></tr>';
					all_amt_total += amount_total;
				});
				$('#popReportNR').find('#rptTable9 tbody[role=body]').html(html);


				{
						var pValue=pResult.dailyList;
						var splpc_am_total = 0, vat_total = 0, sum_total = 0;
						var cntrct_amount = daily_total;

						daily_html += '<tr><td colspan="4" style="padding:0px!important;vertical-align:top!important;border-right:2px solid #555!important;">';
						daily_html += '<table style="width:100%;border:0px!important;">';
						daily_html += '<colgroup>';
						daily_html += '	<col width="129">';
						daily_html += '	<col width="160">';
						daily_html += '	<col width="160">';
						daily_html += '	<col width="160">';
						daily_html += '	<col width="*">';
						daily_html += '</colgroup>';
						daily_html += '<thead>';
						daily_html += '	<tr>';
						daily_html += '		<th class="color-contract">세금계산서일자</th>';
						daily_html += '		<th class="color-contract">공급가액</th>';
						daily_html += '		<th class="color-contract">부가세</th>';
						daily_html += '		<th class="color-contract">합계</th>';
						daily_html += '		<th class="color-contract">발행업체</th>';
						daily_html += '	</tr>';
						daily_html += '</thead>';
						daily_html += '<tbody>';
						$.each(pValue.taxbilList, function(pIndex, pValue) {
							daily_html += '<tr>';
							daily_html += '    <td>'+pValue.pblicte_de+'</td>';
							daily_html += '    <td class="text-number">'+pValue.splpc_am.toString().toFormat('NUMBER')+'</td>';
							daily_html += '    <td class="text-number">'+pValue.vat.toString().toFormat('NUMBER')+'</td>';
							daily_html += '    <td class="text-number">'+(pValue.total == '' ? parseInt(pValue.splpc_am)+(pValue.vat == '' ? 0 : parseInt(pValue.vat)) : parseInt(pValue.total)).toString().toFormat('NUMBER')+'</td>';
							daily_html += '    <td>'+pValue.pblicte_trget_nm+'</td>';
							daily_html += '</tr>';
							splpc_am_total += parseInt(pValue.splpc_am);
							vat_total += pValue.vat == '' ? 0 : parseInt(pValue.vat);
							sum_total += pValue.total == '' ? parseInt(pValue.splpc_am)+(pValue.vat == '' ? 0 : parseInt(pValue.vat)) : parseInt(pValue.total);
						});
						if (pValue.taxbilList.length < pValue.rcppayList.length) {
							var max = pValue.rcppayList.length - pValue.taxbilList.length
							for (i=0; i<max; i++) {
								daily_html += '<tr>';
								daily_html += '    <td>-</td>';
								daily_html += '    <td></td>';
								daily_html += '    <td></td>';
								daily_html += '    <td></td>';
								daily_html += '    <td></td>';
								daily_html += '</tr>';
							}
						}
						daily_html += '</tbody>';
						daily_html += '<tfoot>';
						daily_html += '	<tr>';
						daily_html += '		<th class="colorG">합계</th>';
						daily_html += '		<th class="colorG text-number">'+splpc_am_total.toString().toFormat('NUMBER')+'</th>';
						daily_html += '		<th class="colorG text-number">'+vat_total.toString().toFormat('NUMBER')+'</th>';
						daily_html += '		<th class="colorP text-number">'+sum_total.toString().toFormat('NUMBER')+'</th>';
						daily_html += '		<th class="colorG text-number"></th>';
						daily_html += '	</tr>';
						daily_html += '</tfoot>';
						daily_html += '</table>';
						daily_html += '</td>';
						all_sum_total += sum_total;
						//지급내역
						daily_html += '<td colspan="3" style="padding:0px!important;vertical-align:top!important;">';
						var oRcppayList = pValue.rcppayList;
						var eCostTotal = 0, iRcppay_sub = cntrct_amount, iRcppay_rate = 0.0;

						var amount_total = 0, sub_total = 0, rate_total = 0.0;
						daily_html += '<table style="width:100%;border:0px!important;">';
						daily_html += '<colgroup>';
						daily_html += '	<col width="129">';
						daily_html += '	<col width="160">';
						daily_html += '	<col width="160">';
						daily_html += '	<col width="100">';
						daily_html += '	<col width="*">';
						daily_html += '</colgroup>';
						daily_html += '<thead>';
						daily_html += '	<tr>';
						daily_html += '		<th class="colorY">지급일자</th>';
						daily_html += '		<th class="colorY">금액</th>';
						daily_html += '		<th class="colorY">잔액</th>';
						daily_html += '		<th class="colorY">지급율</th>';
						daily_html += '		<th class="colorY">지급내역</th>';
						daily_html += '	</tr>';
						daily_html += '</thead>';
						daily_html += '<tbody>';
						$.each(oRcppayList, function(pIndex, pValue) {
							iRcppay_sub -= parseInt(pValue.amount);
							iRcppay_rate = ((cntrct_amount-iRcppay_sub)/cntrct_amount)*100;
							daily_html += '<tr>';
							daily_html += '    <td>'+pValue.rcppay_de+'</td>';
							daily_html += '    <td class="text-number">'+pValue.amount.toString().toFormat('NUMBER')+'</td>';
							daily_html += '    <td class="text-number">'+iRcppay_sub.toString().toFormat('NUMBER')+'</td>';
							daily_html += '    <td class="text-number">'+iRcppay_rate.toFixed(1)+'%</td>';
							daily_html += '    <td>'+pValue.rcppay_dtls+'</td>';
							daily_html += '</tr>';
							amount_total += parseInt(pValue.amount);
							sub_total = iRcppay_sub;
							rate_total = iRcppay_rate;
						});
						if (pValue.rcppayList.length < pValue.taxbilList.length) {
							var max = pValue.taxbilList.length - pValue.rcppayList.length
							for (i=0; i<max; i++) {
								daily_html += '<tr>';
								daily_html += '    <td>-</td>';
								daily_html += '    <td></td>';
								daily_html += '    <td></td>';
								daily_html += '    <td></td>';
								daily_html += '    <td></td>';
								daily_html += '</tr>';
							}
						}
						daily_html += '</tbody>';
						daily_html += '<tfoot>';
						daily_html += '	<tr>';
						daily_html += '		<th class="colorG">합계</th>';
						daily_html += '		<th class="colorG text-number">'+amount_total.toString().toFormat('NUMBER')+'</th>';
						daily_html += '		<th class="colorG text-number">'+sub_total.toString().toFormat('NUMBER')+'</th>';
						daily_html += '		<th class="colorG text-number">'+rate_total.toFixed(1)+'%'+'</th>';
						daily_html += '		<th class="colorG text-number"></th>';
						daily_html += '	</tr>';
						daily_html += '</tfoot>';
						daily_html += '</table>';
						daily_html += '</td></tr>';
						all_amt_total += amount_total;
						$('#popReportNR').find('#rptTable9 tbody[role=foot]').append(daily_html);

				}
				$('#popReportNR').find('#report_exec tbody[role=body] tr[data-row=result] td:eq(3)').html(all_sum_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#report_exec tbody[role=body] tr[data-row=result] td:eq(6)').html(indirect_sum_total.toString().toFormat('NUMBER'));

				/* ********************************************************* */

				/* 로지텍자재 */
				/* ********************************************************* */
				var html = '';
				var s3AccountList = pResult.s3AccountList;
				var amt_total = 0, vat_total = 0, sum_total = 0, pamt_total = 0;
				$.each(s3AccountList, function(pIndex, pValue) {
					var amt = Math.round(pValue.s_total/1.1);
					var vat = Math.round(amt/10);
					var sum = parseInt(pValue.s_total);
                    var pamt = Math.round(parseInt(pValue.p_total));

					html += '<tr>';
					html += '    <td class="">'+pValue.dlivy_de+'</td>';
					html += '    <td class="">'+pValue.prdlst_se_nm+'</td>';
					html += '    <td class=" text-number">'+pamt.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class=" text-number">'+amt.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class=" text-number">'+vat.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class=" text-number">'+sum.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="">'+pValue.p_bcnc_nm+'</td>';
					html += '    <td class="">'+pValue.rm+'</td>';
					html += '</tr>';
					amt_total += parseInt(amt);
					vat_total += parseInt(vat);
					sum_total += parseInt(sum);
                    pamt_total += parseInt(pamt);
				});
				$('#popReportNR').find('#rptTable10 tbody[role=body]').html(html);
				$('#popReportNR').find('#rptTable10 tfoot th:eq(1)').html(pamt_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#rptTable10 tfoot th:eq(2)').html(amt_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#rptTable10 tfoot th:eq(3)').html(vat_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#rptTable10 tfoot th:eq(4)').html(sum_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#report_exec tbody[role=body] tr[data-row=result] td:eq(4)').html(sum_total.toString().toFormat('NUMBER'));
				/* ********************************************************* */

				/* 기타자재 */
				/* ********************************************************* */
				var html = '';
				var s4AccountList = pResult.s4AccountList;
				var p_amt_total = 0, s_amt_total = 0, dlnt_total = 0, va_total = 0;
				$.each(s4AccountList, function(pIndex, pValue) {
					var amt = parseInt(pValue.p_total);
					var p_dlamt = parseInt(pValue.p_dlamt);
					var dlnt = parseInt(pValue.dlnt); if(isNaN(dlnt)) dlnt = 0;
					var sum = parseInt(pValue.p_total);
					var s_total = parseInt(pValue.s_total); if(isNaN(s_total)) s_total = 0;
					var va = s_total - amt;
					html += '<tr>';
					html += '    <td class="">'+pValue.dlivy_de+'</td>';
					html += '    <td class="">'+pValue.prdlst_se_nm+'</td>';
					html += '    <td class="">'+pValue.model_no+'</td>';
					html += '    <td class=" text-number">'+p_dlamt.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class=" text-center">'+dlnt.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class=" text-number">'+amt.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class=" text-number">'+pValue.s_total.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class=" text-number">'+va.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="">'+pValue.p_bcnc_nm+'</td>';
					html += '    <td class="">'+((pValue.rm == '') ? pValue.model_where : pValue.rm)+'</td>';
					html += '</tr>';
					p_amt_total += parseInt(amt);
					s_amt_total += parseInt(s_total);
					dlnt_total += parseInt(dlnt);
					va_total += parseInt(va);
				});
				$('#popReportNR').find('#rptTable11 tbody[role=body]').html(html);
				$('#popReportNR').find('#rptTable11 tfoot th:eq(2)').html(dlnt_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#rptTable11 tfoot th:eq(3)').html(p_amt_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#rptTable11 tfoot th:eq(4)').html(s_amt_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#rptTable11 tfoot th:eq(5)').html(va_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#report_exec tbody[role=body] tr[data-row=result] td:eq(5)').html(p_amt_total.toString().toFormat('NUMBER'));
				/* ********************************************************* */

				/* 기타 */
				/* ********************************************************* */
				var html = '';
				var etcRcppayList = pResult.etcRcppayList;
				var amt_total = 0;
				var c_opt_amount = 0;
				var c_opt_date = [];

				$.each(etcRcppayList, function(pIndex, pValue) {
					var amt = parseInt(pValue.amount);
					if(parseInt(pValue.acntctgr_code) != 504) {
						html += '<tr>';
						html += '    <td class="">' + pValue.rcppay_de + '</td>';
						html += '    <td class="">' + pValue.acntctgr_nm + '</td>';
						html += '    <td class="text-left">' + pValue.rcppay_dtls + '</td>';
						html += '    <td class="">' + pValue.papr_invstmnt_nm + '</td>';
						html += '    <td class=" text-number">' + amt.toString().toFormat('NUMBER') + '</td>';
						html += '</tr>';
						amt_total += parseInt(amt);
					}
					else{
						c_opt_amount += parseInt(amt);
						c_opt_date.push(pValue.rcppay_de);
					}
				});
				$('#popReportNR').find('#report_exec tbody[role=body] tr[data-row=result] td:eq(8)').html(c_opt_amount.toFormat('NUMBER'));
				$('#popReportNR').find(`[data-column='c_opt_amount']`).html(c_opt_amount.toFormat('NUMBER'));
				$('#popReportNR').find(`[data-column='c_opt_pay_dtm']`).html(c_opt_date.join(","));


//				var etcCardList = pResult.etcCardList;
//                $.each(etcCardList, function(pIndex, pValue) {
//					var amt = parseInt(pValue.amount);
//					html += '<tr>';
//					html += '    <td class="">'+pValue.card_de+'</td>';
//					html += '    <td class="">'+pValue.acntctgr_nm+'</td>';
//					html += '    <td class="text-left">'+pValue.card_dtls+'</td>';
//					html += '    <td class="">'+pValue.papr_invstmnt_nm+'</td>';
//					html += '    <td class=" text-number">'+amt.toString().toFormat('NUMBER')+'</td>';
//					html += '</tr>';
//					amt_total += parseInt(amt);
//				});
				$('#popReportNR').find('#rptTable12 tbody[role=body]').html(html);
				$('#popReportNR').find('#rptTable12 tfoot th:eq(4)').html(amt_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#report_exec tbody[role=body] tr[data-row=result] td:eq(9)').html(amt_total.toString().toFormat('NUMBER'));
				/* ********************************************************* */

				/* 모델하우스 */
				/* ********************************************************* */
				var model_cost_list = pResult.sModelCostList;
				var return_list = pResult.modelList;
				var html = '';
				var total_dlnt = 0;
				var total_amount = 0;
				var total_diff = 0;
				var total_return = 0;
				$.each(model_cost_list, function(pIndex, pValue){
					var return_de = '';
					var return_dlnt = 0;
					var return_place = '';
					if(return_list.hasOwnProperty(pValue.delng_sn)){
						return_de = return_list[pValue.delng_sn].return_de;
						return_place = return_list[pValue.delng_sn].return_place;
						return_dlnt = return_list[pValue.delng_sn].count;
					}
					var dlamt = parseInt(pValue.dlamt); if(isNaN(dlamt)) dlamt = 0;
					var dlnt = parseInt(pValue.dlnt); if(isNaN(dlnt)) dlnt = 0;
					var amount = dlamt*dlnt;
					total_return += return_dlnt;
					var diff = dlnt - return_dlnt;
					if(pValue.delng_sn == ''){
						diff = 0;
						dlnt = '';
					}
					else{
						total_dlnt += dlnt;

					}
					total_amount += amount;
					total_diff += diff;
					if(pValue.dlivy_de != ''){
						var dlivy_year = pValue.dlivy_de.split("-")[0];
						var dlivy_month = pValue.dlivy_de.split("-")[1];
						var dlivy = new Date(dlivy_year, parseInt(dlivy_month)-1+6, 15);
						var expect_de = (new Date(dlivy.getTime() - (new Date()).getTimezoneOffset())).toISOString().split("T")[0];
						var expect = expect_de.split("-")[0]+"-"+expect_de.split("-")[1];
					}
					else{
						var expect = "";
					}
					html += `<tr>
								<td class="text-center">${pValue.dlivy_de}</td>
								<td class="text-center">${pValue.prdlst_se_nm}</td>
								<td class="text-center">${pValue.model_no}</td>
								<td class="text-right">${dlamt.toFormat('NUMBER')}</td>
								<td class="text-center">${dlnt.toFormat('NUMBER')}</td>
								<td class="text-right">${amount.toFormat('NUMBER')}</td>
								<td class="text-center" style="border-right:2px solid #555!important;">${pValue.bcnc_nm}</td>
								<td class="text-center">${expect}</td>
								<td class="text-center">${return_de}</td>
								<td class="text-center">${return_dlnt.toFormat('NUMBER')}</td>
								<td class="text-center">${diff.toFormat('NUMBER')}</td>
								<td class="text-center">${return_place}</td>
								<td class="text-center"></td>
							</tr>`
				});
				$('#popReportNR').find('#rptTable14 tbody[role=body]').html(html);
				$('#popReportNR').find('#rptTable14 tfoot').find("[data-column='total_dlnt']").html(total_dlnt.toFormat('NUMBER'));
				$('#popReportNR').find('#rptTable14 tfoot').find("[data-column='total_amount']").html(total_amount.toFormat('NUMBER'));
				$('#popReportNR').find('#report_exec tbody[role=body] tr[data-row=result] td:eq(7)').html(total_amount.toFormat('NUMBER'));

				$('#popReportNR').find('#rptTable14 tfoot').find("[data-column='total_diff']").html(total_diff.toFormat('NUMBER'));
				$('#popReportNR').find('#rptTable14 tfoot').find("[data-column='total_return']").html(total_return.toFormat('NUMBER'));
				/*
				var html = '';
				var s61AccountList = pResult.s61AccountList;
				var dlnt1_total = 0, dlnt2_total = 0, dlnt3_total = 0, dlnt4_total = 0, dlnt9_total = 0;
				var p_sum_total = 0, s_sum_total = 0, va_total = 0;
                var wrhousng_total = 0;
				console.log('s61AccountList', s61AccountList);
                console.log('model', pResult['modelList']);
				$.each(s61AccountList, function(pIndex, pValue) {
                    var wrhousng_de = [];
                    if(pResult['modelList'].hasOwnProperty(pValue.s_model_no) && pResult['modelList'][pValue.s_model_no].hasOwnProperty(pValue.s_dlivy_de)){
                        $.each(pResult['modelList'][pValue.s_model_no][pValue.s_dlivy_de], function(pI, pV){
                            wrhousng_de.push([pV.ddt_man, pV.dlnt]);
                        });
                    }

					var va = parseInt(pValue.s_total) - parseInt(pValue.p_total);
                    if(wrhousng_de.length == 0){
                        html += '<tr>';
                        html += '    <td class="">'+pValue.s_dlivy_de+'</td>';
                        html += '    <td class="">'+pValue.s_model_no+'</td>';
                        html += '    <td class=" text-number">'+pValue.dlnt1.toString().toFormat('NUMBER')+'</td>';
                        html += '    <td class=" text-number">'+pValue.dlnt2.toString().toFormat('NUMBER')+'</td>';
                        html += '    <td class=" text-number">'+pValue.dlnt3.toString().toFormat('NUMBER')+'</td>';
                        html += '    <td class=" text-number">'+pValue.dlnt4.toString().toFormat('NUMBER')+'</td>';
                        html += '    <td class=" text-number">'+pValue.dlnt9.toString().toFormat('NUMBER')+'</td>';
                        html += '    <td class=" text-number">'+pValue.p_dlamt.toString().toFormat('NUMBER')+'</td>';
                        html += '    <td class=" text-number">'+pValue.p_total.toString().toFormat('NUMBER')+'</td>';
                        html += '    <td class="">'+pValue.p_bcnc_nm+'</td>';
                        html += '    <td></td>';
                        html += '    <td class=" text-number"></td>';
                        html += '    <td class="">'+pValue.rm+'</td>';
                        html += '</tr>';
                    }
                    else{
                        console.log(wrhousng_de);
                        $.each(wrhousng_de, function(i,v){
                            html += '<tr>';
                            if(i==0){
                                html += '    <td class="" rowspan="'+wrhousng_de.length+'">'+pValue.s_dlivy_de+'</td>';
                                html += '    <td class="" rowspan="'+wrhousng_de.length+'">'+pValue.s_model_no+'</td>';
                                html += '    <td class=" text-number" rowspan="'+wrhousng_de.length+'">'+pValue.dlnt1.toString().toFormat('NUMBER')+'</td>';
                                html += '    <td class=" text-number" rowspan="'+wrhousng_de.length+'">'+pValue.dlnt2.toString().toFormat('NUMBER')+'</td>';
                                html += '    <td class=" text-number" rowspan="'+wrhousng_de.length+'">'+pValue.dlnt3.toString().toFormat('NUMBER')+'</td>';
                                html += '    <td class=" text-number" rowspan="'+wrhousng_de.length+'">'+pValue.dlnt4.toString().toFormat('NUMBER')+'</td>';
                                html += '    <td class=" text-number" rowspan="'+wrhousng_de.length+'">'+pValue.dlnt9.toString().toFormat('NUMBER')+'</td>';
                                html += '    <td class=" text-number" rowspan="'+wrhousng_de.length+'">'+pValue.p_dlamt.toString().toFormat('NUMBER')+'</td>';
                                html += '    <td class=" text-number" rowspan="'+wrhousng_de.length+'">'+pValue.p_total.toString().toFormat('NUMBER')+'</td>';
                                html += '    <td class="" rowspan="'+wrhousng_de.length+'">'+pValue.p_bcnc_nm+'</td>';

                            }
                            html += '    <td>'+v[0]+'</td>';
                            html += '    <td class="text-number">'+v[1]+'</td>';
                            if(i==0)
                                html += '    <td class="" rowspan="'+wrhousng_de.length+'">'+pValue.rm+'</td>';
                            html += '</tr>';
                            wrhousng_total += parseInt(v[1]);
                        });
                    }

					if (pValue.dlnt1 != '') dlnt1_total += parseInt(pValue.dlnt1);
					if (pValue.dlnt2 != '') dlnt2_total += parseInt(pValue.dlnt2);
					if (pValue.dlnt3 != '') dlnt3_total += parseInt(pValue.dlnt3);
					if (pValue.dlnt4 != '') dlnt4_total += parseInt(pValue.dlnt4);
					if (pValue.dlnt9 != '') dlnt9_total += parseInt(pValue.dlnt9);
					p_sum_total += pValue.p_total == '' ? 0 : parseInt(pValue.p_total);
					s_sum_total += pValue.s_total == '' ? 0 : parseInt(pValue.s_total);
					va_total += va;
				});
				$('#popReportNR').find('#rptTable14 tbody[role=body]').html(html);
				$('#popReportNR').find('#rptTable14 tfoot th:eq(1)').html(dlnt1_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#rptTable14 tfoot th:eq(2)').html(dlnt2_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#rptTable14 tfoot th:eq(3)').html(dlnt3_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#rptTable14 tfoot th:eq(4)').html(dlnt4_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#rptTable14 tfoot th:eq(5)').html(dlnt9_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#rptTable14 tfoot th:eq(7)').html(p_sum_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#rptTable14 tfoot th:eq(10)').html(wrhousng_total.toString().toFormat('NUMBER'));
//				$('#popReportNR').find('#rptTable14 tfoot th:eq(8)').html(va_total.toString().toFormat('NUMBER'));
//				$('#popReportNR').find('#rptTable14 tfoot th:eq(9)').html(va_total.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#report_exec tbody[role=body] td:eq(7)').html(p_sum_total.toString().toFormat('NUMBER'));
				*/
				/* M/SH, 옵션 */
				var html = '';
				var dspyOptionList = pResult.sOptionCostList;
				console.log(dspyOptionList);
				if(dspyOptionList != null){
					$.each(dspyOptionList, function(pKey, pValue){
						var target = $(document).find(`#rptTableOpt tbody[role=body] [data-column='${pKey}']`);
						if($(target).data("type") != 'number'){
							$(target).html(pValue);
						}
						else{
							$(target).html(pValue.toFormat('NUMBER'));
						}
					});
					var c_opt_amount = parseInt(dspyOptionList.c_opt_amount); if(isNaN(c_opt_amount)) c_opt_amount = 0;
					var e_opt_amount = parseInt(dspyOptionList.e_opt_amount); if(isNaN(e_opt_amount)) e_opt_amount = 0;

					var diff = e_opt_amount - c_opt_amount;
					$(document).find(`#rptTableOpt tfoot [data-column='diff']`).html(diff.toFormat('NUMBER'));
				}

				/* ********************************************************* */
				var html = '';
				var dspyCostList = pResult.dspyCostList;
				var all_sum_total = 0, option_amt = 0;

				$.each(dspyCostList, function(pIndex, pValue) {
					var dspy_ct_se_nm = pValue.ct_se_code == '10' ? '예상' : '정산';
					var color = pValue.ct_se_code == '10' ? 'colorY' : 'colorG';
					var lttot_rt = (parseInt(pValue.lttot_hshld_co)/parseInt(pValue.hshld_co))*100;
					var optn_rt = (parseInt(pValue.optn_hshld_co)/parseInt(pValue.hshld_co))*100;
					all_sum_total = parseInt(pValue.erc_ct)+parseInt(pValue.optn_event_ct) + parseInt(pValue.amount);
					html += '<tr>';
					html += '    <td class="text-center '+color+'">'+dspy_ct_se_nm+'</td>';
					html += '    <td class="text-number">'+pValue.hshld_co.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+pValue.lttot_hshld_co.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-center">'+lttot_rt.toFixed(0)+'%'+'</td>';
					html += '    <td class="text-number">'+pValue.optn_hshld_co.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-center">'+optn_rt.toFixed(0)+'%'+'</td>';
					html += '    <td class="text-number">'+pValue.prsmp_cntrct_amount.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+pValue.amount.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-center">'+pValue.erc_ct.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+pValue.optn_event_ct.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+all_sum_total.toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+(parseInt(pValue.prsmp_cntrct_amount) - all_sum_total).toString().toFormat('NUMBER')+'</td>';
					html += '    <td class="text-number">'+((parseInt(pValue.prsmp_cntrct_amount) - all_sum_total) / parseInt(pValue.prsmp_cntrct_amount) * 100).toFixed(1)+'%</td>';
					html += '</tr>';
					if (dspy_ct_se_nm == '정산') {
						option_amt = pValue.optn_event_ct == '' ? 0 : parseInt(pValue.optn_event_ct);
					}
				});
				$('#popReportNR').find('#rptTable13 tbody').html(html);
				/* ********************************************************* */

				/* 결산내역 (관리) */
				/* ********************************************************* */
				var execData = $('#popReportNR').find('#report_exec tbody[role=body] tr[data-row=result] td');
				var execAmt0 = $(execData[0]).html().replaceAll(',', '');
				if (execAmt0 != '') {
					execAmt0 = parseInt(execAmt0);
				} else {
					execAmt0 = 0;
				}
				var execAmt1 = $(execData[1]).html().replaceAll(',', '');
				if (execAmt1 != '') {
					execAmt1 = parseInt(execAmt1);
				} else {
					execAmt1 = 0;
				}
				var execAmt2 = $(execData[2]).html().replaceAll(',', '');
				if (execAmt2 != '') {
					execAmt2 = parseInt(execAmt2);
				} else {
					execAmt2 = 0;
				}
				var execAmt3 = $(execData[3]).html().replaceAll(',', '');
				if (execAmt3 != '') {
					execAmt3 = parseInt(execAmt3);
				} else {
					execAmt3 = 0;
				}
				var execAmt4 = $(execData[4]).html().replaceAll(',', '');
				if (execAmt4 != '') {
					execAmt4 = parseInt(execAmt4);
				} else {
					execAmt4 = 0;
				}
				var execAmt5 = $(execData[5]).html().replaceAll(',', '');
				if (execAmt5 != '') {
					execAmt5 = parseInt(execAmt5);
				} else {
					execAmt5 = 0;
				}
				var execAmt6 = $(execData[6]).html().replaceAll(',', '');
				if (execAmt6 != '') {
					execAmt6 = parseInt(execAmt6);
				} else {
					execAmt6 = 0;
				}
				var execAmt7 = $(execData[7]).html().replaceAll(',', '');
				if (execAmt7 != '') {
					execAmt7 = parseInt(execAmt7);
				} else {
					execAmt7 = 0;
				}
				var execAmt8 = $(execData[8]).html().replaceAll(',', '');
				if (execAmt8 != '') {
					execAmt8 = parseInt(execAmt8);
				} else {
					execAmt8 = 0;
				}
				var execAmt9 = $(execData[9]).html().replaceAll(',', '');
				if (execAmt9 != '') {
					execAmt9 = parseInt(execAmt9);
				} else {
					execAmt9 = 0;
				}
				var total12 = execAmt1 + execAmt2;
				var total345 = execAmt3 + execAmt4 + execAmt5;
				var vaTotal = execAmt0 - execAmt1 - execAmt2 - execAmt3 - execAmt4 - execAmt5 - execAmt6 - execAmt7 - execAmt8 - execAmt9;
				var vaRate = (vaTotal/execAmt0)*100;
				$('#popReportNR').find('#report_exec tbody[role=body] tr[data-row=result] th:eq(1)').html(total12.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#report_exec tbody[role=body] tr[data-row=result] th:eq(2)').html(total345.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#report_exec tbody[role=body] tr[data-row=result] td:eq(10)').html(vaTotal.toString().toFormat('NUMBER'));
				$('#popReportNR').find('#report_exec tbody[role=body] tr[data-row=result] td:eq(11)').html(vaRate.toFixed(1)+'%');
				/* ********************************************************* */

				/* 특이사항 */
				/* ********************************************************* */
				$('#popReportNR').find('#partclr_matter').html(project.partclr_matter.trim().replaceAll("\n", "<br>")); //특이사항
				/* ********************************************************* */

			}
		}
	});

    });
	$(function() {
    /**************************************************************************
     * 인쇄 버튼 클릭 처리
     */
	$('#btnPrint1').on('click', function(pEvent) {
		var html = $('#popReportNR').find('.modal-body').html();
		$('#_print').contents().find('body>div.report').html('');
		$('#_print').contents().find('body>div.report').html(html);
		parent.frames['_print'].focus();
    	parent.frames['_print'].print();
	});
});

</script>
{% endblock %}